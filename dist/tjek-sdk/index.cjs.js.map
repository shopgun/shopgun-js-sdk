{"version":3,"file":"index.cjs.js","sources":["../../lib/configDefaults.js","../../lib/storage/client-local.js","../../lib/util.js","../../lib/kits/events/tracker.js"],"sourcesContent":["export const locale = 'en_US';\nexport const coreUrl = 'https://squid-api.tjek.com';\nexport const eventsTrackUrl = 'https://wolf-api.tjek.com/sync';\n","const prefixKey = 'sgn-';\n\nconst storage = (() => {\n    try {\n        const storage = window.localStorage;\n\n        storage[`${prefixKey}test-storage`] = 'foobar';\n        delete storage[`${prefixKey}test-storage`];\n\n        return storage;\n    } catch (error) {\n        return {};\n    }\n})();\n\nexport function get(key) {\n    try {\n        return JSON.parse(storage[`${prefixKey}${key}`]);\n    } catch (error) {}\n}\n\nexport function set(key, value) {\n    try {\n        storage[`${prefixKey}${key}`] = JSON.stringify(value);\n    } catch (error) {}\n}\n","export function isBrowser() {\n    return typeof window === 'object' && typeof document === 'object';\n}\n\nexport function isNode() {\n    return typeof process === 'object';\n}\n\nexport function error(err, options) {\n    err.message = err.message || null;\n\n    if (typeof options === 'string') {\n        err.message = options;\n    } else if (typeof options === 'object' && options != null) {\n        for (let key in options) {\n            const value = options[key];\n            err[key] = value;\n        }\n\n        if (options.message != null) {\n            err.message = options.message;\n        }\n        if (options.code != null || options.message != null) {\n            err.code = options.code || options.name;\n        }\n        if (options.stack != null) {\n            err.stack = options.stack;\n        }\n    }\n\n    err.name = options?.name || err.name || err.code || 'Error';\n    err.time = new Date();\n\n    return err;\n}\n\nexport function uuid() {\n    return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, (c) => {\n        const r = (Math.random() * 16) | 0;\n        const v = c === 'x' ? r : (r & 0x3) | 0x8;\n\n        return v.toString(16);\n    });\n}\n\nexport function getQueryParam(field, url) {\n    const href = url || window.location.href;\n    const reg = new RegExp('[?&]' + field + '=([^&#]*)', 'i');\n    const string = reg.exec(href);\n\n    if (string) {\n        return string[1];\n    }\n    return undefined;\n}\n\nexport function getRandomNumberBetween(from, to) {\n    return Math.floor(Math.random() * to) + from;\n}\n\nexport function getOS() {\n    let name = null;\n    const ua = window.navigator.userAgent;\n\n    if (ua.indexOf('Windows') > -1) {\n        name = 'Windows';\n    } else if (ua.indexOf('Mac') > -1) {\n        name = 'macOS';\n    } else if (ua.indexOf('X11') > -1) {\n        name = 'unix';\n    } else if (ua.indexOf('Linux') > -1) {\n        name = 'Linux';\n    } else if (ua.indexOf('iOS') > -1) {\n        name = 'iOS';\n    } else if (ua.indexOf('Android') > -1) {\n        name = 'Android';\n    }\n\n    return name;\n}\n\nexport function getDeviceCategory() {\n    let deviceCategory = 'desktop';\n\n    if (navigator.platform === 'iPod' || navigator.platform === 'iPhone') {\n        deviceCategory = 'mobile';\n    } else if (navigator.platform === 'iPad') {\n        deviceCategory = 'tablet';\n    } else if (\n        navigator.platform === 'Android' ||\n        /android/gi.test(navigator.userAgent)\n    ) {\n        if (/tablet/gi.test(navigator.userAgent)) {\n            deviceCategory = 'tablet';\n        } else {\n            deviceCategory = 'mobile';\n        }\n    }\n\n    return deviceCategory;\n}\n\nexport function getPointer() {\n    let pointer = 'fine';\n\n    if (matchMedia('(pointer:coarse)').matches) {\n        pointer = 'coarse';\n    }\n\n    return pointer;\n}\n\nexport function getOrientation(width, height) {\n    if (width === height) {\n        return 'quadratic';\n    } else if (width > height) {\n        return 'horizontal';\n    } else {\n        return 'vertical';\n    }\n}\n\nexport function getScreenDimensions() {\n    const density = window.devicePixelRatio ?? 1;\n    const logical = {\n        width: window.screen.width,\n        height: window.screen.height\n    };\n    const physical = {\n        width: Math.round(logical.width * density),\n        height: Math.round(logical.height * density)\n    };\n\n    return {\n        density,\n        logical,\n        physical\n    };\n}\n\nexport function getUtcOffsetSeconds() {\n    const now = new Date();\n    const jan1 = new Date(now.getFullYear(), 0, 1, 0, 0, 0, 0);\n    const tmp = jan1.toGMTString();\n    const jan2 = new Date(tmp.substring(0, tmp.lastIndexOf(' ') - 1));\n    const stdTimeOffset = (jan1 - jan2) / 1000;\n\n    return stdTimeOffset;\n}\n\nexport function getUtcDstOffsetSeconds() {\n    return new Date().getTimezoneOffset() * 60 * -1;\n}\n\nexport function getColorBrightness(color) {\n    color = color.replace('#', '');\n    var hex = parseInt((hex + '').replace(/[^a-f0-9]/gi, ''), 16);\n    const rgb = [];\n    let sum = 0;\n    let x = 0;\n\n    while (x < 3) {\n        const s = parseInt(color.substring(2 * x, 2), 16);\n        rgb[x] = s;\n\n        if (s > 0) {\n            sum += s;\n        }\n\n        ++x;\n    }\n\n    if (sum <= 381) {\n        return 'dark';\n    } else {\n        return 'light';\n    }\n}\n\nexport function btoa(str) {\n    if (isBrowser()) {\n        return window.btoa(str);\n    } else {\n        let buffer = null;\n\n        if (str instanceof Buffer) {\n            buffer = str;\n        } else {\n            buffer = Buffer.from(str.toString(), 'binary');\n        }\n\n        return buffer.toString('base64');\n    }\n}\n\nexport function chunk(arr, size) {\n    const results = [];\n\n    while (arr.length) {\n        results.push(arr.splice(0, size));\n    }\n\n    return results;\n}\n\nexport function throttle(fn, threshold = 250, scope) {\n    let last = undefined;\n    let deferTimer = undefined;\n\n    return function () {\n        const context = scope || this;\n        const now = new Date().getTime();\n        const args = arguments;\n\n        if (last && now < last + threshold) {\n            clearTimeout(deferTimer);\n\n            deferTimer = setTimeout(() => {\n                last = now;\n\n                fn.apply(context, args);\n            }, threshold);\n        } else {\n            last = now;\n            fn.apply(context, args);\n        }\n    };\n}\n\nexport function loadImage(src, callback) {\n    const img = new Image();\n\n    img.onload = () => callback(null, img.width, img.height);\n    img.onerror = () => callback(new Error());\n    img.src = src;\n\n    return img;\n}\n\nexport function distance(lat1, lng1, lat2, lng2) {\n    const radlat1 = (Math.PI * lat1) / 180;\n    const radlat2 = (Math.PI * lat2) / 180;\n    const theta = lng1 - lng2;\n    const radtheta = (Math.PI * theta) / 180;\n    let dist =\n        Math.sin(radlat1) * Math.sin(radlat2) +\n        Math.cos(radlat1) * Math.cos(radlat2) * Math.cos(radtheta);\n    dist = Math.acos(dist);\n    dist = (dist * 180) / Math.PI;\n    dist = dist * 60 * 1.1515;\n    dist = dist * 1.609344 * 1000;\n\n    return dist;\n}\n\n// Method for wrapping a function that takes a callback in any position\n// to return promises if no callback is given in a call.\n// The second argument, cbParameterIndex, is the position of the callback in the original functions parameter list.\n// CoffeeScript optional parameters messes with this function arity detection,\n// not sure what to do about that, other than always setting cbParameterIndex at callsites.\nexport function promiseCallbackInterop(fun, cbParameterIndex = fun.length - 1) {\n    // This is the function that actually wraps and calls a method to return a promise.\n    const makePromise = (fun, cbParameterIndex, parameters) =>\n        new Promise((resolve, reject) => {\n            const neoCallback = (error, result) => {\n                if (error) {\n                    return reject(error);\n                }\n                return resolve(result);\n            };\n\n            const callParameters = [];\n            for (\n                let i = 0,\n                    end = Math.max(parameters.length, cbParameterIndex) + 1,\n                    asc = 0 <= end;\n                asc ? i < end : i > end;\n                asc ? i++ : i--\n            ) {\n                callParameters.push(\n                    i === cbParameterIndex ? neoCallback : parameters[i]\n                );\n            }\n\n            return fun.apply(this, callParameters);\n        });\n    // Wrapper function that decides what to do per-call.\n    return (...parameters) => {\n        if (typeof parameters[cbParameterIndex] === 'function') {\n            // Callback given, do a regular old call.\n            return fun.apply(null, parameters);\n        } else if (typeof Promise === 'function') {\n            // No callback given, and we have promise support, use makePromise to wrap the call.\n            return makePromise(fun, cbParameterIndex, parameters);\n        } else {\n            // Ain't got callback, ain't got promise support; we gotta tell the developer.\n            throw new Error(`To be able to use this asynchronous method you should:\nSupply a callback function as argument #${1 + cbParameterIndex}.\nThis callback function will be called with the method call response.\nAlternatively, when supported, it can return a Promise if no callback function is given.\\\n`);\n        }\n    };\n}\n","import fetch from 'cross-fetch';\nimport md5 from 'md5';\nimport {eventsTrackUrl as defaultEventsTrackUrl} from '../../configDefaults';\nimport * as clientLocalStorage from '../../storage/client-local';\nimport {btoa, error, throttle, uuid} from '../../util';\n\nconst createTrackerClient = () => {\n    let id = clientLocalStorage.get('client-id');\n    if (id?.data) {\n        id = id.data;\n    }\n\n    if (id == null) {\n        id = uuid();\n\n        clientLocalStorage.set('client-id', id);\n    }\n\n    return {id};\n};\n\nfunction getPool() {\n    let data = clientLocalStorage.get('event-tracker-pool');\n    if (Array.isArray(data) === false) {\n        data = [];\n    }\n    data = data.filter((evt) => typeof evt._i === 'string');\n\n    return data;\n}\n\nlet pool = getPool();\n\nclass Tracker {\n    constructor(options = {}) {\n        for (let key in this.defaultOptions) {\n            const value = this.defaultOptions[key];\n            this[key] = options[key] || value;\n        }\n\n        this.client = options?.client || createTrackerClient();\n        this.eventsTrackUrl = options?.eventsTrackUrl || defaultEventsTrackUrl;\n        this.location = {\n            geohash: null,\n            time: null,\n            country: null\n        };\n        this.dispatching = false;\n        this.hasMadeInitialDispatch = false;\n\n        if (this.eventsTrackUrl) {\n            dispatch(this.eventsTrackUrl);\n            this.hasMadeInitialDispatch = true;\n        }\n    }\n    setEventsTrackUrl(eventsTrackUrl) {\n        this.eventsTrackUrl = eventsTrackUrl;\n        if (!this.hasMadeInitialDispatch) {\n            dispatch(this.eventsTrackUrl);\n            this.hasMadeInitialDispatch = true;\n        }\n    }\n    trackEvent(type, properties = {}, version = 2) {\n        if (typeof type !== 'number') {\n            throw error(new Error('Event type is required'));\n        }\n        if (this.trackId == null) {\n            return;\n        }\n\n        const evt = Object.assign({}, properties, {\n            _e: type,\n            _v: version,\n            _i: uuid(),\n            _t: Math.round(new Date().getTime() / 1000),\n            _a: this.trackId\n        });\n\n        if (this.location.geohash) {\n            evt['l.h'] = this.location.geohash;\n        }\n        if (this.location.time) {\n            evt['l.ht'] = this.location.time;\n        }\n        if (this.location.country) {\n            evt['l.c'] = this.location.country;\n        }\n\n        pool.push(evt);\n        while (pool.length > this.poolLimit) {\n            pool.shift();\n        }\n\n        dispatch(this.eventsTrackUrl);\n\n        return this;\n    }\n\n    setLocation(location = {}) {\n        for (let key in location) {\n            const value = location[key];\n            if (Object.prototype.hasOwnProperty.call(this.location, key)) {\n                this.location[key] = value;\n            }\n        }\n\n        return this;\n    }\n\n    trackPagedPublicationOpened(properties, version) {\n        return this.trackEvent(1, properties, version);\n    }\n\n    trackPagedPublicationPageDisappeared(properties, version) {\n        return this.trackEvent(2, properties, version);\n    }\n\n    trackOfferOpened(properties, version) {\n        return this.trackEvent(3, properties, version);\n    }\n\n    trackSearched(properties, version) {\n        return this.trackEvent(5, properties, version);\n    }\n\n    trackIncitoPublicationOpened(properties, version) {\n        return this.trackEvent(11, properties, version);\n    }\n\n    createViewToken(...parts) {\n        const str = [this.client.id].concat(parts).join('');\n        const viewToken = btoa(\n            String.fromCharCode.apply(\n                null,\n                md5(str, {asBytes: true}).slice(0, 8)\n            )\n        );\n\n        return viewToken;\n    }\n}\nTracker.prototype.defaultOptions = {\n    trackId: null,\n    poolLimit: 1000\n};\nexport default Tracker;\n\nlet dispatching = false;\nconst dispatchLimit = 100;\n\nfunction ship(events = [], eventsTrackUrl) {\n    return fetch(eventsTrackUrl, {\n        method: 'post',\n        timeout: 1000 * 20,\n        headers: {\n            'Content-Type': 'application/json; charset=utf-8'\n        },\n        body: JSON.stringify({events})\n    }).then((response) => response.json());\n}\n\nlet dispatchRetryInterval = null;\nfunction _dispatch(eventsTrackUrl) {\n    if (dispatching === true || pool.length === 0) {\n        return;\n    }\n\n    const events = pool.slice(0, dispatchLimit);\n    let nacks = 0;\n    dispatching = true;\n\n    ship(events, eventsTrackUrl)\n        .then((response) => {\n            dispatching = false;\n            if (dispatchRetryInterval) {\n                clearInterval(dispatchRetryInterval);\n                dispatchRetryInterval = null;\n            }\n\n            response.events.forEach((resEvent) => {\n                if (\n                    resEvent.status === 'validation_error' ||\n                    resEvent.status === 'ack'\n                ) {\n                    pool = pool.filter(\n                        (poolEvent) => poolEvent._i !== resEvent.id\n                    );\n                } else {\n                    nacks++;\n                }\n            });\n\n            // Keep dispatching until the pool size reaches a sane level.\n            if (pool.length >= dispatchLimit && nacks === 0) {\n                dispatch(eventsTrackUrl);\n            }\n        })\n        .catch((err) => {\n            dispatching = false;\n            // Try dispatching again in 20 seconds, if we aren't already trying\n            if (!dispatchRetryInterval) {\n                console.warn(\n                    \"We're gonna keep trying, but there was an error while dispatching events:\",\n                    err\n                );\n\n                dispatchRetryInterval = setInterval(\n                    () => dispatch(eventsTrackUrl),\n                    20000\n                );\n            }\n        });\n}\nvar dispatch = throttle(_dispatch, 4000);\n\nclientLocalStorage.set('event-tracker-pool', []);\n\ntry {\n    window.addEventListener(\n        'beforeunload',\n        () => {\n            pool = pool.concat(getPool());\n\n            clientLocalStorage.set('event-tracker-pool', pool);\n        },\n        false\n    );\n} catch (error) {}\n"],"names":["locale","coreUrl","eventsTrackUrl","prefixKey","storage","window","localStorage","error","get","key","JSON","parse","set","value","_JSON$stringify","isBrowser","document","isNode","process","err","options","message","code","name","stack","time","Date","uuid","replace","c","r","Math","random","v","toString","getQueryParam","field","url","href","location","reg","RegExp","string","exec","undefined","getRandomNumberBetween","from","to","floor","getOS","ua","navigator","userAgent","_indexOfInstanceProperty","getDeviceCategory","deviceCategory","platform","test","getPointer","pointer","matchMedia","matches","getOrientation","width","height","getScreenDimensions","density","devicePixelRatio","logical","screen","physical","round","getUtcOffsetSeconds","now","jan1","getFullYear","tmp","toGMTString","jan2","substring","_lastIndexOfInstanceProperty","stdTimeOffset","getUtcDstOffsetSeconds","getTimezoneOffset","getColorBrightness","color","hex","_parseInt","rgb","sum","x","s","btoa","str","buffer","Buffer","chunk","arr","size","results","length","push","_spliceInstanceProperty","throttle","fn","threshold","scope","last","deferTimer","context","getTime","args","arguments","clearTimeout","_setTimeout","apply","loadImage","src","callback","img","Image","onload","onerror","Error","distance","lat1","lng1","lat2","lng2","radlat1","PI","radlat2","theta","radtheta","dist","sin","cos","acos","promiseCallbackInterop","fun","cbParameterIndex","makePromise","parameters","resolve","reject","neoCallback","result","callParameters","i","end","max","asc","createTrackerClient","id","clientLocalStorage","data","getPool","_Array$isArray","_filterInstanceProperty","evt","_i","pool","Tracker","defaultOptions","client","defaultEventsTrackUrl","geohash","country","dispatching","hasMadeInitialDispatch","dispatch","type","properties","version","trackId","_Object$assign","_e","_v","_t","_a","poolLimit","shift","Object","prototype","hasOwnProperty","call","trackEvent","parts","_concatInstanceProperty","join","viewToken","String","fromCharCode","_sliceInstanceProperty","md5","asBytes","dispatchLimit","ship","events","fetch","method","timeout","headers","body","then","response","json","dispatchRetryInterval","_dispatch","nacks","clearInterval","resEvent","status","poolEvent","catch","console","warn","_setInterval","addEventListener"],"mappings":"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"}