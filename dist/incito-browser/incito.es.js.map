{"version":3,"file":"incito.es.js","sources":["../../lib/incito-browser/utils.js","../../lib/incito-browser/views/view.js","../../lib/incito-browser/views/absolute-layout.js","../../lib/incito-browser/views/flex-layout.js","../../lib/incito-browser/views/image.js","../../lib/incito-browser/views/text.js","../../lib/incito-browser/views/video.js","../../lib/incito-browser/views/video-embed.js","../../lib/incito-browser/incito.js"],"sourcesContent":["export const formatUnit = (unit) => {\n    if (unit == null) {\n        return 0;\n    } else if (typeof unit === 'number') {\n        return `${unit}px`;\n    } else if (typeof unit === 'string') {\n        return unit.replace('dp', 'px');\n    } else {\n        return 0;\n    }\n};\n\nexport const isDefinedStr = (value) =>\n    typeof value === 'string' && value.length > 0;\n\nexport const escapeHTML = (unsafe = '') =>\n    unsafe\n        .replace(/&/g, '&amp;')\n        .replace(/</g, '&lt;')\n        .replace(/>/g, '&gt;')\n        .replace(/\"/g, '&quot;')\n        .replace(/'/g, '&#039;');\n\nexport const throttle = (fn, delay) => {\n    if (delay === 0) {\n        return fn;\n    }\n\n    let timer = false;\n\n    return () => {\n        if (timer) {\n            return;\n        }\n\n        timer = true;\n\n        return setTimeout(function () {\n            timer = false;\n\n            fn(...arguments);\n        }, delay);\n    };\n};\n","import {formatUnit, isDefinedStr} from '../utils';\nimport './view.styl';\n\nclass View {\n    constructor(attrs = {}) {\n        this.attrs = attrs;\n        this.el = this.createElement();\n\n        this.setAttributes();\n    }\n\n    render() {\n        return this;\n    }\n\n    createElement() {\n        const el = document.createElement(this.tagName);\n        const className = this.className ?? '';\n\n        el.className = 'incito__view ' + className;\n\n        return el;\n    }\n\n    setAttributes() {\n        // Identifier.\n        if (isDefinedStr(this.attrs.id)) {\n            this.el.setAttribute('data-id', this.attrs.id);\n        }\n\n        // Role.\n        if (isDefinedStr(this.attrs.role)) {\n            this.el.setAttribute('data-role', this.attrs.role);\n        }\n\n        // Accessibility label.\n        if (isDefinedStr(this.attrs.accessibility_label)) {\n            this.el.setAttribute('aria-label', this.attrs.accessibility_label);\n        }\n\n        // Accessibility visibility.\n        if (this.attrs.accessibility_hidden === true) {\n            this.el.setAttribute('aria-hidden', true);\n        }\n\n        // Feature labels.\n        if (Array.isArray(this.attrs.feature_labels)) {\n            const featureLabels = this.attrs.feature_labels.filter(\n                (featureLabel) => /^[a-z_-]{1,14}$/.test(featureLabel)\n            );\n\n            if (featureLabels.length) {\n                this.el.setAttribute(\n                    'data-feature-labels',\n                    featureLabels.join(',')\n                );\n            }\n        }\n\n        // Title.\n        if (isDefinedStr(this.attrs.title)) {\n            this.el.setAttribute('title', this.attrs.title);\n        }\n\n        // Gravity.\n        if (isDefinedStr(this.attrs.gravity)) {\n            this.el.setAttribute('data-gravity', this.attrs.gravity);\n        }\n\n        // Link.\n        if (isDefinedStr(this.attrs.link)) {\n            this.el.setAttribute('data-link', '');\n            this.el.addEventListener(\n                'click',\n                () => {\n                    window.open(this.attrs.link, '_blank');\n                },\n                false\n            );\n        }\n\n        // Width.\n        if (this.attrs.layout_width === 'match_parent') {\n            this.el.style.width = '100%';\n        } else if (this.attrs.layout_width === 'wrap_content') {\n            this.el.style.display = 'inline-block';\n        } else if (this.attrs.layout_width != null) {\n            this.el.style.width = formatUnit(this.attrs.layout_width);\n        }\n\n        // Height.\n        if (this.attrs.layout_height === 'match_parent') {\n            this.el.style.height = '100%';\n        } else if (this.attrs.layout_height === 'wrap_content') {\n            this.el.style.height = 'auto';\n        } else if (this.attrs.layout_height != null) {\n            this.el.style.height = formatUnit(this.attrs.layout_height);\n        }\n\n        // Min width.\n        if (this.attrs.min_width != null) {\n            this.el.style.minWidth = formatUnit(this.attrs.min_width);\n        }\n\n        // Max width.\n        if (this.attrs.max_width != null) {\n            this.el.style.maxWidth = formatUnit(this.attrs.max_width);\n        }\n\n        // Min height.\n        if (this.attrs.min_height != null) {\n            this.el.style.minHeight = formatUnit(this.attrs.min_height);\n        }\n\n        // Max height.\n        if (this.attrs.max_height != null) {\n            this.el.style.maxHeight = formatUnit(this.attrs.max_height);\n        }\n\n        // Position in relation to parent.\n        if (this.attrs.layout_top != null) {\n            this.el.style.top = formatUnit(this.attrs.layout_top);\n        }\n        if (this.attrs.layout_left != null) {\n            this.el.style.left = formatUnit(this.attrs.layout_left);\n        }\n        if (this.attrs.layout_right != null) {\n            this.el.style.right = formatUnit(this.attrs.layout_right);\n        }\n        if (this.attrs.layout_bottom != null) {\n            this.el.style.bottom = formatUnit(this.attrs.layout_bottom);\n        }\n\n        // Background.\n        if (isDefinedStr(this.attrs.background_color)) {\n            this.el.style.backgroundColor = this.attrs.background_color;\n        }\n        if (isDefinedStr(this.attrs.background_image)) {\n            this.el.setAttribute('data-src', this.attrs.background_image);\n            this.lazyload = true;\n        }\n        if (\n            ['repeat_x', 'repeat_y', 'repeat'].indexOf(\n                this.attrs.background_tile_mode\n            ) !== -1\n        ) {\n            this.el.style.backgroundRepeat = this.attrs.background_tile_mode.replace(\n                '_',\n                '-'\n            );\n        }\n        if (isDefinedStr(this.attrs.background_image_position)) {\n            this.el.style.backgroundPosition = this.attrs.background_image_position.replace(\n                '_',\n                ' '\n            );\n        }\n        if (this.attrs.background_image_scale_type === 'center_crop') {\n            this.el.style.backgroundSize = 'cover';\n        } else if (this.attrs.background_image_scale_type === 'center_inside') {\n            this.el.style.backgroundSize = 'contain';\n        }\n\n        // Margin.\n        if (this.attrs.layout_margin != null) {\n            this.el.style.margin = formatUnit(this.attrs.layout_margin);\n        }\n        if (this.attrs.layout_margin_top != null) {\n            this.el.style.marginTop = formatUnit(this.attrs.layout_margin_top);\n        }\n        if (this.attrs.layout_margin_left != null) {\n            this.el.style.marginLeft = formatUnit(\n                this.attrs.layout_margin_left\n            );\n        }\n        if (this.attrs.layout_margin_right != null) {\n            this.el.style.marginRight = formatUnit(\n                this.attrs.layout_margin_right\n            );\n        }\n        if (this.attrs.layout_margin_bottom != null) {\n            this.el.style.marginBottom = formatUnit(\n                this.attrs.layout_margin_bottom\n            );\n        }\n\n        // Padding.\n        if (this.attrs.padding != null) {\n            this.el.style.padding = formatUnit(this.attrs.padding);\n        }\n        if (this.attrs.padding_top != null) {\n            this.el.style.paddingTop = formatUnit(this.attrs.padding_top);\n        }\n        if (this.attrs.padding_left != null) {\n            this.el.style.paddingLeft = formatUnit(this.attrs.padding_left);\n        }\n        if (this.attrs.padding_right != null) {\n            this.el.style.paddingRight = formatUnit(this.attrs.padding_right);\n        }\n        if (this.attrs.padding_bottom != null) {\n            this.el.style.paddingBottom = formatUnit(this.attrs.padding_bottom);\n        }\n\n        // Corner radius.\n        if (this.attrs.corner_radius != null) {\n            this.el.style.borderRadius = formatUnit(this.attrs.corner_radius);\n        }\n        if (this.attrs.corner_top_left_radius != null) {\n            this.el.style.borderTopLeftRadius = formatUnit(\n                this.attrs.corner_top_left_radius\n            );\n        }\n        if (this.attrs.corner_top_right_radius != null) {\n            this.el.style.borderTopRightRadius = formatUnit(\n                this.attrs.corner_top_right_radius\n            );\n        }\n        if (this.attrs.corner_bottom_left_radius != null) {\n            this.el.style.borderBottomLeftRadius = formatUnit(\n                this.attrs.corner_bottom_left_radius\n            );\n        }\n        if (this.attrs.corner_bottom_right_radius != null) {\n            this.el.style.borderBottomRightRadius = formatUnit(\n                this.attrs.corner_bottom_right_radius\n            );\n        }\n\n        // Clip children.\n        if (this.attrs.clip_children === false) {\n            this.el.style.overflow = 'visible';\n        }\n\n        // Shadow.\n        const shadow = this.getShadow();\n\n        if (shadow != null) {\n            this.el.style.boxShadow = `${shadow.dx}px ${shadow.dy}px ${shadow.radius}px ${shadow.color}`;\n        }\n\n        // Stroke.\n        const strokeStyles = ['solid', 'dotted', 'dashed'];\n\n        if (this.attrs.stroke_width != null) {\n            this.el.style.borderWidth = formatUnit(this.attrs.stroke_width);\n        }\n        if (this.attrs.stroke_color != null) {\n            this.el.style.borderColor = this.attrs.stroke_color;\n        }\n        if (strokeStyles.indexOf(this.attrs.stroke_style) !== -1) {\n            this.el.style.borderStyle = this.attrs.stroke_style;\n        }\n\n        if (this.attrs.stroke_top_width != null) {\n            this.el.style.borderTopWidth = formatUnit(\n                this.attrs.stroke_top_width\n            );\n        }\n        if (this.attrs.stroke_top_color != null) {\n            this.el.style.borderTopColor = this.attrs.stroke_top_color;\n        }\n\n        if (this.attrs.stroke_left_width != null) {\n            this.el.style.borderLeftWidth = formatUnit(\n                this.attrs.stroke_left_width\n            );\n        }\n        if (this.attrs.stroke_left_color != null) {\n            this.el.style.borderLeftColor = this.attrs.stroke_left_color;\n        }\n\n        if (this.attrs.stroke_right_width != null) {\n            this.el.style.borderRightWidth = formatUnit(\n                this.attrs.stroke_right_width\n            );\n        }\n        if (this.attrs.stroke_right_color != null) {\n            this.el.style.borderRightColor = this.attrs.stroke_right_color;\n        }\n\n        if (this.attrs.stroke_bottom_width != null) {\n            this.el.style.borderBottomWidth = formatUnit(\n                this.attrs.stroke_bottom_width\n            );\n        }\n        if (this.attrs.stroke_bottom_color != null) {\n            this.el.style.borderBottomColor = this.attrs.stroke_bottom_color;\n        }\n\n        // Flex.\n        if (typeof this.attrs.layout_flex_shrink === 'number') {\n            this.el.style.flexShrink = this.attrs.layout_flex_shrink;\n            this.el.style.msFlexShrink = this.attrs.layout_flex_shrink;\n        }\n        if (typeof this.attrs.layout_flex_grow === 'number') {\n            this.el.style.flexGrow = this.attrs.layout_flex_grow;\n            this.el.style.msFlexGrow = this.attrs.layout_flex_grow;\n        }\n        if (this.attrs.layout_flex_basis != null) {\n            this.el.style.flexBasis = formatUnit(this.attrs.layout_flex_basis);\n            this.el.style.msFlexBasis = formatUnit(\n                this.attrs.layout_flex_basis\n            );\n        }\n\n        // Transforms.\n        const transforms = this.getTransforms();\n\n        if (transforms.length > 0) {\n            this.el.style.transform = transforms.join(' ');\n        }\n\n        // Transform origin.\n        if (\n            Array.isArray(this.attrs.transform_origin) &&\n            this.attrs.transform_origin.length === 2\n        ) {\n            this.el.style.transformOrigin = [\n                formatUnit(this.attrs.transform_origin[0]),\n                formatUnit(this.attrs.transform_origin[1])\n            ].join(' ');\n        }\n    }\n\n    getTransforms() {\n        const transforms = [];\n        const translateX = formatUnit(this.attrs.transform_translate_x);\n        const translateY = formatUnit(this.attrs.transform_translate_y);\n\n        if (translateX !== 0) {\n            transforms.push(`translateX(${translateX})`);\n        }\n\n        if (translateY !== 0) {\n            transforms.push(`translateY(${translateY})`);\n        }\n\n        if (\n            typeof this.attrs.transform_rotate === 'number' &&\n            this.attrs.transform_rotate !== 0\n        ) {\n            transforms.push(`rotate(${this.attrs.transform_rotate}deg)`);\n        }\n\n        if (\n            typeof this.attrs.transform_scale === 'number' &&\n            this.attrs.transform_scale !== 1\n        ) {\n            transforms.push(`scale(${this.attrs.transform_scale})`);\n        }\n\n        return transforms;\n    }\n\n    getShadow() {\n        if (isDefinedStr(this.attrs.shadow_color)) {\n            const dx =\n                typeof this.attrs.shadow_dx === 'number'\n                    ? this.attrs.shadow_dx\n                    : 0;\n            const dy =\n                typeof this.attrs.shadow_dy === 'number'\n                    ? this.attrs.shadow_dy\n                    : 0;\n            const radius =\n                typeof this.attrs.shadow_radius === 'number'\n                    ? this.attrs.shadow_radius\n                    : 0;\n            const color = this.attrs.shadow_color;\n\n            return {\n                dx,\n                dy,\n                radius,\n                color\n            };\n        }\n    }\n}\nView.prototype.tagName = 'div';\nView.prototype.className = null;\nexport default View;\n","import './absolute-layout.styl';\nimport View from './view';\n\nclass AbsoluteLayout extends View {}\nAbsoluteLayout.prototype.className = 'incito__absolute-layout-view';\nexport default AbsoluteLayout;\n","import './flex-layout.styl';\nimport View from './view';\n\nconst alignItemModes = [\n    'stretch',\n    'center',\n    'flex-start',\n    'flex-end',\n    'baseline'\n];\nconst flexJustifyModes = [\n    'flex-start',\n    'flex-end',\n    'center',\n    'space-between',\n    'space-around'\n];\nconst flexDirectionModes = ['row', 'column'];\n\nclass FlexLayout extends View {\n    render() {\n        if (alignItemModes.indexOf(this.attrs.layout_flex_align_items) !== -1) {\n            this.el.style.alignItems = this.attrs.layout_flex_align_items;\n            this.el.style.msAlignItems = this.attrs.layout_flex_align_items;\n        }\n\n        if (\n            flexJustifyModes.indexOf(this.attrs.layout_flex_justify_content) !==\n            -1\n        ) {\n            this.el.style.justifyContent = this.attrs.layout_flex_justify_content;\n            this.el.style.msFlexPack = this.attrs.layout_flex_justify_content;\n        }\n\n        if (\n            flexDirectionModes.indexOf(this.attrs.layout_flex_direction) !== -1\n        ) {\n            this.el.style.flexDirection = this.attrs.layout_flex_direction;\n            this.el.style.msFlexDirection = this.attrs.layout_flex_direction;\n        }\n\n        return this;\n    }\n}\nFlexLayout.prototype.className = 'incito__flex-layout-view';\nexport default FlexLayout;\n","import {isDefinedStr} from '../utils';\nimport './image.styl';\nimport View from './view';\n\nclass Image extends View {\n    render() {\n        if (isDefinedStr(this.attrs.src)) {\n            this.el.setAttribute('data-src', this.attrs.src);\n        }\n\n        if (isDefinedStr(this.attrs.label)) {\n            this.el.setAttribute('alt', this.attrs.label);\n        } else {\n            this.el.setAttribute('alt', '');\n        }\n\n        return this;\n    }\n}\nImage.prototype.tagName = 'img';\nImage.prototype.className = 'incito__image-view';\nImage.prototype.lazyload = true;\nexport default Image;\n","import {escapeHTML, isDefinedStr} from '../utils';\nimport './text.styl';\nimport View from './view';\n\nclass TextView extends View {\n    render() {\n        if (!isDefinedStr(this.attrs.text)) {\n            return this;\n        }\n\n        const textStyles = (this.attrs.text_style || '').split('|');\n        let {text} = this.attrs;\n\n        if (Array.isArray(this.attrs.spans) && this.attrs.spans.length > 0) {\n            const parsedText = this.parseSpans(text, this.attrs.spans);\n            text = parsedText.map((item) => {\n                const escapedText = escapeHTML(item.text || '');\n\n                if (item.span?.name === 'link' && item.span.url != null) {\n                    return `<a href=\"${encodeURI(\n                        item.span.url\n                    )}\" rel=\"external\" target=\"_blank\">${escapedText}</a>`;\n                }\n                if (item.span?.name != null) {\n                    const spanName = item.span.name;\n\n                    return `<span data-name=\"${spanName}\">${escapedText}</span>`;\n                }\n                return escapedText;\n            });\n            text = text.join('');\n        } else {\n            text = escapeHTML(text);\n        }\n\n        if (this.attrs.text_prevent_widow) {\n            text = text\n                .replace(/&nbsp;([^\\s]+)$/, ' $1')\n                .replace(/\\s([^\\s]+)\\s*$/, '&nbsp;$1');\n        }\n\n        this.el.innerHTML = text.replace(/\\n/g, '<br>');\n\n        // Font family.\n        if (\n            Array.isArray(this.attrs.font_family) &&\n            this.attrs.font_family.length > 0\n        ) {\n            this.el.style.fontFamily = `${this.attrs.font_family.join(\n                ', '\n            )} !important`;\n        } else {\n            this.el.style.fontFamily = 'inherit !important';\n        }\n\n        // Text size.\n        if (this.attrs.text_size != null) {\n            this.el.style.fontSize = `${this.attrs.text_size}px`;\n        }\n\n        // Line height.\n        if (this.attrs.line_spacing_multiplier != null) {\n            this.el.style.lineHeight = this.attrs.line_spacing_multiplier;\n        }\n\n        // Text color.\n        if (this.attrs.text_color != null) {\n            this.el.style.color = this.attrs.text_color;\n        }\n\n        // Text styles.\n        if (textStyles.indexOf('bold') !== -1) {\n            this.el.style.fontWeight = 'bold';\n        }\n        if (textStyles.indexOf('italic') !== -1) {\n            this.el.style.fontStyle = 'italic';\n        }\n\n        if (Array.isArray(this.attrs.text_decoration_line)) {\n            this.el.style.textDecorationLine = this.attrs.text_decoration_line.join(\n                ' '\n            );\n        }\n\n        // Text shadow.\n        const textShadow = this.getTextShadow();\n\n        if (isDefinedStr(this.attrs.text_shadow)) {\n            this.el.style.textShadow = this.attrs.text_shadow;\n        } else if (textShadow != null) {\n            this.el.style.textShadow = `${textShadow.dx}px ${textShadow.dy}px ${textShadow.radius}px ${textShadow.color}`;\n        }\n\n        // Text alignment.\n        if (this.attrs.text_alignment === 'left') {\n            this.el.style.textAlign = 'left';\n        } else if (this.attrs.text_alignment === 'center') {\n            this.el.style.textAlign = 'center';\n        } else if (this.attrs.text_alignment === 'right') {\n            this.el.style.textAlign = 'right';\n        }\n\n        // Max lines.\n        if (this.attrs.single_line === true || this.attrs.max_lines === 1) {\n            this.el.setAttribute('data-single-line', true);\n        } else if (typeof this.attrs.max_lines === 'number') {\n            this.el.style.display = '-webkit-box';\n            this.el.style.webkitLineClamp = this.attrs.max_lines;\n            this.el.style.webkitBoxOrient = 'vertical';\n        }\n\n        // All caps.\n        if (this.attrs.text_all_caps === true) {\n            this.el.style.textTransform = 'uppercase';\n        }\n\n        return this;\n    }\n\n    parseSpans(text, spans = []) {\n        const result = [];\n\n        if (spans.length === 0) {\n            result.push({\n                text\n            });\n        } else if (spans[0].start > 0) {\n            result.push({\n                text: text.slice(0, spans[0].start)\n            });\n        }\n\n        spans.forEach((span, i) => {\n            const startIndex = span.start;\n            const endIndex = span.end;\n\n            result.push({\n                text: text.slice(startIndex, endIndex),\n                span\n            });\n\n            if (i === spans.length - 1) {\n                if (endIndex < text.length) {\n                    result.push({\n                        text: text.slice(endIndex, text.length)\n                    });\n                }\n            } else if (endIndex < spans[i + 1].start) {\n                result.push({\n                    text: text.slice(endIndex, spans[i + 1].start)\n                });\n            }\n        });\n\n        return result;\n    }\n\n    getTextShadow() {\n        if (isDefinedStr(this.attrs.text_shadow_color)) {\n            const dx =\n                typeof this.attrs.text_shadow_dx === 'number'\n                    ? this.attrs.text_shadow_dx\n                    : 0;\n            const dy =\n                typeof this.attrs.text_shadow_dy === 'number'\n                    ? this.attrs.text_shadow_dy\n                    : 0;\n            const radius =\n                typeof this.attrs.text_shadow_radius === 'number'\n                    ? this.attrs.text_shadow_radius\n                    : 0;\n            const color = this.attrs.text_shadow_color;\n\n            return {\n                dx,\n                dy,\n                radius,\n                color\n            };\n        }\n    }\n}\nTextView.prototype.tagName = 'p';\nTextView.prototype.className = 'incito__text-view';\nexport default TextView;\n","import {isDefinedStr} from '../utils';\nimport View from './view';\n\nclass Video extends View {\n    render() {\n        if (!isDefinedStr(this.attrs.src)) {\n            return this;\n        }\n\n        this.el.muted = true;\n        this.el.preload = 'metadata';\n        this.el.setAttribute('muted', '');\n        this.el.setAttribute('playsinline', 'true');\n        this.el.setAttribute('webkit-playsinline', 'true');\n        this.el.setAttribute('data-src', this.attrs.src);\n        this.el.setAttribute('data-mime', this.attrs.mime);\n\n        if (this.attrs.autoplay === true) {\n            this.el.autoplay = true;\n        }\n\n        if (this.attrs.loop === true) {\n            this.el.loop = true;\n        }\n\n        if (this.attrs.controls === true) {\n            this.el.controls = true;\n        }\n\n        return this;\n    }\n}\nVideo.prototype.className = 'incito__video-view';\nVideo.prototype.tagName = 'video';\nVideo.prototype.lazyload = true;\nexport default Video;\n","import {isDefinedStr} from '../utils';\nimport './video-embed.styl';\nimport View from './view';\n\nconst allowedHostnames = ['.youtube.com', '.vimeo.com', '.twentythree.net'];\n\nclass FlexLayout extends View {\n    render() {\n        if (!isDefinedStr(this.attrs.src)) {\n            return this;\n        }\n\n        const {src} = this.attrs;\n        const linkEl = document.createElement('a');\n\n        linkEl.setAttribute('href', src);\n\n        const isSupported = allowedHostnames.find(\n            (hostname) => linkEl.hostname.slice(-hostname.length) === hostname\n        );\n\n        if (isSupported) {\n            this.el.setAttribute('data-src', src);\n            this.lazyload = true;\n        }\n\n        return this;\n    }\n}\nFlexLayout.prototype.className = 'incito__video-embed-view';\nFlexLayout.prototype.lazyload = false;\nexport default FlexLayout;\n","import './incito.styl';\nimport {isDefinedStr, throttle} from './utils';\nimport * as views from './views';\n\nlet requestIdleCallback;\nif (\n    typeof window !== 'undefined' &&\n    typeof window.requestIdleCallback === 'function'\n) {\n    ({requestIdleCallback} = window);\n} else {\n    requestIdleCallback = (cb) =>\n        setTimeout(function () {\n            const start = Date.now();\n            return cb({\n                didTimeout: false,\n                timeRemaining() {\n                    return Math.max(0, 50 - (Date.now() - start));\n                }\n            });\n        }, 1);\n}\n\n// like requestIdleCallback but effectively synchronous\n// as we give infinite time to run\nconst syncIdleCallback = function (cb) {\n    cb({\n        timeRemaining() {\n            return Number.MAX_VALUE;\n        },\n        didTimeout: false\n    });\n};\n\nexport default class Incito {\n    constructor(\n        containerEl,\n        {\n            incito = {},\n            renderLaziness = 1 // 0: All synchronous. 1: Visible synchronous, rest lazy. 2: All lazy.\n        }\n    ) {\n        this.containerEl = containerEl;\n        this.incito = incito;\n        this.renderLaziness = renderLaziness;\n        this.el = document.createElement('div');\n        this.ids = {};\n        this.views = flattenViews([], this.incito.root_view);\n        this.viewsLength = this.views.length;\n        this.viewIndex = 0;\n        this.lazyloadables = [];\n        this.lazyloader = throttle(this.lazyload.bind(this), 150);\n        this.renderedOutsideOfViewport = false;\n        this._events = {};\n    }\n\n    bind(event, fn) {\n        this._events[event] = this._events[event] || [];\n        return this._events[event].push(fn);\n    }\n\n    unbind(event, fn) {\n        if (this._events[event]) {\n            return this._events[event].splice(\n                this._events[event].indexOf(fn),\n                1\n            );\n        }\n    }\n\n    trigger(event) {\n        if (this._events[event]) {\n            return this._events[event].map(function (e) {\n                return e.apply(this, Array.prototype.slice.call(arguments, 1));\n            });\n        }\n    }\n\n    start() {\n        let triggeredVisibleRendered = false;\n        var render = (IdleDeadline) => {\n            this.render(IdleDeadline);\n\n            if (this.viewIndex <= this.viewsLength - 1) {\n                this.renderCallbackHandle = requestIdleCallback(render);\n            } else {\n                // make sure visibleRendered gets triggered even\n                // if renderedOutsideOfViewport wasn't\n                this.renderedOutsideOfViewport = true;\n                this.trigger('allRendered');\n            }\n\n            if (this.renderedOutsideOfViewport && !triggeredVisibleRendered) {\n                this.trigger('visibleRendered');\n\n                triggeredVisibleRendered = true;\n            }\n\n            if (this.renderedOutsideOfViewport) {\n                this.lazyload(0);\n            }\n        };\n\n        this.el.className = 'incito';\n        if (this.incito.locale != null) {\n            this.el.setAttribute('lang', this.incito.locale);\n        }\n\n        loadFonts(this.incito.font_assets);\n        this.applyTheme(this.incito.theme);\n\n        this.containerEl.appendChild(this.el);\n\n        // do first render synchronously unless we're very lazy\n        if (this.renderLaziness === 2) {\n            this.renderCallbackHandle = requestIdleCallback(render);\n        } else {\n            syncIdleCallback(render);\n        }\n\n        document.addEventListener('scroll', this.lazyloader, true);\n        window.addEventListener('resize', this.lazyloader, false);\n\n        return this;\n    }\n\n    destroy() {\n        cancelIdleCallback(this.renderCallbackHandle);\n        this.containerEl.removeChild(this.el);\n\n        document.removeEventListener('scroll', this.lazyloader, true);\n        window.removeEventListener('resize', this.lazyloader, false);\n\n        this.trigger('destroyed');\n    }\n\n    render(IdleDeadline) {\n        while (\n            IdleDeadline.timeRemaining() > 0 &&\n            this.viewIndex <= this.viewsLength - 1\n        ) {\n            const item = this.views[this.viewIndex];\n            const {attrs} = item;\n            const match = views[attrs.view_name] ?? views.View;\n            const view = new match(attrs).render();\n\n            if (attrs.id != null && typeof attrs.meta === 'object') {\n                this.ids[attrs.id] = attrs.meta;\n            }\n\n            if (view.lazyload === true) {\n                this.lazyloadables.push(view.el);\n            }\n\n            item.view = view;\n\n            if (item.parent?.view != null) {\n                item.parent.view.el.appendChild(view.el);\n            } else {\n                this.el.appendChild(view.el);\n            }\n\n            this.viewIndex++;\n\n            // check if we rendered something out of the viewport for the first time and yield.\n            // the check is expensive so it's faster to only check every few iterations, the downside is that\n            // we might overrender a tiny bit but it comes out to faster than checking every iteration.\n            if (\n                this.renderLaziness &&\n                !(this.viewIndex % 20) &&\n                !this.renderedOutsideOfViewport &&\n                !isInsideViewport(view.el)\n            ) {\n                this.renderedOutsideOfViewport = true;\n\n                break;\n            }\n        }\n    }\n\n    applyTheme(theme = {}) {\n        if (Array.isArray(theme.font_family)) {\n            this.el.style.fontFamily = theme.font_family.join(', ');\n        }\n\n        if (isDefinedStr(theme.background_color)) {\n            this.el.style.backgroundColor = theme.background_color;\n        }\n\n        if (isDefinedStr(theme.text_color)) {\n            this.el.style.color = theme.text_color;\n        }\n\n        if (typeof theme.line_spacing_multiplier === 'number') {\n            this.el.style.lineHeight = theme.line_spacing_multiplier;\n        }\n    }\n\n    lazyload(threshold) {\n        this.lazyloadables = this.lazyloadables.filter(function (el) {\n            if (isInsideViewport(el, threshold)) {\n                revealElement(el);\n\n                return false;\n            } else {\n                return true;\n            }\n        });\n    }\n}\n\nvar flattenViews = function (views, attrs, parent) {\n    const item = {\n        attrs,\n        view: null,\n        parent\n    };\n\n    views.push(item);\n\n    if (Array.isArray(attrs.child_views)) {\n        attrs.child_views.forEach((childAttrs) =>\n            flattenViews(views, childAttrs, item)\n        );\n    }\n\n    return views;\n};\n\nvar loadFonts = function (fontAssets = {}) {\n    let key, urls, value;\n    if ('FontFace' in window) {\n        for (key in fontAssets) {\n            value = fontAssets[key];\n            urls = value.src.map((src) => `url(${src[1]})`).join(', ');\n            const font = new FontFace(key, urls, {\n                style: value.style ?? 'normal',\n                weight: value.weight ?? 'normal',\n                display: 'swap'\n            });\n\n            document.fonts.add(font);\n\n            font.load();\n        }\n    } else {\n        const styleEl = document.createElement('style');\n\n        for (key in fontAssets) {\n            value = fontAssets[key];\n            urls = value.src\n                .map((src) => `url('${src[1]}') format('${src[0]}')`)\n                .join(', ');\n            const text = `\\\n@font-face {\n    font-family: '${key}';\n    font-display: swap;\n    src: ${urls};\n}\\\n`;\n\n            styleEl.appendChild(document.createTextNode(text));\n        }\n\n        document.head.appendChild(styleEl);\n    }\n};\n\nvar isInsideViewport = function (el, threshold) {\n    const windowHeight = window.innerHeight;\n    threshold = threshold ?? windowHeight;\n    const rect = el.getBoundingClientRect();\n\n    return (\n        rect.top <= windowHeight + threshold &&\n        rect.top + rect.height >= -threshold\n    );\n};\n\nvar revealElement = function (el) {\n    const src = el.getAttribute('data-src');\n\n    if (el.tagName.toLowerCase() === 'img') {\n        el.addEventListener('load', function () {\n            el.className += ' incito--loaded';\n        });\n        el.setAttribute('src', src);\n    } else if (el.tagName.toLowerCase() === 'video') {\n        const sourceEl = document.createElement('source');\n\n        sourceEl.setAttribute('src', src);\n        sourceEl.setAttribute('type', el.getAttribute('data-mime'));\n\n        el.appendChild(sourceEl);\n    } else if (/incito__video-embed-view/gi.test(el.className)) {\n        const iframeEl = document.createElement('iframe');\n\n        iframeEl.setAttribute(\n            'allow',\n            'fullscreen; accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture'\n        );\n        iframeEl.setAttribute('src', src);\n\n        el.appendChild(iframeEl);\n    } else {\n        el.style.backgroundImage = `url(${src})`;\n    }\n};\n"],"names":["formatUnit","unit","replace","isDefinedStr","value","length","escapeHTML","unsafe","throttle","fn","delay","timer","arguments","View","attrs","el","createElement","setAttributes","document","tagName","className","id","setAttribute","role","accessibility_label","accessibility_hidden","feature_labels","featureLabels","featureLabel","test","join","title","gravity","link","addEventListener","window","open","layout_width","style","width","display","layout_height","height","min_width","minWidth","max_width","maxWidth","min_height","minHeight","max_height","maxHeight","layout_top","top","layout_left","left","layout_right","right","layout_bottom","bottom","background_color","backgroundColor","background_image","lazyload","background_tile_mode","backgroundRepeat","background_image_position","backgroundPosition","background_image_scale_type","backgroundSize","layout_margin","margin","layout_margin_top","marginTop","layout_margin_left","marginLeft","layout_margin_right","marginRight","layout_margin_bottom","marginBottom","padding","padding_top","paddingTop","padding_left","paddingLeft","padding_right","paddingRight","padding_bottom","paddingBottom","corner_radius","borderRadius","corner_top_left_radius","borderTopLeftRadius","corner_top_right_radius","borderTopRightRadius","corner_bottom_left_radius","borderBottomLeftRadius","corner_bottom_right_radius","borderBottomRightRadius","clip_children","overflow","shadow","getShadow","boxShadow","dx","dy","radius","color","strokeStyles","stroke_width","borderWidth","stroke_color","borderColor","stroke_style","borderStyle","stroke_top_width","borderTopWidth","stroke_top_color","borderTopColor","stroke_left_width","borderLeftWidth","stroke_left_color","borderLeftColor","stroke_right_width","borderRightWidth","stroke_right_color","borderRightColor","stroke_bottom_width","borderBottomWidth","stroke_bottom_color","borderBottomColor","layout_flex_shrink","flexShrink","msFlexShrink","layout_flex_grow","flexGrow","msFlexGrow","layout_flex_basis","flexBasis","msFlexBasis","transforms","getTransforms","transform","transform_origin","transformOrigin","translateX","transform_translate_x","translateY","transform_translate_y","push","transform_rotate","transform_scale","shadow_color","shadow_dx","shadow_dy","shadow_radius","prototype","AbsoluteLayout","alignItemModes","flexJustifyModes","flexDirectionModes","FlexLayout","layout_flex_align_items","alignItems","msAlignItems","layout_flex_justify_content","justifyContent","msFlexPack","layout_flex_direction","flexDirection","msFlexDirection","Image","src","label","TextView","text","textStyles","text_style","split","spans","parsedText","parseSpans","item","escapedText","span","name","url","encodeURI","spanName","text_prevent_widow","innerHTML","font_family","fontFamily","text_size","fontSize","line_spacing_multiplier","lineHeight","text_color","fontWeight","fontStyle","text_decoration_line","textDecorationLine","textShadow","getTextShadow","text_shadow","text_alignment","textAlign","single_line","max_lines","webkitLineClamp","webkitBoxOrient","text_all_caps","textTransform","result","start","i","startIndex","endIndex","end","text_shadow_color","text_shadow_dx","text_shadow_dy","text_shadow_radius","Video","muted","preload","mime","autoplay","loop","controls","allowedHostnames","linkEl","isSupported","hostname","requestIdleCallback","cb","didTimeout","timeRemaining","Math","max","syncIdleCallback","Number","MAX_VALUE","Incito","containerEl","incito","renderLaziness","ids","views","flattenViews","root_view","viewsLength","viewIndex","lazyloadables","lazyloader","renderedOutsideOfViewport","_events","event","e","apply","Array","call","triggeredVisibleRendered","render","IdleDeadline","renderCallbackHandle","trigger","locale","loadFonts","font_assets","applyTheme","theme","appendChild","cancelIdleCallback","removeChild","removeEventListener","match","view_name","view","meta","parent","isInsideViewport","threshold","revealElement","child_views","childAttrs","fontAssets","key","urls","font","FontFace","weight","fonts","add","load","styleEl","createTextNode","head","windowHeight","innerHeight","rect","getBoundingClientRect","getAttribute","toLowerCase","sourceEl","iframeEl","backgroundImage"],"mappings":"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"}