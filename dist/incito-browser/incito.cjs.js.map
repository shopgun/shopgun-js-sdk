{"version":3,"file":"incito.cjs.js","sources":["../../lib/incito-browser/utils.js","../../lib/incito-browser/views/view.js","../../lib/incito-browser/views/absolute-layout.js","../../lib/incito-browser/views/flex-layout.js","../../lib/incito-browser/views/image.js","../../lib/incito-browser/views/text.js","../../lib/incito-browser/views/video.js","../../lib/incito-browser/views/video-embed.js","../../lib/incito-browser/incito.js"],"sourcesContent":["export const formatUnit = (unit) => {\n    if (unit == null) {\n        return 0;\n    } else if (typeof unit === 'number') {\n        return `${unit}px`;\n    } else if (typeof unit === 'string') {\n        return unit.replace('dp', 'px');\n    } else {\n        return 0;\n    }\n};\n\nexport const isDefinedStr = (value) =>\n    typeof value === 'string' && value.length > 0;\n\nexport const escapeHTML = (unsafe = '') =>\n    unsafe\n        .replace(/&/g, '&amp;')\n        .replace(/</g, '&lt;')\n        .replace(/>/g, '&gt;')\n        .replace(/\"/g, '&quot;')\n        .replace(/'/g, '&#039;');\n\nexport const throttle = (fn, delay) => {\n    if (delay === 0) {\n        return fn;\n    }\n\n    let timer = false;\n\n    return () => {\n        if (timer) {\n            return;\n        }\n\n        timer = true;\n\n        return setTimeout(function () {\n            timer = false;\n\n            fn(...arguments);\n        }, delay);\n    };\n};\n","import {formatUnit, isDefinedStr} from '../utils';\nimport './view.styl';\n\nclass View {\n    constructor(attrs = {}) {\n        this.attrs = attrs;\n        this.el = this.createElement();\n\n        this.setAttributes();\n    }\n\n    render() {\n        return this;\n    }\n\n    createElement() {\n        const el = document.createElement(this.tagName);\n        const className = this.className ?? '';\n\n        el.className = 'incito__view ' + className;\n\n        return el;\n    }\n\n    setAttributes() {\n        // Identifier.\n        if (isDefinedStr(this.attrs.id)) {\n            this.el.setAttribute('data-id', this.attrs.id);\n        }\n\n        // Role.\n        if (isDefinedStr(this.attrs.role)) {\n            this.el.setAttribute('data-role', this.attrs.role);\n        }\n\n        // Accessibility label.\n        if (isDefinedStr(this.attrs.accessibility_label)) {\n            this.el.setAttribute('aria-label', this.attrs.accessibility_label);\n        }\n\n        // Accessibility visibility.\n        if (this.attrs.accessibility_hidden === true) {\n            this.el.setAttribute('aria-hidden', true);\n        }\n\n        // Feature labels.\n        if (Array.isArray(this.attrs.feature_labels)) {\n            const featureLabels = this.attrs.feature_labels.filter(\n                (featureLabel) => /^[a-z_-]{1,14}$/.test(featureLabel)\n            );\n\n            if (featureLabels.length) {\n                this.el.setAttribute(\n                    'data-feature-labels',\n                    featureLabels.join(',')\n                );\n            }\n        }\n\n        // Title.\n        if (isDefinedStr(this.attrs.title)) {\n            this.el.setAttribute('title', this.attrs.title);\n        }\n\n        // Gravity.\n        if (isDefinedStr(this.attrs.gravity)) {\n            this.el.setAttribute('data-gravity', this.attrs.gravity);\n        }\n\n        // Link.\n        if (isDefinedStr(this.attrs.link)) {\n            this.el.setAttribute('data-link', '');\n            this.el.addEventListener(\n                'click',\n                () => {\n                    window.open(this.attrs.link, '_blank');\n                },\n                false\n            );\n        }\n\n        // Width.\n        if (this.attrs.layout_width === 'match_parent') {\n            this.el.style.width = '100%';\n        } else if (this.attrs.layout_width === 'wrap_content') {\n            this.el.style.display = 'inline-block';\n        } else if (this.attrs.layout_width != null) {\n            this.el.style.width = formatUnit(this.attrs.layout_width);\n        }\n\n        // Height.\n        if (this.attrs.layout_height === 'match_parent') {\n            this.el.style.height = '100%';\n        } else if (this.attrs.layout_height === 'wrap_content') {\n            this.el.style.height = 'auto';\n        } else if (this.attrs.layout_height != null) {\n            this.el.style.height = formatUnit(this.attrs.layout_height);\n        }\n\n        // Min width.\n        if (this.attrs.min_width != null) {\n            this.el.style.minWidth = formatUnit(this.attrs.min_width);\n        }\n\n        // Max width.\n        if (this.attrs.max_width != null) {\n            this.el.style.maxWidth = formatUnit(this.attrs.max_width);\n        }\n\n        // Min height.\n        if (this.attrs.min_height != null) {\n            this.el.style.minHeight = formatUnit(this.attrs.min_height);\n        }\n\n        // Max height.\n        if (this.attrs.max_height != null) {\n            this.el.style.maxHeight = formatUnit(this.attrs.max_height);\n        }\n\n        // Position in relation to parent.\n        if (this.attrs.layout_top != null) {\n            this.el.style.top = formatUnit(this.attrs.layout_top);\n        }\n        if (this.attrs.layout_left != null) {\n            this.el.style.left = formatUnit(this.attrs.layout_left);\n        }\n        if (this.attrs.layout_right != null) {\n            this.el.style.right = formatUnit(this.attrs.layout_right);\n        }\n        if (this.attrs.layout_bottom != null) {\n            this.el.style.bottom = formatUnit(this.attrs.layout_bottom);\n        }\n\n        // Background.\n        if (isDefinedStr(this.attrs.background_color)) {\n            this.el.style.backgroundColor = this.attrs.background_color;\n        }\n        if (isDefinedStr(this.attrs.background_image)) {\n            this.el.setAttribute('data-src', this.attrs.background_image);\n            this.lazyload = true;\n        }\n        if (\n            ['repeat_x', 'repeat_y', 'repeat'].indexOf(\n                this.attrs.background_tile_mode\n            ) !== -1\n        ) {\n            this.el.style.backgroundRepeat = this.attrs.background_tile_mode.replace(\n                '_',\n                '-'\n            );\n        }\n        if (isDefinedStr(this.attrs.background_image_position)) {\n            this.el.style.backgroundPosition = this.attrs.background_image_position.replace(\n                '_',\n                ' '\n            );\n        }\n        if (this.attrs.background_image_scale_type === 'center_crop') {\n            this.el.style.backgroundSize = 'cover';\n        } else if (this.attrs.background_image_scale_type === 'center_inside') {\n            this.el.style.backgroundSize = 'contain';\n        }\n\n        // Margin.\n        if (this.attrs.layout_margin != null) {\n            this.el.style.margin = formatUnit(this.attrs.layout_margin);\n        }\n        if (this.attrs.layout_margin_top != null) {\n            this.el.style.marginTop = formatUnit(this.attrs.layout_margin_top);\n        }\n        if (this.attrs.layout_margin_left != null) {\n            this.el.style.marginLeft = formatUnit(\n                this.attrs.layout_margin_left\n            );\n        }\n        if (this.attrs.layout_margin_right != null) {\n            this.el.style.marginRight = formatUnit(\n                this.attrs.layout_margin_right\n            );\n        }\n        if (this.attrs.layout_margin_bottom != null) {\n            this.el.style.marginBottom = formatUnit(\n                this.attrs.layout_margin_bottom\n            );\n        }\n\n        // Padding.\n        if (this.attrs.padding != null) {\n            this.el.style.padding = formatUnit(this.attrs.padding);\n        }\n        if (this.attrs.padding_top != null) {\n            this.el.style.paddingTop = formatUnit(this.attrs.padding_top);\n        }\n        if (this.attrs.padding_left != null) {\n            this.el.style.paddingLeft = formatUnit(this.attrs.padding_left);\n        }\n        if (this.attrs.padding_right != null) {\n            this.el.style.paddingRight = formatUnit(this.attrs.padding_right);\n        }\n        if (this.attrs.padding_bottom != null) {\n            this.el.style.paddingBottom = formatUnit(this.attrs.padding_bottom);\n        }\n\n        // Corner radius.\n        if (this.attrs.corner_radius != null) {\n            this.el.style.borderRadius = formatUnit(this.attrs.corner_radius);\n        }\n        if (this.attrs.corner_top_left_radius != null) {\n            this.el.style.borderTopLeftRadius = formatUnit(\n                this.attrs.corner_top_left_radius\n            );\n        }\n        if (this.attrs.corner_top_right_radius != null) {\n            this.el.style.borderTopRightRadius = formatUnit(\n                this.attrs.corner_top_right_radius\n            );\n        }\n        if (this.attrs.corner_bottom_left_radius != null) {\n            this.el.style.borderBottomLeftRadius = formatUnit(\n                this.attrs.corner_bottom_left_radius\n            );\n        }\n        if (this.attrs.corner_bottom_right_radius != null) {\n            this.el.style.borderBottomRightRadius = formatUnit(\n                this.attrs.corner_bottom_right_radius\n            );\n        }\n\n        // Clip children.\n        if (this.attrs.clip_children === false) {\n            this.el.style.overflow = 'visible';\n        }\n\n        // Shadow.\n        const shadow = this.getShadow();\n\n        if (shadow != null) {\n            this.el.style.boxShadow = `${shadow.dx}px ${shadow.dy}px ${shadow.radius}px ${shadow.color}`;\n        }\n\n        // Stroke.\n        const strokeStyles = ['solid', 'dotted', 'dashed'];\n\n        if (this.attrs.stroke_width != null) {\n            this.el.style.borderWidth = formatUnit(this.attrs.stroke_width);\n        }\n        if (this.attrs.stroke_color != null) {\n            this.el.style.borderColor = this.attrs.stroke_color;\n        }\n        if (strokeStyles.indexOf(this.attrs.stroke_style) !== -1) {\n            this.el.style.borderStyle = this.attrs.stroke_style;\n        }\n\n        if (this.attrs.stroke_top_width != null) {\n            this.el.style.borderTopWidth = formatUnit(\n                this.attrs.stroke_top_width\n            );\n        }\n        if (this.attrs.stroke_top_color != null) {\n            this.el.style.borderTopColor = this.attrs.stroke_top_color;\n        }\n\n        if (this.attrs.stroke_left_width != null) {\n            this.el.style.borderLeftWidth = formatUnit(\n                this.attrs.stroke_left_width\n            );\n        }\n        if (this.attrs.stroke_left_color != null) {\n            this.el.style.borderLeftColor = this.attrs.stroke_left_color;\n        }\n\n        if (this.attrs.stroke_right_width != null) {\n            this.el.style.borderRightWidth = formatUnit(\n                this.attrs.stroke_right_width\n            );\n        }\n        if (this.attrs.stroke_right_color != null) {\n            this.el.style.borderRightColor = this.attrs.stroke_right_color;\n        }\n\n        if (this.attrs.stroke_bottom_width != null) {\n            this.el.style.borderBottomWidth = formatUnit(\n                this.attrs.stroke_bottom_width\n            );\n        }\n        if (this.attrs.stroke_bottom_color != null) {\n            this.el.style.borderBottomColor = this.attrs.stroke_bottom_color;\n        }\n\n        // Flex.\n        if (typeof this.attrs.layout_flex_shrink === 'number') {\n            this.el.style.flexShrink = this.attrs.layout_flex_shrink;\n            this.el.style.msFlexShrink = this.attrs.layout_flex_shrink;\n        }\n        if (typeof this.attrs.layout_flex_grow === 'number') {\n            this.el.style.flexGrow = this.attrs.layout_flex_grow;\n            this.el.style.msFlexGrow = this.attrs.layout_flex_grow;\n        }\n        if (this.attrs.layout_flex_basis != null) {\n            this.el.style.flexBasis = formatUnit(this.attrs.layout_flex_basis);\n            this.el.style.msFlexBasis = formatUnit(\n                this.attrs.layout_flex_basis\n            );\n        }\n\n        // Transforms.\n        const transforms = this.getTransforms();\n\n        if (transforms.length > 0) {\n            this.el.style.transform = transforms.join(' ');\n        }\n\n        // Transform origin.\n        if (\n            Array.isArray(this.attrs.transform_origin) &&\n            this.attrs.transform_origin.length === 2\n        ) {\n            this.el.style.transformOrigin = [\n                formatUnit(this.attrs.transform_origin[0]),\n                formatUnit(this.attrs.transform_origin[1])\n            ].join(' ');\n        }\n    }\n\n    getTransforms() {\n        const transforms = [];\n        const translateX = formatUnit(this.attrs.transform_translate_x);\n        const translateY = formatUnit(this.attrs.transform_translate_y);\n\n        if (translateX !== 0) {\n            transforms.push(`translateX(${translateX})`);\n        }\n\n        if (translateY !== 0) {\n            transforms.push(`translateY(${translateY})`);\n        }\n\n        if (\n            typeof this.attrs.transform_rotate === 'number' &&\n            this.attrs.transform_rotate !== 0\n        ) {\n            transforms.push(`rotate(${this.attrs.transform_rotate}deg)`);\n        }\n\n        if (\n            typeof this.attrs.transform_scale === 'number' &&\n            this.attrs.transform_scale !== 1\n        ) {\n            transforms.push(`scale(${this.attrs.transform_scale})`);\n        }\n\n        return transforms;\n    }\n\n    getShadow() {\n        if (isDefinedStr(this.attrs.shadow_color)) {\n            const dx =\n                typeof this.attrs.shadow_dx === 'number'\n                    ? this.attrs.shadow_dx\n                    : 0;\n            const dy =\n                typeof this.attrs.shadow_dy === 'number'\n                    ? this.attrs.shadow_dy\n                    : 0;\n            const radius =\n                typeof this.attrs.shadow_radius === 'number'\n                    ? this.attrs.shadow_radius\n                    : 0;\n            const color = this.attrs.shadow_color;\n\n            return {\n                dx,\n                dy,\n                radius,\n                color\n            };\n        }\n    }\n}\nView.prototype.tagName = 'div';\nView.prototype.className = null;\nexport default View;\n","import './absolute-layout.styl';\nimport View from './view';\n\nclass AbsoluteLayout extends View {}\nAbsoluteLayout.prototype.className = 'incito__absolute-layout-view';\nexport default AbsoluteLayout;\n","import './flex-layout.styl';\nimport View from './view';\n\nconst alignItemModes = [\n    'stretch',\n    'center',\n    'flex-start',\n    'flex-end',\n    'baseline'\n];\nconst flexJustifyModes = [\n    'flex-start',\n    'flex-end',\n    'center',\n    'space-between',\n    'space-around'\n];\nconst flexDirectionModes = ['row', 'column'];\n\nclass FlexLayout extends View {\n    render() {\n        if (alignItemModes.indexOf(this.attrs.layout_flex_align_items) !== -1) {\n            this.el.style.alignItems = this.attrs.layout_flex_align_items;\n            this.el.style.msAlignItems = this.attrs.layout_flex_align_items;\n        }\n\n        if (\n            flexJustifyModes.indexOf(this.attrs.layout_flex_justify_content) !==\n            -1\n        ) {\n            this.el.style.justifyContent = this.attrs.layout_flex_justify_content;\n            this.el.style.msFlexPack = this.attrs.layout_flex_justify_content;\n        }\n\n        if (\n            flexDirectionModes.indexOf(this.attrs.layout_flex_direction) !== -1\n        ) {\n            this.el.style.flexDirection = this.attrs.layout_flex_direction;\n            this.el.style.msFlexDirection = this.attrs.layout_flex_direction;\n        }\n\n        return this;\n    }\n}\nFlexLayout.prototype.className = 'incito__flex-layout-view';\nexport default FlexLayout;\n","import {isDefinedStr} from '../utils';\nimport './image.styl';\nimport View from './view';\n\nclass Image extends View {\n    render() {\n        if (isDefinedStr(this.attrs.src)) {\n            this.el.setAttribute('data-src', this.attrs.src);\n        }\n\n        if (isDefinedStr(this.attrs.label)) {\n            this.el.setAttribute('alt', this.attrs.label);\n        } else {\n            this.el.setAttribute('alt', '');\n        }\n\n        return this;\n    }\n}\nImage.prototype.tagName = 'img';\nImage.prototype.className = 'incito__image-view';\nImage.prototype.lazyload = true;\nexport default Image;\n","import {escapeHTML, isDefinedStr} from '../utils';\nimport './text.styl';\nimport View from './view';\n\nclass TextView extends View {\n    render() {\n        if (!isDefinedStr(this.attrs.text)) {\n            return this;\n        }\n\n        const textStyles = (this.attrs.text_style || '').split('|');\n        let {text} = this.attrs;\n\n        if (Array.isArray(this.attrs.spans) && this.attrs.spans.length > 0) {\n            const parsedText = this.parseSpans(text, this.attrs.spans);\n            text = parsedText.map((item) => {\n                const escapedText = escapeHTML(item.text || '');\n\n                if (item.span?.name === 'link' && item.span.url != null) {\n                    return `<a href=\"${encodeURI(\n                        item.span.url\n                    )}\" rel=\"external\" target=\"_blank\">${escapedText}</a>`;\n                }\n                if (item.span?.name != null) {\n                    const spanName = item.span.name;\n\n                    return `<span data-name=\"${spanName}\">${escapedText}</span>`;\n                }\n                return escapedText;\n            });\n            text = text.join('');\n        } else {\n            text = escapeHTML(text);\n        }\n\n        if (this.attrs.text_prevent_widow) {\n            text = text\n                .replace(/&nbsp;([^\\s]+)$/, ' $1')\n                .replace(/\\s([^\\s]+)\\s*$/, '&nbsp;$1');\n        }\n\n        this.el.innerHTML = text.replace(/\\n/g, '<br>');\n\n        // Font family.\n        if (\n            Array.isArray(this.attrs.font_family) &&\n            this.attrs.font_family.length > 0\n        ) {\n            this.el.style.fontFamily = `${this.attrs.font_family.join(\n                ', '\n            )} !important`;\n        } else {\n            this.el.style.fontFamily = 'inherit !important';\n        }\n\n        // Text size.\n        if (this.attrs.text_size != null) {\n            this.el.style.fontSize = `${this.attrs.text_size}px`;\n        }\n\n        // Line height.\n        if (this.attrs.line_spacing_multiplier != null) {\n            this.el.style.lineHeight = this.attrs.line_spacing_multiplier;\n        }\n\n        // Text color.\n        if (this.attrs.text_color != null) {\n            this.el.style.color = this.attrs.text_color;\n        }\n\n        // Text styles.\n        if (textStyles.indexOf('bold') !== -1) {\n            this.el.style.fontWeight = 'bold';\n        }\n        if (textStyles.indexOf('italic') !== -1) {\n            this.el.style.fontStyle = 'italic';\n        }\n\n        if (Array.isArray(this.attrs.text_decoration_line)) {\n            this.el.style.textDecorationLine = this.attrs.text_decoration_line.join(\n                ' '\n            );\n        }\n\n        // Text shadow.\n        const textShadow = this.getTextShadow();\n\n        if (isDefinedStr(this.attrs.text_shadow)) {\n            this.el.style.textShadow = this.attrs.text_shadow;\n        } else if (textShadow != null) {\n            this.el.style.textShadow = `${textShadow.dx}px ${textShadow.dy}px ${textShadow.radius}px ${textShadow.color}`;\n        }\n\n        // Text alignment.\n        if (this.attrs.text_alignment === 'left') {\n            this.el.style.textAlign = 'left';\n        } else if (this.attrs.text_alignment === 'center') {\n            this.el.style.textAlign = 'center';\n        } else if (this.attrs.text_alignment === 'right') {\n            this.el.style.textAlign = 'right';\n        }\n\n        // Max lines.\n        if (this.attrs.single_line === true || this.attrs.max_lines === 1) {\n            this.el.setAttribute('data-single-line', true);\n        } else if (typeof this.attrs.max_lines === 'number') {\n            this.el.style.display = '-webkit-box';\n            this.el.style.webkitLineClamp = this.attrs.max_lines;\n            this.el.style.webkitBoxOrient = 'vertical';\n        }\n\n        // All caps.\n        if (this.attrs.text_all_caps === true) {\n            this.el.style.textTransform = 'uppercase';\n        }\n\n        return this;\n    }\n\n    parseSpans(text, spans = []) {\n        const result = [];\n\n        if (spans.length === 0) {\n            result.push({\n                text\n            });\n        } else if (spans[0].start > 0) {\n            result.push({\n                text: text.slice(0, spans[0].start)\n            });\n        }\n\n        spans.forEach((span, i) => {\n            const startIndex = span.start;\n            const endIndex = span.end;\n\n            result.push({\n                text: text.slice(startIndex, endIndex),\n                span\n            });\n\n            if (i === spans.length - 1) {\n                if (endIndex < text.length) {\n                    result.push({\n                        text: text.slice(endIndex, text.length)\n                    });\n                }\n            } else if (endIndex < spans[i + 1].start) {\n                result.push({\n                    text: text.slice(endIndex, spans[i + 1].start)\n                });\n            }\n        });\n\n        return result;\n    }\n\n    getTextShadow() {\n        if (isDefinedStr(this.attrs.text_shadow_color)) {\n            const dx =\n                typeof this.attrs.text_shadow_dx === 'number'\n                    ? this.attrs.text_shadow_dx\n                    : 0;\n            const dy =\n                typeof this.attrs.text_shadow_dy === 'number'\n                    ? this.attrs.text_shadow_dy\n                    : 0;\n            const radius =\n                typeof this.attrs.text_shadow_radius === 'number'\n                    ? this.attrs.text_shadow_radius\n                    : 0;\n            const color = this.attrs.text_shadow_color;\n\n            return {\n                dx,\n                dy,\n                radius,\n                color\n            };\n        }\n    }\n}\nTextView.prototype.tagName = 'p';\nTextView.prototype.className = 'incito__text-view';\nexport default TextView;\n","import {isDefinedStr} from '../utils';\nimport View from './view';\n\nclass Video extends View {\n    render() {\n        if (!isDefinedStr(this.attrs.src)) {\n            return this;\n        }\n\n        this.el.muted = true;\n        this.el.preload = 'metadata';\n        this.el.setAttribute('muted', '');\n        this.el.setAttribute('playsinline', 'true');\n        this.el.setAttribute('webkit-playsinline', 'true');\n        this.el.setAttribute('data-src', this.attrs.src);\n        this.el.setAttribute('data-mime', this.attrs.mime);\n\n        if (this.attrs.autoplay === true) {\n            this.el.autoplay = true;\n        }\n\n        if (this.attrs.loop === true) {\n            this.el.loop = true;\n        }\n\n        if (this.attrs.controls === true) {\n            this.el.controls = true;\n        }\n\n        return this;\n    }\n}\nVideo.prototype.className = 'incito__video-view';\nVideo.prototype.tagName = 'video';\nVideo.prototype.lazyload = true;\nexport default Video;\n","import {isDefinedStr} from '../utils';\nimport './video-embed.styl';\nimport View from './view';\n\nconst allowedHostnames = ['.youtube.com', '.vimeo.com', '.twentythree.net'];\n\nclass FlexLayout extends View {\n    render() {\n        if (!isDefinedStr(this.attrs.src)) {\n            return this;\n        }\n\n        const {src} = this.attrs;\n        const linkEl = document.createElement('a');\n\n        linkEl.setAttribute('href', src);\n\n        const isSupported = allowedHostnames.find(\n            (hostname) => linkEl.hostname.slice(-hostname.length) === hostname\n        );\n\n        if (isSupported) {\n            this.el.setAttribute('data-src', src);\n            this.lazyload = true;\n        }\n\n        return this;\n    }\n}\nFlexLayout.prototype.className = 'incito__video-embed-view';\nFlexLayout.prototype.lazyload = false;\nexport default FlexLayout;\n","import './incito.styl';\nimport {isDefinedStr, throttle} from './utils';\nimport * as views from './views';\n\nlet requestIdleCallback;\nif (\n    typeof window !== 'undefined' &&\n    typeof window.requestIdleCallback === 'function'\n) {\n    ({requestIdleCallback} = window);\n} else {\n    requestIdleCallback = (cb) =>\n        setTimeout(function () {\n            const start = Date.now();\n            return cb({\n                didTimeout: false,\n                timeRemaining() {\n                    return Math.max(0, 50 - (Date.now() - start));\n                }\n            });\n        }, 1);\n}\n\n// like requestIdleCallback but effectively synchronous\n// as we give infinite time to run\nconst syncIdleCallback = function (cb) {\n    cb({\n        timeRemaining() {\n            return Number.MAX_VALUE;\n        },\n        didTimeout: false\n    });\n};\n\nexport default class Incito {\n    constructor(\n        containerEl,\n        {\n            incito = {},\n            renderLaziness = 1 // 0: All synchronous. 1: Visible synchronous, rest lazy. 2: All lazy.\n        }\n    ) {\n        this.containerEl = containerEl;\n        this.incito = incito;\n        this.renderLaziness = renderLaziness;\n        this.el = document.createElement('div');\n        this.ids = {};\n        this.views = flattenViews([], this.incito.root_view);\n        this.viewsLength = this.views.length;\n        this.viewIndex = 0;\n        this.lazyloadables = [];\n        this.lazyloader = throttle(this.lazyload.bind(this), 150);\n        this.renderedOutsideOfViewport = false;\n        this._events = {};\n    }\n\n    bind(event, fn) {\n        this._events[event] = this._events[event] || [];\n        return this._events[event].push(fn);\n    }\n\n    unbind(event, fn) {\n        if (this._events[event]) {\n            return this._events[event].splice(\n                this._events[event].indexOf(fn),\n                1\n            );\n        }\n    }\n\n    trigger(event) {\n        if (this._events[event]) {\n            return this._events[event].map(function (e) {\n                return e.apply(this, Array.prototype.slice.call(arguments, 1));\n            });\n        }\n    }\n\n    start() {\n        let triggeredVisibleRendered = false;\n        var render = (IdleDeadline) => {\n            this.render(IdleDeadline);\n\n            if (this.viewIndex <= this.viewsLength - 1) {\n                this.renderCallbackHandle = requestIdleCallback(render);\n            } else {\n                // make sure visibleRendered gets triggered even\n                // if renderedOutsideOfViewport wasn't\n                this.renderedOutsideOfViewport = true;\n                this.trigger('allRendered');\n            }\n\n            if (this.renderedOutsideOfViewport && !triggeredVisibleRendered) {\n                this.trigger('visibleRendered');\n\n                triggeredVisibleRendered = true;\n            }\n\n            if (this.renderedOutsideOfViewport) {\n                this.lazyload(0);\n            }\n        };\n\n        this.el.className = 'incito';\n        if (this.incito.locale != null) {\n            this.el.setAttribute('lang', this.incito.locale);\n        }\n\n        loadFonts(this.incito.font_assets);\n        this.applyTheme(this.incito.theme);\n\n        this.containerEl.appendChild(this.el);\n\n        // do first render synchronously unless we're very lazy\n        if (this.renderLaziness === 2) {\n            this.renderCallbackHandle = requestIdleCallback(render);\n        } else {\n            syncIdleCallback(render);\n        }\n\n        document.addEventListener('scroll', this.lazyloader, true);\n        window.addEventListener('resize', this.lazyloader, false);\n\n        return this;\n    }\n\n    destroy() {\n        cancelIdleCallback(this.renderCallbackHandle);\n        this.containerEl.removeChild(this.el);\n\n        document.removeEventListener('scroll', this.lazyloader, true);\n        window.removeEventListener('resize', this.lazyloader, false);\n\n        this.trigger('destroyed');\n    }\n\n    render(IdleDeadline) {\n        while (\n            IdleDeadline.timeRemaining() > 0 &&\n            this.viewIndex <= this.viewsLength - 1\n        ) {\n            const item = this.views[this.viewIndex];\n            const {attrs} = item;\n            const match = views[attrs.view_name] ?? views.View;\n            const view = new match(attrs).render();\n\n            if (attrs.id != null && typeof attrs.meta === 'object') {\n                this.ids[attrs.id] = attrs.meta;\n            }\n\n            if (view.lazyload === true) {\n                this.lazyloadables.push(view.el);\n            }\n\n            item.view = view;\n\n            if (item.parent?.view != null) {\n                item.parent.view.el.appendChild(view.el);\n            } else {\n                this.el.appendChild(view.el);\n            }\n\n            this.viewIndex++;\n\n            // check if we rendered something out of the viewport for the first time and yield.\n            // the check is expensive so it's faster to only check every few iterations, the downside is that\n            // we might overrender a tiny bit but it comes out to faster than checking every iteration.\n            if (\n                this.renderLaziness &&\n                !(this.viewIndex % 20) &&\n                !this.renderedOutsideOfViewport &&\n                !isInsideViewport(view.el)\n            ) {\n                this.renderedOutsideOfViewport = true;\n\n                break;\n            }\n        }\n    }\n\n    applyTheme(theme = {}) {\n        if (Array.isArray(theme.font_family)) {\n            this.el.style.fontFamily = theme.font_family.join(', ');\n        }\n\n        if (isDefinedStr(theme.background_color)) {\n            this.el.style.backgroundColor = theme.background_color;\n        }\n\n        if (isDefinedStr(theme.text_color)) {\n            this.el.style.color = theme.text_color;\n        }\n\n        if (typeof theme.line_spacing_multiplier === 'number') {\n            this.el.style.lineHeight = theme.line_spacing_multiplier;\n        }\n    }\n\n    lazyload(threshold) {\n        this.lazyloadables = this.lazyloadables.filter(function (el) {\n            if (isInsideViewport(el, threshold)) {\n                revealElement(el);\n\n                return false;\n            } else {\n                return true;\n            }\n        });\n    }\n}\n\nvar flattenViews = function (views, attrs, parent) {\n    const item = {\n        attrs,\n        view: null,\n        parent\n    };\n\n    views.push(item);\n\n    if (Array.isArray(attrs.child_views)) {\n        attrs.child_views.forEach((childAttrs) =>\n            flattenViews(views, childAttrs, item)\n        );\n    }\n\n    return views;\n};\n\nvar loadFonts = function (fontAssets = {}) {\n    let key, urls, value;\n    if ('FontFace' in window) {\n        for (key in fontAssets) {\n            value = fontAssets[key];\n            urls = value.src.map((src) => `url(${src[1]})`).join(', ');\n            const font = new FontFace(key, urls, {\n                style: value.style ?? 'normal',\n                weight: value.weight ?? 'normal',\n                display: 'swap'\n            });\n\n            document.fonts.add(font);\n\n            font.load();\n        }\n    } else {\n        const styleEl = document.createElement('style');\n\n        for (key in fontAssets) {\n            value = fontAssets[key];\n            urls = value.src\n                .map((src) => `url('${src[1]}') format('${src[0]}')`)\n                .join(', ');\n            const text = `\\\n@font-face {\n    font-family: '${key}';\n    font-display: swap;\n    src: ${urls};\n}\\\n`;\n\n            styleEl.appendChild(document.createTextNode(text));\n        }\n\n        document.head.appendChild(styleEl);\n    }\n};\n\nvar isInsideViewport = function (el, threshold) {\n    const windowHeight = window.innerHeight;\n    threshold = threshold ?? windowHeight;\n    const rect = el.getBoundingClientRect();\n\n    return (\n        rect.top <= windowHeight + threshold &&\n        rect.top + rect.height >= -threshold\n    );\n};\n\nvar revealElement = function (el) {\n    const src = el.getAttribute('data-src');\n\n    if (el.tagName.toLowerCase() === 'img') {\n        el.addEventListener('load', function () {\n            el.className += ' incito--loaded';\n        });\n        el.setAttribute('src', src);\n    } else if (el.tagName.toLowerCase() === 'video') {\n        const sourceEl = document.createElement('source');\n\n        sourceEl.setAttribute('src', src);\n        sourceEl.setAttribute('type', el.getAttribute('data-mime'));\n\n        el.appendChild(sourceEl);\n    } else if (/incito__video-embed-view/gi.test(el.className)) {\n        const iframeEl = document.createElement('iframe');\n\n        iframeEl.setAttribute(\n            'allow',\n            'fullscreen; accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture'\n        );\n        iframeEl.setAttribute('src', src);\n\n        el.appendChild(iframeEl);\n    } else {\n        el.style.backgroundImage = `url(${src})`;\n    }\n};\n"],"names":["formatUnit","unit","replace","isDefinedStr","value","length","escapeHTML","unsafe","throttle","fn","delay","timer","_setTimeout","arguments","View","attrs","el","createElement","setAttributes","document","tagName","className","id","setAttribute","role","accessibility_label","accessibility_hidden","_Array$isArray","feature_labels","featureLabels","_filterInstanceProperty","featureLabel","test","join","title","gravity","link","addEventListener","window","open","layout_width","style","width","display","layout_height","height","min_width","minWidth","max_width","maxWidth","min_height","minHeight","max_height","maxHeight","layout_top","top","layout_left","left","layout_right","right","layout_bottom","bottom","background_color","backgroundColor","background_image","lazyload","_indexOfInstanceProperty","background_tile_mode","backgroundRepeat","background_image_position","backgroundPosition","background_image_scale_type","backgroundSize","layout_margin","margin","layout_margin_top","marginTop","layout_margin_left","marginLeft","layout_margin_right","marginRight","layout_margin_bottom","marginBottom","padding","padding_top","paddingTop","padding_left","paddingLeft","padding_right","paddingRight","padding_bottom","paddingBottom","corner_radius","borderRadius","corner_top_left_radius","borderTopLeftRadius","corner_top_right_radius","borderTopRightRadius","corner_bottom_left_radius","borderBottomLeftRadius","corner_bottom_right_radius","borderBottomRightRadius","clip_children","overflow","shadow","getShadow","boxShadow","dx","dy","radius","color","strokeStyles","stroke_width","borderWidth","stroke_color","borderColor","stroke_style","borderStyle","stroke_top_width","borderTopWidth","stroke_top_color","borderTopColor","stroke_left_width","borderLeftWidth","stroke_left_color","borderLeftColor","stroke_right_width","borderRightWidth","stroke_right_color","borderRightColor","stroke_bottom_width","borderBottomWidth","stroke_bottom_color","borderBottomColor","layout_flex_shrink","flexShrink","msFlexShrink","layout_flex_grow","flexGrow","msFlexGrow","layout_flex_basis","flexBasis","msFlexBasis","transforms","getTransforms","transform","transform_origin","transformOrigin","translateX","transform_translate_x","translateY","transform_translate_y","push","transform_rotate","transform_scale","shadow_color","shadow_dx","shadow_dy","shadow_radius","prototype","AbsoluteLayout","alignItemModes","flexJustifyModes","flexDirectionModes","FlexLayout","layout_flex_align_items","alignItems","msAlignItems","layout_flex_justify_content","justifyContent","msFlexPack","layout_flex_direction","flexDirection","msFlexDirection","Image","src","label","TextView","text","textStyles","text_style","split","spans","parsedText","parseSpans","_mapInstanceProperty","item","escapedText","span","name","url","encodeURI","spanName","text_prevent_widow","innerHTML","font_family","fontFamily","text_size","fontSize","line_spacing_multiplier","lineHeight","text_color","fontWeight","fontStyle","text_decoration_line","textDecorationLine","textShadow","getTextShadow","text_shadow","text_alignment","textAlign","single_line","max_lines","webkitLineClamp","webkitBoxOrient","text_all_caps","textTransform","result","start","_sliceInstanceProperty","i","startIndex","endIndex","end","text_shadow_color","text_shadow_dx","text_shadow_dy","text_shadow_radius","Video","muted","preload","mime","autoplay","loop","controls","allowedHostnames","linkEl","isSupported","_findInstanceProperty","hostname","requestIdleCallback","cb","_Date$now","didTimeout","timeRemaining","Math","max","syncIdleCallback","Number","MAX_VALUE","Incito","containerEl","incito","renderLaziness","ids","views","flattenViews","root_view","viewsLength","viewIndex","lazyloadables","lazyloader","_bindInstanceProperty","renderedOutsideOfViewport","_events","event","_spliceInstanceProperty","e","apply","Array","call","triggeredVisibleRendered","render","IdleDeadline","renderCallbackHandle","trigger","locale","loadFonts","font_assets","applyTheme","theme","appendChild","cancelIdleCallback","removeChild","removeEventListener","match","view_name","view","meta","parent","isInsideViewport","threshold","revealElement","child_views","childAttrs","fontAssets","key","urls","font","FontFace","weight","fonts","add","load","styleEl","createTextNode","head","windowHeight","innerHeight","rect","getBoundingClientRect","getAttribute","toLowerCase","sourceEl","iframeEl","backgroundImage"],"mappings":"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"}