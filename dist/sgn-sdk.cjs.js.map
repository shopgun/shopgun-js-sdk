{"version":3,"file":"sgn-sdk.cjs.js","sources":["../lib/config.js","../lib/configDefaults.js","../lib/translations.js","../lib/util.js","../lib/core.js","../lib/storage/client-cookie.js","../lib/kits/core/session.js","../lib/kits/core/request.js","../vendor/gator.js","../lib/kits/core-ui/offer-details.js","../lib/key-codes.js","../lib/kits/core-ui/popover.js","../lib/kits/core-ui/single-choice-popover.js","../lib/kits/core-ui/index.js","../lib/storage/client-local.js","../lib/kits/events/tracker.js","../lib/kits/incito-publication/event-tracking.js","../lib/kits/incito-publication/viewer.js","../lib/kits/incito-publication/controls.js","../lib/kits/incito-publication/bootstrapper.js","../lib/kits/paged-publication/controls.js","../lib/kits/paged-publication/page-spread.js","../lib/kits/paged-publication/page-spreads.js","../lib/kits/paged-publication/core.js","../lib/kits/paged-publication/event-tracking.js","../lib/kits/paged-publication/hotspots.js","../lib/kits/paged-publication/viewer.js","../lib/kits/paged-publication/bootstrapper.js","../lib/storage/client-session.js","../lib/index.js"],"sourcesContent":["import MicroEvent from 'microevent';\n\nclass Config {\n    attrs = {};\n\n    set(config = {}) {\n        const changedAttributes = {};\n\n        for (let key in config) {\n            const value = config[key];\n            if (this.keys.includes(key)) {\n                this.attrs[key] = value;\n                changedAttributes[key] = value;\n            }\n        }\n\n        this.trigger('change', changedAttributes);\n    }\n\n    get(option) {\n        return this.attrs[option];\n    }\n}\nConfig.prototype.keys = [\n    'appVersion',\n    'appKey',\n    'appSecret',\n    'authToken',\n    'eventTracker',\n    'locale',\n    'coreSessionToken',\n    'coreSessionClientId',\n    'coreUrl',\n    'eventsTrackUrl'\n];\n\nMicroEvent.mixin(Config);\n\nexport default Config;\n","export const locale = 'en_US';\nexport const coreUrl = 'https://squid-api.tjek.com';\nexport const eventsTrackUrl = 'https://wolf-api.tjek.com/sync';\n","import Mustache from 'mustache';\nconst pairs = {\n    'paged_publication.hotspot_picker.header': 'Which offer did you mean?',\n    'incito_publication.product_picker.header': 'Which product?'\n};\n\nexport function t(key, view) {\n    const template = pairs[key] ?? '';\n\n    return Mustache.render(template, view);\n}\n\nexport function update(translations) {\n    for (let key in translations) {\n        const value = translations[key];\n        pairs[key] = value;\n    }\n}\n","export function isBrowser() {\n    return typeof window === 'object' && typeof document === 'object';\n}\n\nexport function isNode() {\n    return typeof process === 'object';\n}\n\nexport function error(err, options) {\n    err.message = err.message || null;\n\n    if (typeof options === 'string') {\n        err.message = options;\n    } else if (typeof options === 'object' && options != null) {\n        for (let key in options) {\n            const value = options[key];\n            err[key] = value;\n        }\n\n        if (options.message != null) {\n            err.message = options.message;\n        }\n        if (options.code != null || options.message != null) {\n            err.code = options.code || options.name;\n        }\n        if (options.stack != null) {\n            err.stack = options.stack;\n        }\n    }\n\n    err.name = options?.name || err.name || err.code || 'Error';\n    err.time = new Date();\n\n    return err;\n}\n\nexport function uuid() {\n    return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, (c) => {\n        const r = (Math.random() * 16) | 0;\n        const v = c === 'x' ? r : (r & 0x3) | 0x8;\n\n        return v.toString(16);\n    });\n}\n\nexport function getQueryParam(field, url) {\n    const href = url || window.location.href;\n    const reg = new RegExp('[?&]' + field + '=([^&#]*)', 'i');\n    const string = reg.exec(href);\n\n    if (string) {\n        return string[1];\n    }\n    return undefined;\n}\n\nexport function getRandomNumberBetween(from, to) {\n    return Math.floor(Math.random() * to) + from;\n}\n\nexport function getOS() {\n    let name = null;\n    const ua = window.navigator.userAgent;\n\n    if (ua.indexOf('Windows') > -1) {\n        name = 'Windows';\n    } else if (ua.indexOf('Mac') > -1) {\n        name = 'macOS';\n    } else if (ua.indexOf('X11') > -1) {\n        name = 'unix';\n    } else if (ua.indexOf('Linux') > -1) {\n        name = 'Linux';\n    } else if (ua.indexOf('iOS') > -1) {\n        name = 'iOS';\n    } else if (ua.indexOf('Android') > -1) {\n        name = 'Android';\n    }\n\n    return name;\n}\n\nexport function getDeviceCategory() {\n    let deviceCategory = 'desktop';\n\n    if (navigator.platform === 'iPod' || navigator.platform === 'iPhone') {\n        deviceCategory = 'mobile';\n    } else if (navigator.platform === 'iPad') {\n        deviceCategory = 'tablet';\n    } else if (\n        navigator.platform === 'Android' ||\n        /android/gi.test(navigator.userAgent)\n    ) {\n        if (/tablet/gi.test(navigator.userAgent)) {\n            deviceCategory = 'tablet';\n        } else {\n            deviceCategory = 'mobile';\n        }\n    }\n\n    return deviceCategory;\n}\n\nexport function getPointer() {\n    let pointer = 'fine';\n\n    if (matchMedia('(pointer:coarse)').matches) {\n        pointer = 'coarse';\n    }\n\n    return pointer;\n}\n\nexport function getOrientation(width, height) {\n    if (width === height) {\n        return 'quadratic';\n    } else if (width > height) {\n        return 'horizontal';\n    } else {\n        return 'vertical';\n    }\n}\n\nexport function getScreenDimensions() {\n    const density = window.devicePixelRatio ?? 1;\n    const logical = {\n        width: window.screen.width,\n        height: window.screen.height\n    };\n    const physical = {\n        width: Math.round(logical.width * density),\n        height: Math.round(logical.height * density)\n    };\n\n    return {\n        density,\n        logical,\n        physical\n    };\n}\n\nexport function getUtcOffsetSeconds() {\n    const now = new Date();\n    const jan1 = new Date(now.getFullYear(), 0, 1, 0, 0, 0, 0);\n    const tmp = jan1.toGMTString();\n    const jan2 = new Date(tmp.substring(0, tmp.lastIndexOf(' ') - 1));\n    const stdTimeOffset = (jan1 - jan2) / 1000;\n\n    return stdTimeOffset;\n}\n\nexport function getUtcDstOffsetSeconds() {\n    return new Date().getTimezoneOffset() * 60 * -1;\n}\n\nexport function getColorBrightness(color) {\n    color = color.replace('#', '');\n    var hex = parseInt((hex + '').replace(/[^a-f0-9]/gi, ''), 16);\n    const rgb = [];\n    let sum = 0;\n    let x = 0;\n\n    while (x < 3) {\n        const s = parseInt(color.substring(2 * x, 2), 16);\n        rgb[x] = s;\n\n        if (s > 0) {\n            sum += s;\n        }\n\n        ++x;\n    }\n\n    if (sum <= 381) {\n        return 'dark';\n    } else {\n        return 'light';\n    }\n}\n\nexport function btoa(str) {\n    if (isBrowser()) {\n        return window.btoa(str);\n    } else {\n        let buffer = null;\n\n        if (str instanceof Buffer) {\n            buffer = str;\n        } else {\n            buffer = Buffer.from(str.toString(), 'binary');\n        }\n\n        return buffer.toString('base64');\n    }\n}\n\nexport function chunk(arr, size) {\n    const results = [];\n\n    while (arr.length) {\n        results.push(arr.splice(0, size));\n    }\n\n    return results;\n}\n\nexport function throttle(fn, threshold = 250, scope) {\n    let last = undefined;\n    let deferTimer = undefined;\n\n    return function () {\n        const context = scope || this;\n        const now = new Date().getTime();\n        const args = arguments;\n\n        if (last && now < last + threshold) {\n            clearTimeout(deferTimer);\n\n            deferTimer = setTimeout(() => {\n                last = now;\n\n                fn.apply(context, args);\n            }, threshold);\n        } else {\n            last = now;\n            fn.apply(context, args);\n        }\n    };\n}\n\nexport function loadImage(src, callback) {\n    const img = new Image();\n\n    img.onload = () => callback(null, img.width, img.height);\n    img.onerror = () => callback(new Error());\n    img.src = src;\n\n    return img;\n}\n\nexport function distance(lat1, lng1, lat2, lng2) {\n    const radlat1 = (Math.PI * lat1) / 180;\n    const radlat2 = (Math.PI * lat2) / 180;\n    const theta = lng1 - lng2;\n    const radtheta = (Math.PI * theta) / 180;\n    let dist =\n        Math.sin(radlat1) * Math.sin(radlat2) +\n        Math.cos(radlat1) * Math.cos(radlat2) * Math.cos(radtheta);\n    dist = Math.acos(dist);\n    dist = (dist * 180) / Math.PI;\n    dist = dist * 60 * 1.1515;\n    dist = dist * 1.609344 * 1000;\n\n    return dist;\n}\n\n// Method for wrapping a function that takes a callback in any position\n// to return promises if no callback is given in a call.\n// The second argument, cbParameterIndex, is the position of the callback in the original functions parameter list.\n// CoffeeScript optional parameters messes with this function arity detection,\n// not sure what to do about that, other than always setting cbParameterIndex at callsites.\nexport function promiseCallbackInterop(fun, cbParameterIndex = fun.length - 1) {\n    // This is the function that actually wraps and calls a method to return a promise.\n    const makePromise = (fun, cbParameterIndex, parameters) =>\n        new Promise((resolve, reject) => {\n            const neoCallback = (error, result) => {\n                if (error) {\n                    return reject(error);\n                }\n                return resolve(result);\n            };\n\n            const callParameters = [];\n            for (\n                let i = 0,\n                    end = Math.max(parameters.length, cbParameterIndex) + 1,\n                    asc = 0 <= end;\n                asc ? i < end : i > end;\n                asc ? i++ : i--\n            ) {\n                callParameters.push(\n                    i === cbParameterIndex ? neoCallback : parameters[i]\n                );\n            }\n\n            return fun.apply(this, callParameters);\n        });\n    // Wrapper function that decides what to do per-call.\n    return (...parameters) => {\n        if (typeof parameters[cbParameterIndex] === 'function') {\n            // Callback given, do a regular old call.\n            return fun.apply(null, parameters);\n        } else if (typeof Promise === 'function') {\n            // No callback given, and we have promise support, use makePromise to wrap the call.\n            return makePromise(fun, cbParameterIndex, parameters);\n        } else {\n            // Ain't got callback, ain't got promise support; we gotta tell the developer.\n            throw new Error(`To be able to use this asynchronous method you should:\nSupply a callback function as argument #${1 + cbParameterIndex}.\nThis callback function will be called with the method call response.\nAlternatively, when supported, it can return a Promise if no callback function is given.\\\n`);\n        }\n    };\n}\n","import Config from './config';\nimport * as configDefaults from './configDefaults';\nexport * as translations from './translations';\nexport * as util from './util';\nexport const config = new Config();\n\n// Set default values.\nconfig.set(configDefaults);\n","import {isNode} from '../util';\n\nconst prefixKey = 'sgn-';\n\nexport function get(key) {\n    let value;\n    if (isNode()) {\n        return;\n    }\n\n    try {\n        const name = `${prefixKey}${key}=`;\n        const ca = document.cookie.split(';');\n\n        ca.forEach((c) => {\n            const ct = c.trim();\n\n            if (ct.indexOf(name) === 0) {\n                value = ct.substring(name.length, ct.length);\n            }\n        });\n\n        value = JSON.parse(value);\n    } catch (err) {\n        value = {};\n    }\n\n    return value;\n}\n\nexport function set(key, value) {\n    if (isNode()) {\n        return;\n    }\n\n    try {\n        const days = 365;\n        const date = new Date();\n        const str = JSON.stringify(value);\n\n        date.setTime(date.getTime() + days * 24 * 60 * 60 * 1000);\n\n        document.cookie = `${prefixKey}${key}=${str};expires=${date.toUTCString()};path=/`;\n    } catch (err) {}\n}\n","import fetch from 'cross-fetch';\nimport sha256 from 'sha256';\nimport SGN from '../../sgn';\nimport * as clientCookieStorage from '../../storage/client-cookie';\nlet callbackQueue = [];\nlet renewed = false;\n\nconst ttl = 1 * 60 * 60 * 24 * 60;\n\nexport function saveToken(token) {\n    if (!token) {\n        throw new Error('No token provided for saving');\n    }\n\n    SGN.config.set({coreSessionToken: token});\n\n    saveCookie();\n}\n\nexport function saveClientId(clientId) {\n    SGN.config.set({coreSessionClientId: clientId});\n\n    saveCookie();\n}\n\nexport function saveCookie() {\n    clientCookieStorage.set('session', {\n        token: SGN.config.get('coreSessionToken'),\n        client_id: SGN.config.get('coreSessionClientId')\n    });\n}\n\nexport function create(callback) {\n    const key = SGN.config.get('appKey');\n\n    const req = fetch(\n        SGN.config.get('coreUrl') +\n            `/v2/sessions?api_key=${key}&token_ttl=${ttl}`,\n        {method: 'post'}\n    );\n\n    req.then((response) =>\n        response.json().then((json) => {\n            if (response.status === 201) {\n                saveToken(json.token);\n                saveClientId(json.client_id);\n\n                callback(null, json);\n            } else {\n                callback(new Error('Could not create session'));\n            }\n        })\n    ).catch((err) => {\n        callback(err);\n    });\n}\n\nexport function update(callback) {\n    const headers = {};\n    const token = SGN.config.get('coreSessionToken');\n    const appSecret = SGN.config.get('appSecret');\n\n    headers['X-Token'] = token;\n    if (appSecret != null) {\n        headers['X-Signature'] = sign(appSecret, token);\n    }\n\n    const req = fetch(SGN.config.get('coreUrl') + '/v2/sessions', {\n        method: 'put',\n        headers\n    });\n\n    req.then((response) =>\n        response.json().then((json) => {\n            if (response.status === 200) {\n                saveToken(json.token);\n                saveClientId(json.client_id);\n\n                callback(null, json);\n            } else {\n                callback(new Error('Could not update session'));\n            }\n        })\n    ).catch((err) => {\n        callback(err);\n    });\n}\n\nexport function renew(callback) {\n    const headers = {};\n    const token = SGN.config.get('coreSessionToken');\n    const appSecret = SGN.config.get('appSecret');\n\n    headers['X-Token'] = token;\n    if (appSecret) {\n        headers['X-Signature'] = sign(appSecret, token);\n    }\n\n    const req = fetch(SGN.config.get('coreUrl') + '/v2/sessions', {\n        method: 'put',\n        headers\n    });\n\n    req.then((response) =>\n        response.json().then((json) => {\n            if (response.status === 200) {\n                saveToken(json.token);\n                saveClientId(json.client_id);\n\n                callback(null, json);\n            } else {\n                callback(new Error('Could not renew session'));\n            }\n        })\n    ).catch((err) => {\n        callback(err);\n    });\n}\n\nexport function ensure(callback) {\n    const queueCount = callbackQueue.length;\n    const complete = (err) => {\n        callbackQueue = callbackQueue.filter((fn) => {\n            fn(err);\n\n            return false;\n        });\n    };\n\n    callbackQueue.push(callback);\n\n    if (queueCount === 0) {\n        if (SGN.config.get('coreSessionToken') == null) {\n            create(complete);\n        } else if (renewed === false) {\n            renewed = true;\n            renew((err) => {\n                if (err != null) {\n                    create(complete);\n                } else {\n                    complete();\n                }\n            });\n        } else {\n            complete();\n        }\n    }\n}\n\nexport function sign(appSecret, token) {\n    return sha256([appSecret, token].join(''));\n}\n","import fetch from 'cross-fetch';\nimport SGN from '../../sgn';\nimport {error, promiseCallbackInterop} from '../../util';\nimport {ensure, saveToken, sign} from './session';\n\nfunction request(options = {}, callback, secondTime) {\n    ensure((err) => {\n        if (err != null) {\n            return callback(err);\n        }\n\n        let url = SGN.config.get('coreUrl') + (options.url ?? '');\n        const headers = options.headers ?? {};\n        const json = typeof options.json === 'boolean' ? options.json : true;\n        let token = SGN.config.get('coreSessionToken');\n        const appKey = SGN.config.get('appKey');\n        const appVersion = SGN.config.get('appVersion');\n        const appSecret = SGN.config.get('appSecret');\n        const locale = SGN.config.get('locale');\n        const qs = options.qs ?? {};\n        const geo = options.geolocation;\n        let {body} = options;\n\n        headers['X-Api-Key'] = appKey;\n        headers['X-Token'] = token;\n        if (appSecret != null) {\n            headers['X-Signature'] = sign(appSecret, token);\n        }\n\n        if (json) {\n            headers['Content-Type'] = 'application/json';\n            headers['Accept'] = 'application/json';\n\n            if (body) {\n                body = JSON.stringify(body);\n            }\n        }\n\n        if (locale != null) {\n            qs.r_locale = locale;\n        }\n        if (appVersion != null) {\n            qs.api_av = appVersion;\n        }\n\n        if (geo != null) {\n            if (geo.latitude != null && qs.r_lat == null) {\n                qs.r_lat = geo.latitude;\n            }\n            if (geo.longitude != null && qs.r_lng == null) {\n                qs.r_lng = geo.longitude;\n            }\n            if (geo.radius != null && qs.r_radius == null) {\n                qs.r_radius = geo.radius;\n            }\n            if (geo.sensor != null && qs.r_sensor == null) {\n                qs.r_sensor = geo.sensor;\n            }\n        }\n\n        if (Object.keys(qs).length) {\n            const params = Object.keys(qs)\n                .map((k) => {\n                    if (Array.isArray(k)) {\n                        return qs[k]\n                            .map(\n                                (val) =>\n                                    `${encodeURIComponent(\n                                        k\n                                    )}[]=${encodeURIComponent(val)}`\n                            )\n                            .join('&');\n                    }\n\n                    return `${encodeURIComponent(k)}=${encodeURIComponent(\n                        qs[k]\n                    )}`;\n                })\n                .join('&');\n\n            url += '?' + params;\n        }\n\n        const req = fetch(url, {\n            method: options.method,\n            body,\n            headers\n        });\n\n        return req\n            .then((response) =>\n                response.json().then((json) => {\n                    token = SGN.config.get('coreSessionToken');\n                    const responseToken = response.headers.get('x-token');\n\n                    if (responseToken && token !== responseToken) {\n                        saveToken(responseToken);\n                    }\n\n                    if (\n                        (response.status >= 200 && response.status < 300) ||\n                        response.status === 304\n                    ) {\n                        callback(null, json);\n                    } else {\n                        if (\n                            secondTime !== true &&\n                            [1101, 1107, 1108].includes(json?.code)\n                        ) {\n                            SGN.config.set({coreSessionToken: undefined});\n\n                            request(options, callback, true);\n                        } else {\n                            callback(\n                                error(new Error('Core API error'), {\n                                    code: 'CoreAPIError',\n                                    statusCode: response.status\n                                }),\n                                json\n                            );\n                        }\n                    }\n                })\n            )\n            .catch(callback);\n    });\n}\n\nexport default promiseCallbackInterop(request, 1);\n","/**\n * Copyright 2014 Craig Campbell\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n *\n * GATOR.JS\n * Simple Event Delegation\n *\n * @version 1.2.4\n *\n * Compatible with IE 9+, FF 3.6+, Safari 5+, Chrome\n *\n * Include legacy.js for compatibility with older browsers\n *\n *             .-._   _ _ _ _ _ _ _ _\n *  .-''-.__.-'00  '-' ' ' ' ' ' ' ' '-.\n * '.___ '    .   .--_'-' '-' '-' _'-' '._\n *  V: V 'vv-'   '_   '.       .'  _..' '.'.\n *    '=.____.=_.--'   :_.__.__:_   '.   : :\n *            (((____.-'        '-.  /   : :\n *                              (((-'\\ .' /\n *                            _____..'  .'\n *                           '-._____.-'\n */\nvar _matcher,\n  _level = 0,\n  _id = 0,\n  _handlers = {},\n  _gatorInstances = {};\n\nfunction _addEvent(gator, type, callback) {\n  // blur and focus do not bubble up but if you use event capturing\n  // then you will get them\n  var useCapture = type == \"blur\" || type == \"focus\";\n  gator.element.addEventListener(type, callback, useCapture);\n}\n\nfunction _cancel(e) {\n  e.preventDefault();\n  e.stopPropagation();\n}\n\n/**\n     * returns function to use for determining if an element\n     * matches a query selector\n     *\n     * @returns {Function}\n     */\nfunction _getMatcher(element) {\n  if (_matcher) {\n    return _matcher;\n  }\n\n  if (element.matches) {\n    _matcher = element.matches;\n    return _matcher;\n  }\n\n  if (element.webkitMatchesSelector) {\n    _matcher = element.webkitMatchesSelector;\n    return _matcher;\n  }\n\n  if (element.mozMatchesSelector) {\n    _matcher = element.mozMatchesSelector;\n    return _matcher;\n  }\n\n  if (element.msMatchesSelector) {\n    _matcher = element.msMatchesSelector;\n    return _matcher;\n  }\n\n  if (element.oMatchesSelector) {\n    _matcher = element.oMatchesSelector;\n    return _matcher;\n  }\n\n  // if it doesn't match a native browser method\n  // fall back to the gator function\n  _matcher = Gator.matchesSelector;\n  return _matcher;\n}\n\n/**\n     * determines if the specified element matches a given selector\n     *\n     * @param {Node} element - the element to compare against the selector\n     * @param {string} selector\n     * @param {Node} boundElement - the element the listener was attached to\n     * @returns {void|Node}\n     */\nfunction _matchesSelector(element, selector, boundElement) {\n  // no selector means this event was bound directly to this element\n  if (selector == \"_root\") {\n    return boundElement;\n  }\n\n  // if we have moved up to the element you bound the event to\n  // then we have come too far\n  if (element === boundElement) {\n    return;\n  }\n\n  // if this is a match then we are done!\n  if (_getMatcher(element).call(element, selector)) {\n    return element;\n  }\n\n  // if this element did not match but has a parent we should try\n  // going up the tree to see if any of the parent elements match\n  // for example if you are looking for a click on an <a> tag but there\n  // is a <span> inside of the a tag that it is the target,\n  // it should still work\n  if (element.parentNode) {\n    _level++;\n    return _matchesSelector(element.parentNode, selector, boundElement);\n  }\n}\n\nfunction _addHandler(gator, event, selector, callback) {\n  if (!_handlers[gator.id]) {\n    _handlers[gator.id] = {};\n  }\n\n  if (!_handlers[gator.id][event]) {\n    _handlers[gator.id][event] = {};\n  }\n\n  if (!_handlers[gator.id][event][selector]) {\n    _handlers[gator.id][event][selector] = [];\n  }\n\n  _handlers[gator.id][event][selector].push(callback);\n}\n\nfunction _removeHandler(gator, event, selector, callback) {\n  // if there are no events tied to this element at all\n  // then don't do anything\n  if (!_handlers[gator.id]) {\n    return;\n  }\n\n  // if there is no event type specified then remove all events\n  // example: Gator(element).off()\n  if (!event) {\n    for (var type in _handlers[gator.id]) {\n      if (_handlers[gator.id].hasOwnProperty(type)) {\n        _handlers[gator.id][type] = {};\n      }\n    }\n    return;\n  }\n\n  // if no callback or selector is specified remove all events of this type\n  // example: Gator(element).off('click')\n  if (!callback && !selector) {\n    _handlers[gator.id][event] = {};\n    return;\n  }\n\n  // if a selector is specified but no callback remove all events\n  // for this selector\n  // example: Gator(element).off('click', '.sub-element')\n  if (!callback) {\n    delete _handlers[gator.id][event][selector];\n    return;\n  }\n\n  // if we have specified an event type, selector, and callback then we\n  // need to make sure there are callbacks tied to this selector to\n  // begin with.  if there aren't then we can stop here\n  if (!_handlers[gator.id][event][selector]) {\n    return;\n  }\n\n  // if there are then loop through all the callbacks and if we find\n  // one that matches remove it from the array\n  for (var i = 0; i < _handlers[gator.id][event][selector].length; i++) {\n    if (_handlers[gator.id][event][selector][i] === callback) {\n      _handlers[gator.id][event][selector].splice(i, 1);\n      break;\n    }\n  }\n}\n\nfunction _handleEvent(id, e, type) {\n  if (!_handlers[id][type]) {\n    return;\n  }\n\n  var target = e.target || e.srcElement,\n    selector,\n    match,\n    matches = {},\n    i = 0,\n    j = 0;\n\n  // find all events that match\n  _level = 0;\n  for (selector in _handlers[id][type]) {\n    if (_handlers[id][type].hasOwnProperty(selector)) {\n      match = _matchesSelector(target, selector, _gatorInstances[id].element);\n\n      if (\n        match &&\n        Gator.matchesEvent(\n          type,\n          _gatorInstances[id].element,\n          match,\n          selector == \"_root\",\n          e\n        )\n      ) {\n        _level++;\n        _handlers[id][type][selector].match = match;\n        matches[_level] = _handlers[id][type][selector];\n      }\n    }\n  }\n\n  // stopPropagation() fails to set cancelBubble to true in Webkit\n  // @see http://code.google.com/p/chromium/issues/detail?id=162270\n  e.stopPropagation = function() {\n    e.cancelBubble = true;\n  };\n\n  for (i = 0; i <= _level; i++) {\n    if (matches[i]) {\n      for (j = 0; j < matches[i].length; j++) {\n        if (matches[i][j].call(matches[i].match, e) === false) {\n          Gator.cancel(e);\n          return;\n        }\n\n        if (e.cancelBubble) {\n          return;\n        }\n      }\n    }\n  }\n}\n\n/**\n     * binds the specified events to the element\n     *\n     * @param {string|Array} events\n     * @param {string} selector\n     * @param {Function} callback\n     * @param {boolean=} remove\n     * @returns {Object}\n     */\nfunction _bind(events, selector, callback, remove) {\n  // fail silently if you pass null or undefined as an alement\n  // in the Gator constructor\n  if (!this.element) {\n    return;\n  }\n\n  if (!(events instanceof Array)) {\n    events = [events];\n  }\n\n  if (!callback && typeof selector == \"function\") {\n    callback = selector;\n    selector = \"_root\";\n  }\n\n  var id = this.id,\n    i;\n\n  function _getGlobalCallback(type) {\n    return function(e) {\n      _handleEvent(id, e, type);\n    };\n  }\n\n  for (i = 0; i < events.length; i++) {\n    if (remove) {\n      _removeHandler(this, events[i], selector, callback);\n      continue;\n    }\n\n    if (!_handlers[id] || !_handlers[id][events[i]]) {\n      Gator.addEvent(this, events[i], _getGlobalCallback(events[i]));\n    }\n\n    _addHandler(this, events[i], selector, callback);\n  }\n\n  return this;\n}\n\n/**\n     * Gator object constructor\n     *\n     * @param {Node} element\n     */\nfunction Gator(element, id) {\n  // called as function\n  if (!(this instanceof Gator)) {\n    // only keep one Gator instance per node to make sure that\n    // we don't create a ton of new objects if you want to delegate\n    // multiple events from the same node\n    //\n    // for example: Gator(document).on(...\n    for (var key in _gatorInstances) {\n      if (_gatorInstances[key].element === element) {\n        return _gatorInstances[key];\n      }\n    }\n\n    _id++;\n    _gatorInstances[_id] = new Gator(element, _id);\n\n    return _gatorInstances[_id];\n  }\n\n  this.element = element;\n  this.id = id;\n}\n\n/**\n     * adds an event\n     *\n     * @param {string|Array} events\n     * @param {string} selector\n     * @param {Function} callback\n     * @returns {Object}\n     */\nGator.prototype.on = function(events, selector, callback) {\n  return _bind.call(this, events, selector, callback);\n};\n\n/**\n     * removes an event\n     *\n     * @param {string|Array} events\n     * @param {string} selector\n     * @param {Function} callback\n     * @returns {Object}\n     */\nGator.prototype.off = function(events, selector, callback) {\n  return _bind.call(this, events, selector, callback, true);\n};\n\nGator.matchesSelector = function() {};\nGator.cancel = _cancel;\nGator.addEvent = _addEvent;\nGator.matchesEvent = function() {\n  return true;\n};\n\nif (typeof module !== \"undefined\" && module.exports) {\n  module.exports = Gator;\n}\n\nif (typeof window !== \"undefined\" && window.exports) {\n  window.Gator = Gator;\n}\n","module.exports = class OfferDetails {\n    constructor({minWidth = 300, maxWidth = '100vw', anchorEl, contentEl}) {\n        this.resize = this.resize.bind(this);\n        this.minWidth = minWidth;\n        this.maxWidth = maxWidth;\n        this.anchorEl = anchorEl;\n        this.contentEl = contentEl;\n        this.elInner = document.createElement('div');\n        this.elInner.className = 'sgn-offer-details-inner';\n\n        this.el = document.createElement('div');\n\n        this.el.className = 'sgn-offer-details';\n        this.el.setAttribute('tabindex', -1);\n        this.el.appendChild(this.elInner);\n        this.el.appendChild(this.contentEl);\n\n        this.position();\n    }\n\n    appendTo(el) {\n        el.appendChild(this.el);\n\n        this.el.offsetWidth;\n\n        this.show();\n\n        return this;\n    }\n\n    show() {\n        this.el.className += ' in';\n\n        window.addEventListener('resize', this.resize, false);\n\n        return this;\n    }\n\n    destroy() {\n        window.removeEventListener('resize', this.resize, false);\n\n        this.el.parentNode.removeChild(this.el);\n    }\n\n    position() {\n        const rect = this.anchorEl.getBoundingClientRect();\n        const top = window.pageYOffset + rect.top + this.anchorEl.offsetHeight;\n        let left = window.pageXOffset + rect.left;\n        const width = this.anchorEl.offsetWidth;\n\n        this.el.style.top = top + 'px';\n\n        const rightAligned = rect.left >= window.outerWidth / 2;\n        left = window.pageXOffset + rect.left;\n        const right = window.pageXOffset + (window.outerWidth - rect.right);\n\n        if (rightAligned) {\n            this.el.style.left = 'auto';\n            this.el.style.right = right + 'px';\n\n            this.elInner.style.left = 'auto';\n            this.elInner.style.right = 0;\n        } else {\n            this.el.style.left = left + 'px';\n            this.el.style.right = 'auto';\n\n            this.elInner.style.left = 0;\n            this.elInner.style.right = 'auto';\n        }\n\n        this.el.style.minWidth =\n            typeof this.minWidth === 'number'\n                ? Math.max(width, this.minWidth) + 'px'\n                : this.minWidth;\n        this.el.style.maxWidth = this.maxWidth;\n\n        this.elInner.style.width = width - 8 + 'px';\n    }\n\n    resize() {\n        this.position();\n    }\n};\n","export const ESC = 27;\nexport const ARROW_RIGHT = 39;\nexport const ARROW_LEFT = 37;\nexport const SPACE = 32;\nexport const NUMBER_ONE = 49;\n","import MicroEvent from 'microevent';\nimport Mustache from 'mustache';\nimport Gator from '../../../vendor/gator';\nimport * as keyCodes from '../../key-codes';\n\nconst defaultTemplate = `\\\n<div class=\"sgn-popover__background\" data-close></div>\n<div class=\"sgn-popover__menu\">\n    {{#header}}\n        <div class=\"sgn-popover__header\">{{header}}</div>\n    {{/header}}\n    <div class=\"sgn-popover__content\">\n        <ul>\n            {{#singleChoiceItems}}\n                <li data-index=\"{{index}}\">\n                    <p class=\"sgn-popover-item__title\">{{item.title}}</p>\n                    {{#item.subtitle}}\n                        <p class=\"sgn-popover-item__subtitle\">{{item.subtitle}}</p>\n                    {{/item.subtitle}}\n                </li>\n            {{/singleChoiceItems}}\n        </ul>\n    </div>\n</div>\\\n`;\n\nclass Popover {\n    constructor(options = {}) {\n        this.keyUp = this.keyUp.bind(this);\n        this.resize = this.resize.bind(this);\n        this.scroll = this.scroll.bind(this);\n        this.options = options;\n        this.el = document.createElement('div');\n        this.backgroundEl = document.createElement('div');\n    }\n\n    render() {\n        const {\n            header,\n            singleChoiceItems,\n            template = defaultTemplate\n        } = this.options;\n\n        const view = {\n            header,\n            singleChoiceItems: singleChoiceItems?.map((item, index) => ({\n                item,\n                index\n            }))\n        };\n\n        this.el.className = 'sgn-popover';\n        this.el.setAttribute('tabindex', -1);\n        this.el.innerHTML = Mustache.render(template, view);\n\n        this.position();\n        this.addEventListeners();\n\n        return this;\n    }\n\n    destroy() {\n        Gator(this.el).off();\n\n        window.removeEventListener('resize', this.resize, false);\n        window.removeEventListener('scroll', this.scroll, false);\n\n        if (this.el.parentNode) {\n            this.el.parentNode.removeChild(this.el);\n\n            this.trigger('destroyed');\n        }\n    }\n\n    position() {\n        let top = this.options.y;\n        let left = this.options.x;\n\n        const menuEl = this.el.querySelector('.sgn-popover__menu');\n\n        const width = menuEl.offsetWidth;\n        const height = menuEl.offsetHeight;\n        const parentWidth = this.el.parentNode.offsetWidth;\n        const parentHeight = this.el.parentNode.offsetHeight;\n        const boundingRect = this.el.parentNode.getBoundingClientRect();\n\n        top -= boundingRect.top;\n        left -= boundingRect.left;\n\n        top -= window.pageYOffset;\n        left -= window.pageXOffset;\n\n        if (top + height > parentHeight) {\n            menuEl.style.top = parentHeight - height + 'px';\n        } else {\n            menuEl.style.top = top + 'px';\n        }\n\n        if (left + width > parentWidth) {\n            menuEl.style.left = parentWidth - width + 'px';\n        } else {\n            menuEl.style.left = left + 'px';\n        }\n    }\n\n    addEventListeners() {\n        const trigger = this.trigger.bind(this);\n\n        this.el.addEventListener('keyup', this.keyUp);\n\n        Gator(this.el).on('click', '[data-index]', function (e) {\n            e.preventDefault();\n            e.stopPropagation();\n\n            trigger('selected', {index: +this.getAttribute('data-index')});\n        });\n\n        Gator(this.el).on('click', '[data-close]', (e) => {\n            e.preventDefault();\n            e.stopPropagation();\n\n            this.destroy();\n        });\n\n        Gator(this.el).on('click', '.sgn-popover__menu', (e) => {\n            e.stopPropagation();\n        });\n\n        window.addEventListener('resize', this.resize, false);\n        window.addEventListener('scroll', this.scroll, false);\n    }\n\n    keyUp(e) {\n        if (e.keyCode === keyCodes.ESC) {\n            this.destroy();\n        }\n    }\n\n    resize() {\n        this.destroy();\n    }\n\n    scroll() {\n        this.destroy();\n    }\n}\n\nMicroEvent.mixin(Popover);\n\nexport default Popover;\n","import Popover from './popover';\n\nexport default function singleChoicePopover(ctx, callback) {\n    const {items} = ctx;\n    let popover = null;\n\n    if (items.length === 1) {\n        callback(items[0]);\n    } else if (items.length > 1) {\n        popover = new Popover({\n            header: ctx.header,\n            x: ctx.x,\n            y: ctx.y,\n            singleChoiceItems: items\n        });\n\n        popover.bind('selected', (e) => {\n            callback(items[e.index]);\n\n            popover.destroy();\n        });\n\n        popover.bind('destroyed', () => {\n            ctx.el.focus();\n        });\n\n        ctx.el.appendChild(popover.el);\n        popover.render().el.focus();\n    }\n\n    return {\n        destroy() {\n            popover?.destroy();\n        }\n    };\n}\n","import Gator from '../../../vendor/gator';\nexport {default as OfferDetails} from './offer-details';\nexport {default as Popover} from './popover';\nexport {default as singleChoicePopover} from './single-choice-popover';\n\nexport const on = (el, events, selector, callback) =>\n    Gator(el).on(events, selector, callback);\n\nexport const off = (el, events, selector, callback) =>\n    Gator(el).off(events, selector, callback);\n","const prefixKey = 'sgn-';\n\nconst storage = (() => {\n    try {\n        const storage = window.localStorage;\n\n        storage[`${prefixKey}test-storage`] = 'foobar';\n        delete storage[`${prefixKey}test-storage`];\n\n        return storage;\n    } catch (error) {\n        return {};\n    }\n})();\n\nexport function get(key) {\n    try {\n        return JSON.parse(storage[`${prefixKey}${key}`]);\n    } catch (error) {}\n}\n\nexport function set(key, value) {\n    try {\n        storage[`${prefixKey}${key}`] = JSON.stringify(value);\n    } catch (error) {}\n}\n","import fetch from 'cross-fetch';\nimport md5 from 'md5';\nimport {eventsTrackUrl as defaultEventsTrackUrl} from '../../configDefaults';\nimport * as clientLocalStorage from '../../storage/client-local';\nimport {btoa, error, throttle, uuid} from '../../util';\n\nconst createTrackerClient = () => {\n    let id = clientLocalStorage.get('client-id');\n    if (id?.data) {\n        id = id.data;\n    }\n\n    if (id == null) {\n        id = uuid();\n\n        clientLocalStorage.set('client-id', id);\n    }\n\n    return {id};\n};\n\nfunction getPool() {\n    let data = clientLocalStorage.get('event-tracker-pool');\n    if (Array.isArray(data) === false) {\n        data = [];\n    }\n    data = data.filter((evt) => typeof evt._i === 'string');\n\n    return data;\n}\n\nlet pool = getPool();\n\nclass Tracker {\n    constructor(options = {}) {\n        for (let key in this.defaultOptions) {\n            const value = this.defaultOptions[key];\n            this[key] = options[key] || value;\n        }\n\n        this.client = options?.client || createTrackerClient();\n        this.eventsTrackUrl = options?.eventsTrackUrl || defaultEventsTrackUrl;\n        this.location = {\n            geohash: null,\n            time: null,\n            country: null\n        };\n        this.dispatching = false;\n        this.hasMadeInitialDispatch = false;\n\n        if (this.eventsTrackUrl) {\n            dispatch(this.eventsTrackUrl);\n            this.hasMadeInitialDispatch = true;\n        }\n    }\n    setEventsTrackUrl(eventsTrackUrl) {\n        this.eventsTrackUrl = eventsTrackUrl;\n        if (!this.hasMadeInitialDispatch) {\n            dispatch(this.eventsTrackUrl);\n            this.hasMadeInitialDispatch = true;\n        }\n    }\n    trackEvent(type, properties = {}, version = 2) {\n        if (typeof type !== 'number') {\n            throw error(new Error('Event type is required'));\n        }\n        if (this.trackId == null) {\n            return;\n        }\n\n        const evt = Object.assign({}, properties, {\n            _e: type,\n            _v: version,\n            _i: uuid(),\n            _t: Math.round(new Date().getTime() / 1000),\n            _a: this.trackId\n        });\n\n        if (this.location.geohash) {\n            evt['l.h'] = this.location.geohash;\n        }\n        if (this.location.time) {\n            evt['l.ht'] = this.location.time;\n        }\n        if (this.location.country) {\n            evt['l.c'] = this.location.country;\n        }\n\n        pool.push(evt);\n        while (pool.length > this.poolLimit) {\n            pool.shift();\n        }\n\n        dispatch(this.eventsTrackUrl);\n\n        return this;\n    }\n\n    setLocation(location = {}) {\n        for (let key in location) {\n            const value = location[key];\n            if (Object.prototype.hasOwnProperty.call(this.location, key)) {\n                this.location[key] = value;\n            }\n        }\n\n        return this;\n    }\n\n    trackPagedPublicationOpened(properties, version) {\n        return this.trackEvent(1, properties, version);\n    }\n\n    trackPagedPublicationPageDisappeared(properties, version) {\n        return this.trackEvent(2, properties, version);\n    }\n\n    trackOfferOpened(properties, version) {\n        return this.trackEvent(3, properties, version);\n    }\n\n    trackSearched(properties, version) {\n        return this.trackEvent(5, properties, version);\n    }\n\n    trackIncitoPublicationOpened(properties, version) {\n        return this.trackEvent(11, properties, version);\n    }\n\n    createViewToken(...parts) {\n        const str = [this.client.id].concat(parts).join('');\n        const viewToken = btoa(\n            String.fromCharCode.apply(\n                null,\n                md5(str, {asBytes: true}).slice(0, 8)\n            )\n        );\n\n        return viewToken;\n    }\n}\nTracker.prototype.defaultOptions = {\n    trackId: null,\n    poolLimit: 1000\n};\nexport default Tracker;\n\nlet dispatching = false;\nconst dispatchLimit = 100;\n\nfunction ship(events = [], eventsTrackUrl) {\n    return fetch(eventsTrackUrl, {\n        method: 'post',\n        timeout: 1000 * 20,\n        headers: {\n            'Content-Type': 'application/json; charset=utf-8'\n        },\n        body: JSON.stringify({events})\n    }).then((response) => response.json());\n}\n\nlet dispatchRetryInterval = null;\nfunction _dispatch(eventsTrackUrl) {\n    if (dispatching === true || pool.length === 0) {\n        return;\n    }\n\n    const events = pool.slice(0, dispatchLimit);\n    let nacks = 0;\n    dispatching = true;\n\n    ship(events, eventsTrackUrl)\n        .then((response) => {\n            dispatching = false;\n            if (dispatchRetryInterval) {\n                clearInterval(dispatchRetryInterval);\n                dispatchRetryInterval = null;\n            }\n\n            response.events.forEach((resEvent) => {\n                if (\n                    resEvent.status === 'validation_error' ||\n                    resEvent.status === 'ack'\n                ) {\n                    pool = pool.filter(\n                        (poolEvent) => poolEvent._i !== resEvent.id\n                    );\n                } else {\n                    nacks++;\n                }\n            });\n\n            // Keep dispatching until the pool size reaches a sane level.\n            if (pool.length >= dispatchLimit && nacks === 0) {\n                dispatch(eventsTrackUrl);\n            }\n        })\n        .catch((err) => {\n            dispatching = false;\n            // Try dispatching again in 20 seconds, if we aren't already trying\n            if (!dispatchRetryInterval) {\n                console.warn(\n                    \"We're gonna keep trying, but there was an error while dispatching events:\",\n                    err\n                );\n\n                dispatchRetryInterval = setInterval(\n                    () => dispatch(eventsTrackUrl),\n                    20000\n                );\n            }\n        });\n}\nvar dispatch = throttle(_dispatch, 4000);\n\nclientLocalStorage.set('event-tracker-pool', []);\n\ntry {\n    window.addEventListener(\n        'beforeunload',\n        () => {\n            pool = pool.concat(getPool());\n\n            clientLocalStorage.set('event-tracker-pool', pool);\n        },\n        false\n    );\n} catch (error) {}\n","import MicroEvent from 'microevent';\n\nclass IncitoPublicationEventTracking {\n    constructor(eventTracker, details) {\n        this.eventTracker = eventTracker;\n        this.details = details;\n    }\n\n    trackOpened() {\n        if (this.eventTracker == null || this.details == null) {\n            return this;\n        }\n\n        this.eventTracker.trackIncitoPublicationOpened({\n            'ip.paged': this.details.types.indexOf('paged') > -1,\n            'ip.id': this.details.id,\n            vt: this.eventTracker.createViewToken(this.details.id)\n        });\n\n        return this;\n    }\n}\n\nMicroEvent.mixin(IncitoPublicationEventTracking);\n\nexport default IncitoPublicationEventTracking;\n","import Incito from 'incito-browser';\nimport MicroEvent from 'microevent';\nimport EventTracking from './event-tracking';\n\nclass Viewer {\n    constructor(el, options = {}) {\n        this.el = el;\n        this.options = options;\n        this.incito = new Incito(this.el, {\n            incito: this.options.incito,\n            renderLaziness: this.options.renderLaziness\n        });\n        this._eventTracking = new EventTracking(\n            this.options.eventTracker,\n            this.options.details\n        );\n    }\n\n    start() {\n        this.incito.start();\n        this.el.classList.add('sgn-incito--started');\n        this._eventTracking.trackOpened();\n\n        return this;\n    }\n\n    destroy() {\n        this.incito.destroy();\n    }\n}\nViewer.Incito = Incito;\n\nMicroEvent.mixin(Viewer);\n\nexport default Viewer;\n","module.exports = class Controls {\n    constructor(viewer) {\n        this.scroll = this.scroll.bind(this);\n        this.viewer = viewer;\n        this.progressEl = this.viewer.el.querySelector('.sgn-incito__progress');\n        this.isScrolling = false;\n\n        if (this.progressEl) {\n            this.progressEl.textContent = '0 %';\n\n            window.addEventListener('scroll', this.scroll, false);\n\n            this.viewer.bind('destroyed', () => {\n                window.removeEventListener('scroll', this.scroll, false);\n            });\n        }\n    }\n\n    scroll() {\n        const winHeight = window.innerHeight;\n        const rect = this.viewer.el.getBoundingClientRect();\n        const progress = Math.min(\n            100,\n            Math.round((Math.abs(rect.top - winHeight) / rect.height) * 100)\n        );\n\n        clearTimeout(this.scrollTimeout);\n        this.scrollTimeout = setTimeout(() => {\n            this.isScrolling = false;\n\n            this.viewer.el.classList.remove('sgn-incito--scrolling');\n        }, 1000);\n\n        if (this.isScrolling === false) {\n            this.viewer.el.classList.add('sgn-incito--scrolling');\n\n            this.isScrolling = true;\n        }\n\n        this.progressEl.textContent = `${progress} %`;\n        this.viewer.trigger('progress', {progress});\n    }\n};\n","import fetch from 'cross-fetch';\nimport Gator from '../../../vendor/gator';\nimport * as SGN from '../../core';\nimport * as clientLocalStorage from '../../storage/client-local';\nimport {error, getDeviceCategory, getOrientation, getPointer} from '../../util';\nimport request from '../core/request';\nimport Controls from './controls';\nimport Viewer from './viewer';\n\nexport default class Bootstrapper {\n    constructor(options = {}) {\n        this.fetchDetails = this.fetchDetails.bind(this);\n        this.options = options;\n        this.deviceCategory = this.getDeviceCategory();\n        this.pixelRatio = this.getPixelRatio();\n        this.pointer = this.getPointer();\n        this.orientation = this.getOrientation();\n        this.time = this.getTime();\n        this.locale = this.getLocale();\n        this.maxWidth = this.getMaxWidth();\n        this.featureLabels = this.getFeatureLabels();\n        this.versionsSupported = ['1.0.0'];\n    }\n\n    getDeviceCategory() {\n        return getDeviceCategory();\n    }\n\n    getPixelRatio() {\n        return window.devicePixelRatio || 1;\n    }\n\n    getPointer() {\n        return getPointer();\n    }\n\n    getOrientation() {\n        let orientation = getOrientation(screen.width, screen.height);\n        if (orientation === 'quadratic') {\n            orientation = 'horizontal';\n        }\n\n        return orientation;\n    }\n\n    getTime() {\n        return new Date().toISOString();\n    }\n\n    getLocale() {\n        let localeChain = [];\n        let locale = null;\n\n        if (\n            Array.isArray(navigator.languages) &&\n            navigator.languages.length > 0\n        ) {\n            localeChain = localeChain.concat(navigator.languages);\n        } else if (\n            typeof navigator.language === 'string' &&\n            navigator.language.length > 0\n        ) {\n            localeChain.push(navigator.language);\n        } else if (\n            typeof navigator.browserLanguage === 'string' &&\n            navigator.browserLanguage.length > 0\n        ) {\n            localeChain.push(navigator.browserLanguage);\n        }\n\n        localeChain.push('en_US');\n\n        for (let prefLocale of localeChain) {\n            if (prefLocale == null) {\n                continue;\n            }\n\n            prefLocale = prefLocale.replace('-', '_');\n\n            if (/[a-z][a-z]_[A-Z][A-Z]/g.test(prefLocale)) {\n                locale = prefLocale;\n\n                break;\n            }\n        }\n\n        return locale;\n    }\n\n    getMaxWidth() {\n        if (Math.abs(window.orientation) === 90) {\n            return Math.min(this.options.el.offsetWidth, screen.width);\n        } else {\n            return this.options.el.offsetWidth;\n        }\n    }\n\n    getFeatureLabels() {\n        let featureLabels = clientLocalStorage.get('incito-feature-labels');\n        if (Array.isArray(featureLabels) === false) {\n            featureLabels = [];\n        }\n\n        return featureLabels;\n    }\n\n    anonymizeFeatureLabels() {\n        const count = this.featureLabels.length;\n        const vector = this.featureLabels.reduce((acc, cur) => {\n            if (!acc[cur]) {\n                acc[cur] = {\n                    key: cur,\n                    value: 0\n                };\n            }\n\n            acc[cur].value++;\n\n            return acc;\n        }, {});\n\n        return Object.values(vector).map((featureLabel) => ({\n            key: featureLabel.key,\n            value: Math.round((featureLabel.value / count) * 100) / 100\n        }));\n    }\n\n    fetch(callback) {\n        this.fetchDetails(this.options.id, (err, details) => {\n            if (err != null) {\n                return callback(err);\n            }\n            this.fetchIncito(details.incito_publication_id, (err1, incito) => {\n                if (err1 != null) {\n                    return callback(err1);\n                }\n                callback(null, {\n                    details,\n                    incito\n                });\n            });\n        });\n    }\n\n    fetchDetails(id, callback) {\n        request({url: `/v2/catalogs/${this.options.id}`}, callback);\n    }\n\n    fetchIncito(id, callback) {\n        const res = fetch(\n            SGN.config.get('coreUrl') +\n                '/v4/rpc/generate_incito_from_publication',\n            {\n                method: 'post',\n                headers: {\n                    'X-Api-Key': SGN.config.get('appKey'),\n                    'Content-Type': 'application/json',\n                    Accept: 'application/json'\n                },\n                body: JSON.stringify({\n                    id,\n                    device_category: this.deviceCategory,\n                    pointer: this.pointer,\n                    orientation: this.orientation,\n                    pixel_ratio: this.pixelRatio,\n                    max_width: this.maxWidth,\n                    versions_supported: this.versionsSupported,\n                    locale_code: this.locale,\n                    time: this.time,\n                    feature_labels: this.anonymizeFeatureLabels(\n                        this.featureLabels\n                    )\n                })\n            }\n        );\n\n        res.then((response) => response.json())\n            .then((incito) => callback(null, incito))\n            .catch((err) => callback(err));\n    }\n\n    createViewer(data) {\n        if (data.incito == null) {\n            throw error(\n                new Error(),\n                'You need to supply valid Incito to create a viewer'\n            );\n        }\n\n        const viewer = new Viewer(this.options.el, {\n            id: this.options.id,\n            details: data.details,\n            incito: data.incito,\n            eventTracker: this.options.eventTracker\n        });\n        // Awfully this Controls instance is destroyed implicitly\n        // via the `destroyed` event of Viewer.\n        new Controls(viewer);\n        const self = this;\n\n        // Persist clicks on feature labels for later anonymization.\n        Gator(viewer.el).on(\n            'click',\n            '.incito__view[data-feature-labels]',\n            function () {\n                const featureLabels = this.getAttribute(\n                    'data-feature-labels'\n                ).split(',');\n\n                self.featureLabels = self.featureLabels.concat(featureLabels);\n\n                while (self.featureLabels.length > 1000) {\n                    self.featureLabels.shift();\n                }\n\n                clientLocalStorage.set(\n                    'incito-feature-labels',\n                    self.featureLabels\n                );\n            }\n        );\n\n        return viewer;\n    }\n}\n","import MicroEvent from 'microevent';\nimport * as keyCodes from '../../key-codes';\nimport {throttle} from '../../util';\n\nclass PagedPublicationControls {\n    constructor(el, options = {}) {\n        this.destroy = this.destroy.bind(this);\n        this.beforeNavigation = this.beforeNavigation.bind(this);\n        this.prevClicked = this.prevClicked.bind(this);\n        this.nextClicked = this.nextClicked.bind(this);\n        this.closeClicked = this.closeClicked.bind(this);\n        this.keyDown = this.keyDown.bind(this);\n        this.options = options;\n        this.els = {\n            root: el,\n            progress: el.querySelector('.sgn-pp__progress'),\n            progressBar: el.querySelector('.sgn-pp-progress__bar'),\n            progressLabel: el.querySelector('.sgn-pp__progress-label'),\n            prevControl: el.querySelector(\n                '.sgn-pp__control[data-direction=prev]'\n            ),\n            nextControl: el.querySelector(\n                '.sgn-pp__control[data-direction=next]'\n            ),\n            close: el.querySelector('.sgn-pp--close')\n        };\n\n        this.keyDownHandler = throttle(this.keyDown, 150, this);\n        if (this.options.keyboard === true) {\n            this.els.root.addEventListener(\n                'keydown',\n                this.keyDownHandler,\n                false\n            );\n        }\n        this.els.prevControl?.addEventListener(\n            'mousedown',\n            this.prevClicked,\n            false\n        );\n        this.els.nextControl?.addEventListener(\n            'mousedown',\n            this.nextClicked,\n            false\n        );\n        this.els.close?.addEventListener('mousedown', this.closeClicked, false);\n\n        this.bind('beforeNavigation', this.beforeNavigation);\n        this.bind('destroyed', this.destroy);\n    }\n\n    destroy() {\n        if (this.options.keyboard === true) {\n            this.els.root.removeEventListener(\n                'keydown',\n                this.keyDownHandler,\n                false\n            );\n        }\n        this.els.prevControl?.removeEventListener(\n            'mousedown',\n            this.prevClicked,\n            false\n        );\n\n        this.els.nextControl?.removeEventListener(\n            'mousedown',\n            this.nextClicked,\n            false\n        );\n\n        this.els.close?.removeEventListener(\n            'mousedown',\n            this.closeClicked,\n            false\n        );\n    }\n\n    beforeNavigation(e) {\n        const showProgress =\n            typeof e.progressLabel === 'string' && e.progressLabel.length > 0;\n        const visibilityClassName = 'sgn-pp--hidden';\n\n        if (this.els.progress && this.els.progressBar) {\n            this.els.progressBar.style.width = `${e.progress}%`;\n\n            if (showProgress === true) {\n                this.els.progress.classList.remove(visibilityClassName);\n            } else {\n                this.els.progress.classList.add(visibilityClassName);\n            }\n        }\n\n        if (this.els.progressLabel) {\n            if (showProgress === true) {\n                this.els.progressLabel.textContent = e.progressLabel;\n                this.els.progressLabel.classList.remove(visibilityClassName);\n            } else {\n                this.els.progressLabel.classList.add(visibilityClassName);\n            }\n        }\n\n        if (this.els.prevControl) {\n            if (e.verso.newPosition === 0) {\n                this.els.prevControl.classList.add(visibilityClassName);\n            } else {\n                this.els.prevControl.classList.remove(visibilityClassName);\n            }\n        }\n\n        if (this.els.nextControl) {\n            if (e.verso.newPosition === e.pageSpreadCount - 1) {\n                this.els.nextControl.classList.add(visibilityClassName);\n            } else {\n                this.els.nextControl.classList.remove(visibilityClassName);\n            }\n        }\n    }\n\n    prevClicked(e) {\n        e.preventDefault();\n\n        this.trigger('prev');\n    }\n\n    nextClicked(e) {\n        e.preventDefault();\n\n        this.trigger('next');\n    }\n\n    closeClicked(e) {\n        e.preventDefault();\n\n        this.trigger('close');\n    }\n\n    keyDown(e) {\n        const {keyCode} = e;\n\n        if (keyCodes.ARROW_LEFT === keyCode) {\n            this.trigger('prev', {duration: 0});\n        } else if (\n            keyCodes.ARROW_RIGHT === keyCode ||\n            keyCodes.SPACE === keyCode\n        ) {\n            this.trigger('next', {duration: 0});\n        } else if (keyCodes.NUMBER_ONE === keyCode) {\n            this.trigger('first', {duration: 0});\n        }\n    }\n}\n\nMicroEvent.mixin(PagedPublicationControls);\n\nexport default PagedPublicationControls;\n","import MicroEvent from 'microevent';\nimport {loadImage} from '../../util';\n\nclass PagedPublicationPageSpread {\n    constructor(options = {}) {\n        this.options = options;\n        this.contentsRendered = false;\n        this.hotspotsRendered = false;\n        this.el = this.renderEl();\n    }\n\n    getId() {\n        return this.options.id;\n    }\n\n    getEl() {\n        return this.el;\n    }\n\n    getPages() {\n        return this.options.pages;\n    }\n\n    renderEl() {\n        const el = document.createElement('div');\n        const pageIds = this.getPages().map((page) => page.id);\n\n        el.className = 'verso__page-spread sgn-pp__page-spread';\n\n        el.setAttribute('data-id', this.getId());\n        el.setAttribute('data-type', 'page');\n        el.setAttribute('data-width', this.options.width);\n        el.setAttribute('data-page-ids', pageIds.join(','));\n        el.setAttribute('data-max-zoom-scale', this.options.maxZoomScale);\n        el.setAttribute('data-zoomable', false);\n\n        return el;\n    }\n\n    renderContents() {\n        const id = this.getId();\n        const el = this.getEl();\n        const pages = this.getPages();\n        const pageCount = pages.length;\n        let imageLoads = 0;\n\n        let maxPageWidth = el.clientWidth * (window.devicePixelRatio || 1);\n        if (this.options.pageMode === 'double') {\n            maxPageWidth = maxPageWidth / 2;\n        }\n\n        const useLargeImage = maxPageWidth > 700;\n\n        pages.forEach((page, i) => {\n            let image = page.images.medium;\n            if (useLargeImage) {\n                image = page.images.large;\n            }\n\n            const pageEl = document.createElement('div');\n            const loaderEl = document.createElement('div');\n\n            pageEl.className = 'sgn-pp__page verso__page';\n            if (page.id != null) {\n                pageEl.setAttribute('data-id', page.id);\n            }\n\n            if (pageCount === 2) {\n                pageEl.className +=\n                    i === 0 ? ' verso-page--verso' : ' verso-page--recto';\n            }\n\n            pageEl.appendChild(loaderEl);\n            el.appendChild(pageEl);\n\n            loaderEl.className = 'sgn-pp-page__loader';\n            loaderEl.innerHTML = `<span>${page.label}</span>`;\n\n            loadImage(image, (err, width, height) => {\n                if (err == null) {\n                    const isComplete = ++imageLoads === pageCount;\n\n                    pageEl.style.backgroundImage = `url(${image})`;\n                    pageEl.setAttribute('data-width', width);\n                    pageEl.setAttribute('data-height', height);\n                    pageEl.innerHTML = '&nbsp;';\n\n                    if (isComplete) {\n                        el.setAttribute('data-zoomable', true);\n                    }\n\n                    this.trigger('pageLoaded', {pageSpreadId: id, page});\n                    if (isComplete) {\n                        this.trigger('pagesLoaded', {pageSpreadId: id, pages});\n                    }\n                } else {\n                    loaderEl.innerHTML = '<span>!</span>';\n                }\n            });\n        });\n\n        this.contentsRendered = true;\n\n        return this;\n    }\n\n    clearContents() {\n        this.el.innerHTML = '';\n        this.contentsRendered = false;\n\n        return this;\n    }\n\n    zoomIn() {\n        const pageEls = [].slice.call(\n            this.el.querySelectorAll('.sgn-pp__page')\n        );\n        const pages = this.getPages();\n\n        pageEls.forEach((pageEl) => {\n            const id = pageEl.getAttribute('data-id');\n            const page = pages.find((page) => page.id === id);\n            const image = page.images.large;\n\n            loadImage(image, (err) => {\n                if (\n                    err == null &&\n                    this.el.getAttribute('data-active') === 'true'\n                ) {\n                    pageEl.setAttribute(\n                        'data-image',\n                        pageEl.style.backgroundImage\n                    );\n                    pageEl.style.backgroundImage = `url(${image})`;\n                }\n            });\n        });\n    }\n\n    zoomOut() {\n        const pageEls = Array.from(\n            this.el.querySelectorAll('.sgn-pp__page[data-image]')\n        );\n\n        pageEls.forEach((pageEl) => {\n            pageEl.style.backgroundImage = pageEl.getAttribute('data-image');\n\n            pageEl.removeAttribute('data-image');\n        });\n    }\n}\n\nMicroEvent.mixin(PagedPublicationPageSpread);\n\nexport default PagedPublicationPageSpread;\n","import MicroEvent from 'microevent';\nimport {chunk} from '../../util';\nimport PageSpread from './page-spread';\n\nclass PagedPublicationPageSpreads {\n    constructor(options) {\n        this.options = options;\n        this.collection = [];\n        this.ids = {};\n    }\n\n    get(id) {\n        return this.ids[id];\n    }\n\n    getFrag() {\n        const frag = document.createDocumentFragment();\n\n        this.collection.forEach((pageSpread) =>\n            frag.appendChild(pageSpread.el)\n        );\n\n        return frag;\n    }\n\n    update(pageMode = 'single') {\n        const pageSpreads = [];\n        const ids = {};\n        const pages = this.options.pages.slice();\n        const {width, maxZoomScale} = this.options;\n\n        if (pageMode === 'single') {\n            pages.forEach((page) => pageSpreads.push([page]));\n        } else {\n            const firstPage = pages.shift();\n            const lastPage = pages.length % 2 === 1 ? pages.pop() : null;\n            const midstPageSpreads = chunk(pages, 2);\n\n            if (firstPage) {\n                pageSpreads.push([firstPage]);\n            }\n            midstPageSpreads.forEach((midstPages) =>\n                pageSpreads.push(midstPages.map((page) => page))\n            );\n            if (lastPage) {\n                pageSpreads.push([lastPage]);\n            }\n        }\n\n        this.collection = pageSpreads.map((pages, i) => {\n            const id = `${pageMode}-${i}`;\n            const pageSpread = new PageSpread({\n                width,\n                pageMode,\n                maxZoomScale,\n                pages,\n                id\n            });\n\n            pageSpread.bind('pageLoaded', (e) => this.trigger('pageLoaded', e));\n            pageSpread.bind('pagesLoaded', (e) =>\n                this.trigger('pagesLoaded', e)\n            );\n\n            ids[id] = pageSpread;\n\n            return pageSpread;\n        });\n        this.ids = ids;\n\n        return this;\n    }\n}\n\nMicroEvent.mixin(PagedPublicationPageSpreads);\n\nexport default PagedPublicationPageSpreads;\n","import MicroEvent from 'microevent';\nimport Verso from 'verso-browser';\nimport {getColorBrightness, throttle} from '../../util';\nimport PageSpreads from './page-spreads';\n\nclass PagedPublicationCore {\n    constructor(el, options = {}) {\n        this.beforeNavigation = this.beforeNavigation.bind(this);\n        this.afterNavigation = this.afterNavigation.bind(this);\n        this.attemptedNavigation = this.attemptedNavigation.bind(this);\n        this.clicked = this.clicked.bind(this);\n        this.doubleClicked = this.doubleClicked.bind(this);\n        this.pressed = this.pressed.bind(this);\n        this.contextmenu = this.contextmenu.bind(this);\n        this.panStart = this.panStart.bind(this);\n        this.panEnd = this.panEnd.bind(this);\n        this.zoomedIn = this.zoomedIn.bind(this);\n        this.zoomedOut = this.zoomedOut.bind(this);\n        this.resize = this.resize.bind(this);\n        this.unload = this.unload.bind(this);\n        this.options = this.makeOptions(options, this.defaults);\n        this.pageId = this.getOption('pageId');\n        this.els = {\n            root: el,\n            pages: el.querySelector('.sgn-pp__pages'),\n            verso: el.querySelector('.verso')\n        };\n        this.pageMode = this.getPageMode();\n        this.pageSpreads = new PageSpreads({\n            pages: this.getOption('pages'),\n            maxZoomScale: this.getOption('pageSpreadMaxZoomScale'),\n            width: this.getOption('pageSpreadWidth')\n        });\n\n        this.pageSpreads.bind('pageLoaded', this.pageLoaded.bind(this));\n        this.pageSpreads.bind('pagesLoaded', this.pagesLoaded.bind(this));\n\n        this.setColor(this.getOption('color'));\n\n        // It's important to insert the page spreads before instantiating Verso.\n        this.els.pages.parentNode.insertBefore(\n            this.pageSpreads.update(this.pageMode).getFrag(),\n            this.els.pages\n        );\n\n        this.verso = this.createVerso();\n\n        this.bind('started', this.start.bind(this));\n        this.bind('destroyed', this.destroy.bind(this));\n    }\n\n    start() {\n        const verso = this.getVerso();\n        verso.start();\n\n        verso.pageSpreads.forEach(\n            this.overridePageSpreadContentRect.bind(this)\n        );\n\n        this.resizeListener = throttle(\n            this.resize,\n            this.getOption('resizeDelay')\n        );\n\n        window.addEventListener('resize', this.resizeListener, false);\n        window.addEventListener('beforeunload', this.unload, false);\n\n        this.els.root.setAttribute('data-started', '');\n        this.els.root.setAttribute('tabindex', '-1');\n        this.els.root.focus();\n    }\n\n    destroy() {\n        const verso = this.getVerso();\n        const pageSpreadEls = verso.el.querySelectorAll('.sgn-pp__page-spread');\n\n        this.els.root.removeAttribute('data-started');\n        this.els.root.removeAttribute('data-idle');\n        this.els.root.removeAttribute('data-navigating');\n        this.els.root.removeAttribute('data-color-brightness');\n        this.els.root.removeAttribute('data-zoomed-in');\n\n        this.els.root.style.backgroundColor = '#ffffff';\n\n        Array.from(pageSpreadEls).forEach((pageSpreadEl) => {\n            pageSpreadEl.parentNode.removeChild(pageSpreadEl);\n        });\n\n        verso.destroy();\n\n        window.removeEventListener('resize', this.resizeListener, false);\n        window.removeEventListener('beforeunload', this.unload, false);\n    }\n\n    makeOptions(options, defaults) {\n        const opts = {};\n\n        for (let key in options) {\n            opts[key] = options[key] ?? defaults[key];\n        }\n\n        return opts;\n    }\n\n    getOption(key) {\n        return this.options[key];\n    }\n\n    setColor(color) {\n        this.els.root.setAttribute(\n            'data-color-brightness',\n            getColorBrightness(color)\n        );\n        this.els.root.style.backgroundColor = color;\n    }\n\n    createVerso() {\n        const verso = new Verso(this.els.verso, {pageId: this.pageId});\n\n        verso.bind('beforeNavigation', this.beforeNavigation);\n        verso.bind('afterNavigation', this.afterNavigation);\n        verso.bind('attemptedNavigation', this.attemptedNavigation);\n        verso.bind('clicked', this.clicked);\n        verso.bind('doubleClicked', this.doubleClicked);\n        verso.bind('pressed', this.pressed);\n        verso.bind('contextmenu', this.contextmenu);\n        verso.bind('panStart', this.panStart);\n        verso.bind('panEnd', this.panEnd);\n        verso.bind('zoomedIn', this.zoomedIn);\n        verso.bind('zoomedOut', this.zoomedOut);\n\n        return verso;\n    }\n\n    getVerso() {\n        return this.verso;\n    }\n\n    getContentRect(pageSpread) {\n        const rect = {\n            top: 0,\n            left: 0,\n            right: 0,\n            bottom: 0,\n            width: 0,\n            height: 0\n        };\n        const pageEls = pageSpread.getPageEls();\n        const pageEl = pageEls[0];\n        const pageCount = pageEls.length;\n\n        if (!pageCount) {\n            return rect;\n        }\n\n        const {scale} = this.getVerso().transform;\n        const pageWidth = pageEl.offsetWidth * pageCount * scale;\n        const pageHeight = pageEl.offsetHeight * scale;\n        const imageRatio =\n            +pageEl.getAttribute('data-height') /\n            (+pageEl.getAttribute('data-width') * pageCount);\n        let actualHeight = pageHeight;\n        let actualWidth = actualHeight / imageRatio;\n        actualWidth = Math.min(pageWidth, actualWidth);\n        actualHeight = actualWidth * imageRatio;\n        const clientRect = pageEl.getBoundingClientRect();\n\n        rect.width = actualWidth;\n        rect.height = actualHeight;\n        rect.top = clientRect.top + (pageHeight - actualHeight) / 2;\n        rect.left = clientRect.left + (pageWidth - actualWidth) / 2;\n        rect.right = rect.width + rect.left;\n        rect.bottom = rect.height + rect.top;\n\n        return rect;\n    }\n\n    formatProgressLabel(pageSpread) {\n        const pages = pageSpread?.options.pages ?? [];\n        const pageIds = pages.map((page) => page.id);\n        const pageLabels = pages.map((page) => page.label);\n        const pageCount = this.getOption('pages').length;\n        const label =\n            pageIds.length > 0\n                ? pageLabels.join('-') + ' / ' + pageCount\n                : null;\n\n        return label;\n    }\n\n    renderPageSpreads() {\n        this.getVerso().pageSpreads.forEach((pageSpread) => {\n            const visibility = pageSpread.getVisibility();\n            const match = this.pageSpreads.get(pageSpread.getId());\n\n            if (match) {\n                if (\n                    visibility === 'visible' &&\n                    match.contentsRendered === false\n                ) {\n                    setTimeout(match.renderContents.bind(match), 0);\n                }\n                if (visibility === 'gone' && match.contentsRendered === true) {\n                    setTimeout(match.clearContents.bind(match), 0);\n                }\n            }\n        });\n\n        return this;\n    }\n\n    findPage(pageId) {\n        return this.getOption('pages').find((page) => page.id === pageId);\n    }\n\n    pageLoaded(e) {\n        this.trigger('pageLoaded', e);\n    }\n\n    pagesLoaded(e) {\n        this.trigger('pagesLoaded', e);\n    }\n\n    beforeNavigation(e) {\n        const position = e.newPosition;\n        const theVerso = this.getVerso();\n        const versoPageSpread = theVerso.getPageSpreadFromPosition(position);\n        const pageSpread = this.pageSpreads.get(versoPageSpread.getId());\n        const pageSpreadCount = theVerso.getPageSpreadCount();\n        const newSpreadEl = theVerso.pageSpreadEls[e.newPosition];\n        const progress = (position / (pageSpreadCount - 1)) * 100;\n        const progressLabel = this.formatProgressLabel(pageSpread);\n\n        this.els.root.setAttribute('data-navigating', true);\n\n        this.renderPageSpreads();\n        this.resetIdleTimer();\n        this.startIdleTimer();\n        this.trigger('beforeNavigation', {\n            verso: e,\n            pageSpread,\n            newSpreadEl,\n            progress,\n            progressLabel,\n            pageSpreadCount,\n            newPositionIsEnd: e.newPosition + 1 === pageSpreadCount\n        });\n    }\n\n    afterNavigation(e) {\n        const position = e.newPosition;\n        const theVerso = this.getVerso();\n        const versoPageSpread = theVerso.getPageSpreadFromPosition(position);\n        const pageSpread = this.pageSpreads.get(versoPageSpread.getId());\n        const pageSpreadCount = theVerso.getPageSpreadCount();\n        const newSpreadEl = theVerso.pageSpreadEls[e.newPosition];\n\n        this.els.root.setAttribute('data-navigating', false);\n\n        this.trigger('afterNavigation', {\n            verso: e,\n            pageSpread,\n            pageSpreadCount,\n            newSpreadEl,\n            newPositionIsEnd: e.newPosition + 1 === pageSpreadCount\n        });\n    }\n\n    attemptedNavigation(e) {\n        this.trigger('attemptedNavigation', {verso: e});\n    }\n\n    clicked(e) {\n        if (e.isInsideContent) {\n            const pageId = e.pageEl.getAttribute('data-id');\n            const page = this.findPage(pageId);\n\n            this.trigger('clicked', {verso: e, page});\n        }\n    }\n\n    doubleClicked(e) {\n        if (e.isInsideContent) {\n            const pageId = e.pageEl.getAttribute('data-id');\n            const page = this.findPage(pageId);\n\n            this.trigger('doubleClicked', {verso: e, page});\n        }\n    }\n\n    pressed(e) {\n        if (e.isInsideContent) {\n            const pageId = e.pageEl.getAttribute('data-id');\n            const page = this.findPage(pageId);\n\n            this.trigger('pressed', {verso: e, page});\n        }\n    }\n\n    contextmenu(e) {\n        if (e.isInsideContent) {\n            const pageId = e.pageEl.getAttribute('data-id');\n            const page = this.findPage(pageId);\n\n            this.trigger('contextmenu', {verso: e, page});\n        }\n    }\n\n    panStart() {\n        this.resetIdleTimer();\n        this.trigger('panStart', {scale: this.getVerso().transform.scale});\n    }\n\n    panEnd() {\n        this.startIdleTimer();\n        this.trigger('panEnd');\n    }\n\n    zoomedIn(e) {\n        const {position} = e;\n        const versoPageSpread = this.getVerso().getPageSpreadFromPosition(\n            position\n        );\n        const pageSpread = this.pageSpreads.get(versoPageSpread.getId());\n\n        pageSpread?.zoomIn();\n\n        this.els.root.setAttribute('data-zoomed-in', true);\n        this.trigger('zoomedIn', {verso: e, pageSpread});\n    }\n\n    zoomedOut(e) {\n        const {position} = e;\n        const versoPageSpread = this.getVerso().getPageSpreadFromPosition(\n            position\n        );\n        const pageSpread = this.pageSpreads.get(versoPageSpread.getId());\n\n        pageSpread?.zoomOut();\n\n        this.els.root.setAttribute('data-zoomed-in', false);\n        this.trigger('zoomedOut', {verso: e, pageSpread});\n    }\n\n    getPageMode() {\n        let pageMode = this.getOption('pageMode');\n\n        if (pageMode == null) {\n            const width = this.els.root.offsetWidth;\n            const height = this.els.root.offsetHeight;\n\n            pageMode = height / width < 0.8 ? 'double' : 'single';\n        }\n\n        return pageMode;\n    }\n\n    resetIdleTimer() {\n        clearTimeout(this.idleTimeout);\n\n        this.els.root.setAttribute('data-idle', false);\n\n        return this;\n    }\n\n    startIdleTimer() {\n        this.idleTimeout = setTimeout(() => {\n            this.els.root.setAttribute('data-idle', true);\n        }, this.getOption('idleDelay'));\n\n        return this;\n    }\n\n    switchPageMode(pageMode) {\n        if (this.pageMode === pageMode) {\n            return this;\n        }\n\n        const verso = this.getVerso();\n        const pageIds = verso\n            .getPageSpreadFromPosition(verso.getPosition())\n            .getPageIds();\n        const pageSpreadEls = this.getVerso().el.querySelectorAll(\n            '.sgn-pp__page-spread'\n        );\n\n        this.pageMode = pageMode;\n\n        this.pageSpreads.update(this.pageMode);\n\n        Array.from(pageSpreadEls).forEach((pageSpreadEl) => {\n            pageSpreadEl.parentNode.removeChild(pageSpreadEl);\n        });\n        this.els.pages.parentNode.insertBefore(\n            this.pageSpreads.getFrag(),\n            this.els.pages\n        );\n\n        verso.refresh();\n        verso.navigateTo(verso.getPageSpreadPositionFromPageId(pageIds[0]), {\n            duration: 0\n        });\n        verso.pageSpreads.forEach(\n            this.overridePageSpreadContentRect.bind(this)\n        );\n\n        return this;\n    }\n\n    overridePageSpreadContentRect(pageSpread) {\n        if (pageSpread.getType() === 'page') {\n            return (pageSpread.getContentRect = () =>\n                this.getContentRect(pageSpread));\n        }\n    }\n\n    resize() {\n        const pageMode = this.getPageMode();\n\n        if (this.getOption('pageMode') == null && pageMode !== this.pageMode) {\n            this.switchPageMode(pageMode);\n        } else {\n            this.trigger('resized');\n        }\n    }\n\n    unload() {\n        this.trigger('disappeared');\n    }\n}\nPagedPublicationCore.prototype.defaults = {\n    pages: [],\n    pageSpreadWidth: 100,\n    pageSpreadMaxZoomScale: 2.3,\n    idleDelay: 1000,\n    resizeDelay: 400,\n    color: '#ffffff'\n};\n\nMicroEvent.mixin(PagedPublicationCore);\n\nexport default PagedPublicationCore;\n","import MicroEvent from 'microevent';\n\nclass PagedPublicationEventTracking {\n    constructor(eventTracker, id) {\n        this.eventTracker = eventTracker;\n        this.id = id;\n        this.hidden = true;\n        this.pageSpread = null;\n\n        this.bind('appeared', this.appeared.bind(this));\n        this.bind('disappeared', this.disappeared.bind(this));\n        this.bind('beforeNavigation', this.beforeNavigation.bind(this));\n        this.bind('afterNavigation', this.afterNavigation.bind(this));\n        this.bind('attemptedNavigation', this.attemptedNavigation.bind(this));\n        this.bind('panStart', this.panStart.bind(this));\n        this.bind('destroyed', this.destroy.bind(this));\n    }\n\n    destroy() {\n        this.pageSpreadDisappeared();\n    }\n\n    trackOpened() {\n        if (this.eventTracker == null) {\n            return this;\n        }\n\n        this.eventTracker.trackPagedPublicationOpened({\n            'pp.id': this.id,\n            vt: this.eventTracker.createViewToken(this.id)\n        });\n\n        return this;\n    }\n\n    trackPageSpreadDisappeared(pageNumbers) {\n        if (this.eventTracker == null) {\n            return this;\n        }\n\n        pageNumbers.forEach((pageNumber) => {\n            this.eventTracker.trackPagedPublicationPageDisappeared({\n                'pp.id': this.id,\n                'ppp.n': pageNumber,\n                vt: this.eventTracker.createViewToken(this.id, pageNumber)\n            });\n        });\n\n        return this;\n    }\n\n    appeared(e) {\n        this.pageSpreadAppeared(e.pageSpread);\n    }\n\n    disappeared() {\n        this.pageSpreadDisappeared();\n    }\n\n    beforeNavigation() {\n        this.pageSpreadDisappeared();\n    }\n\n    afterNavigation(e) {\n        this.pageSpreadAppeared(e.pageSpread);\n    }\n\n    attemptedNavigation(e) {\n        this.pageSpreadAppeared(e.pageSpread);\n    }\n\n    panStart(e) {\n        if (e.scale === 1) {\n            this.pageSpreadDisappeared();\n        }\n    }\n\n    pageSpreadAppeared(pageSpread) {\n        if (pageSpread && this.hidden === true) {\n            this.pageSpread = pageSpread;\n            this.hidden = false;\n        }\n    }\n\n    pageSpreadDisappeared() {\n        if (this.pageSpread && this.hidden === false) {\n            this.trackPageSpreadDisappeared(\n                this.pageSpread.getPages().map((page) => page.pageNumber)\n            );\n\n            this.hidden = true;\n            this.pageSpread = null;\n        }\n    }\n}\n\nMicroEvent.mixin(PagedPublicationEventTracking);\n\nexport default PagedPublicationEventTracking;\n","import MicroEvent from 'microevent';\nimport Mustache from 'mustache';\n\nclass PagedPublicationHotspots {\n    constructor() {\n        this.currentPageSpreadId = null;\n        this.pageSpreadsLoaded = {};\n        this.cache = {};\n\n        this.bind('hotspotsReceived', this.hotspotsReceived.bind(this));\n        this.bind('afterNavigation', this.afterNavigation.bind(this));\n        this.bind('pagesLoaded', this.pagesLoaded.bind(this));\n        this.bind('resized', this.resized.bind(this));\n    }\n\n    renderHotspots(data) {\n        const frag = document.createDocumentFragment();\n        const contentRect = data.versoPageSpread.getContentRect();\n        const pageSpreadEl = data.pageSpread.getEl();\n        const hotspotEls = pageSpreadEl.querySelectorAll('.sgn-pp__hotspot');\n        const boundingRect = pageSpreadEl.getBoundingClientRect();\n\n        Array.from(hotspotEls).forEach((hotspotEl) => {\n            hotspotEl.parentNode.removeChild(hotspotEl);\n        });\n\n        for (let id in data.hotspots) {\n            const hotspot = data.hotspots[id];\n            const position = this.getPosition(data.pages, data.ratio, hotspot);\n            const el = this.renderHotspot(\n                hotspot,\n                position,\n                contentRect,\n                boundingRect\n            );\n\n            frag.appendChild(el);\n        }\n\n        pageSpreadEl.appendChild(frag);\n\n        return this;\n    }\n\n    renderHotspot(hotspot, position, contentRect, boundingRect) {\n        const el = document.createElement('div');\n        let top = Math.round((contentRect.height / 100) * position.top);\n        let left = Math.round((contentRect.width / 100) * position.left);\n        const width = Math.round((contentRect.width / 100) * position.width);\n        const height = Math.round((contentRect.height / 100) * position.height);\n\n        top += Math.round(contentRect.top);\n        left += Math.round(contentRect.left);\n        top -= boundingRect.top;\n        left -= boundingRect.left;\n\n        el.className = 'sgn-pp__hotspot verso__overlay';\n        if (hotspot.id != null) {\n            el.setAttribute('data-id', hotspot.id);\n        }\n        if (hotspot.type != null) {\n            el.setAttribute('data-type', hotspot.type);\n        }\n        el.innerHTML = Mustache.render('', hotspot);\n\n        el.style.top = `${top}px`;\n        el.style.left = `${left}px`;\n        el.style.width = `${width}px`;\n        el.style.height = `${height}px`;\n\n        return el;\n    }\n\n    getPosition(pages, ratio, hotspot) {\n        let minX = null;\n        let minY = null;\n        let maxX = null;\n        let maxY = null;\n        const pageNumbers = pages.map((page) => page.pageNumber);\n\n        for (var pageNumber in hotspot.locations) {\n            if (pageNumbers.indexOf(+pageNumber) === -1) {\n                continue;\n            }\n\n            hotspot.locations[pageNumber].forEach((coords) => {\n                let [x, y] = coords;\n\n                if (pages[1] && pageNumbers[1] === +pageNumber) {\n                    x += 1;\n                }\n                x /= pages.length;\n\n                if (minX == null) {\n                    minX = maxX = x;\n                    minY = maxY = y;\n                }\n\n                if (x < minX) {\n                    minX = x;\n                }\n                if (x > maxX) {\n                    maxX = x;\n                }\n                if (y < minY) {\n                    minY = y;\n                }\n                if (y > maxY) {\n                    return (maxY = y);\n                }\n            });\n        }\n\n        const width = maxX - minX;\n        const height = maxY - minY;\n\n        return {\n            top: (minY / ratio) * 100,\n            left: minX * 100,\n            width: width * 100,\n            height: (height / ratio) * 100\n        };\n    }\n\n    requestHotspots(pageSpreadId, pages) {\n        this.trigger('hotspotsRequested', {\n            id: pageSpreadId,\n            pages\n        });\n    }\n\n    hotspotsReceived(e) {\n        const pageSpreadId = e.pageSpread.getId();\n\n        this.setCache(pageSpreadId, e);\n        this.renderHotspots(e);\n    }\n\n    getCache(pageSpreadId) {\n        return this.cache[pageSpreadId];\n    }\n\n    setCache(pageSpreadId, data) {\n        this.cache[pageSpreadId] = data;\n\n        return this;\n    }\n\n    afterNavigation(e) {\n        if (e.pageSpread == null) {\n            return;\n        }\n\n        const id = e.pageSpread.getId();\n\n        this.currentPageSpreadId = id;\n        if (this.pageSpreadsLoaded[id]) {\n            this.requestHotspots(id, e.pageSpread.getPages());\n        }\n    }\n\n    pagesLoaded(e) {\n        this.pageSpreadsLoaded[e.pageSpreadId] = true;\n        if (this.currentPageSpreadId === e.pageSpreadId) {\n            this.requestHotspots(e.pageSpreadId, e.pages);\n        }\n    }\n\n    resized() {\n        const data = this.getCache(this.currentPageSpreadId);\n\n        if (data) {\n            this.renderHotspots(data);\n        }\n    }\n}\n\nMicroEvent.mixin(PagedPublicationHotspots);\n\nexport default PagedPublicationHotspots;\n","import MicroEvent from 'microevent';\nimport * as translations from '../../translations';\nimport { uuid } from '../../util';\nimport singleChoicePopover from '../core-ui/single-choice-popover';\nimport Controls from './controls';\nimport Core from './core';\nimport EventTracking from './event-tracking';\nimport Hotspots from './hotspots';\n \nfunction defaultPickHotspot(hotspots, e, el, callback) {\n    const popover = singleChoicePopover(\n        {\n            el,\n            header: translations.t('paged_publication.hotspot_picker.header'),\n            x: e.verso.x,\n            y: e.verso.y,\n            items: hotspots\n                .filter((hotspot) => hotspot.type === 'offer')\n                .map((hotspot) => ({\n                    id: hotspot.id,\n                    title: hotspot.offer.heading,\n                    subtitle:\n                        hotspot.offer.pricing.currency +\n                        '' +\n                        hotspot.offer.pricing.price\n                }))\n        },\n        (picked) =>\n            callback(hotspots.find((hotspot) => hotspot.id === picked.id))\n    );\n\n    return popover.destroy;\n}\n\nclass Viewer {\n    constructor(el, options = {}) {\n        this.el = el;\n        this.options = options;\n        this._core = new Core(this.el, {\n            id: this.options.id,\n            pages: this.options.pages,\n            pageSpreadWidth: this.options.pageSpreadWidth,\n            pageSpreadMaxZoomScale: this.options.pageSpreadMaxZoomScale,\n            pageId: this.options.pageId,\n            idleDelay: this.options.idleDelay,\n            resizeDelay: this.options.resizeDelay,\n            color: this.options.color\n        });\n        this._hotspots = new Hotspots();\n        this._controls = new Controls(this.el, {\n            keyboard: this.options.keyboard\n        });\n        this._eventTracking = new EventTracking(\n            this.options.eventTracker,\n            this.options.id\n        );\n        this.viewSession = uuid();\n        this.hotspots = null;\n        this.hotspotQueue = [];\n        this.popover = null;\n\n        this._setupEventListeners();\n    }\n\n    start() {\n        this._eventTracking.trackOpened();\n        this._core.trigger('started');\n\n        return this;\n    }\n\n    destroy() {\n        this._core.trigger('destroyed');\n        this._hotspots.trigger('destroyed');\n        this._controls.trigger('destroyed');\n        this._eventTracking.trigger('destroyed');\n\n        this.trigger('destroyed');\n\n        return this;\n    }\n\n    navigateTo(position, options) {\n        this.navigateToIndex(position, options);\n\n        return this;\n    }\n\n    navigateToIndex(position, options) {\n        this._core.getVerso().navigateTo(position, options);\n\n        return this;\n    }\n\n    navigateToPageId(pageId, options) {\n        const position = this._core\n            .getVerso()\n            .getPageSpreadPositionFromPageId(pageId);\n\n        return this._core.getVerso().navigateTo(position, options);\n    }\n\n    first(options) {\n        this._core.getVerso().first(options);\n\n        return this;\n    }\n\n    prev(options) {\n        this._core.getVerso().prev(options);\n\n        return this;\n    }\n\n    next(options) {\n        this._core.getVerso().next(options);\n\n        return this;\n    }\n\n    last(options) {\n        this._core.getVerso().last(options);\n\n        return this;\n    }\n\n    _setupEventListeners() {\n        this._controls.bind('prev', (e) => {\n            this.prev(e);\n        });\n        this._controls.bind('next', (e) => {\n            this.next(e);\n        });\n        this._controls.bind('first', (e) => {\n            this.first(e);\n        });\n        this._controls.bind('last', (e) => {\n            this.last(e);\n        });\n        this._controls.bind('close', (e) => {\n            this.destroy(e);\n        });\n        this._hotspots.bind('hotspotsRequested', (e) => {\n            this.trigger('hotspotsRequested', e);\n        });\n\n        this._core.bind('appeared', (e) => {\n            this._eventTracking.trigger('appeared', e);\n            this.trigger('appeared', e);\n        });\n        this._core.bind('disappeared', (e) => {\n            this._eventTracking.trigger('disappeared', e);\n            this.trigger('disappeared', e);\n        });\n        this._core.bind('beforeNavigation', (e) => {\n            this._eventTracking.trigger('beforeNavigation', e);\n            this._controls.trigger('beforeNavigation', e);\n            this.trigger('beforeNavigation', e);\n        });\n        this._core.bind('afterNavigation', (e) => {\n            this._eventTracking.trigger('afterNavigation', e);\n            this._hotspots.trigger('afterNavigation', e);\n            this.trigger('afterNavigation', e);\n        });\n        this._core.bind('attemptedNavigation', (e) => {\n            this._eventTracking.trigger('attemptedNavigation', e);\n            this.trigger('attemptedNavigation', e);\n        });\n        this._core.bind('clicked', (e) => {\n            this._eventTracking.trigger('clicked', e);\n            this.trigger('clicked', e);\n        });\n        this._core.bind('doubleClicked', (e) => {\n            this._eventTracking.trigger('doubleClicked', e);\n            this.trigger('doubleClicked', e);\n        });\n        this._core.bind('contextmenu', (e) => {\n            this.trigger('contextmenu', e);\n        });\n        this._core.bind('pressed', (e) => {\n            this._eventTracking.trigger('pressed', e);\n            this.trigger('pressed', e);\n        });\n        this._core.bind('panStart', (e) => {\n            this._eventTracking.trigger('panStart', e);\n            this.trigger('panStart', e);\n        });\n        this._core.bind('zoomedIn', (e) => {\n            this._eventTracking.trigger('zoomedIn', e);\n            this.trigger('zoomedIn', e);\n        });\n        this._core.bind('zoomedOut', (e) => {\n            this._eventTracking.trigger('zoomedOut', e);\n            this.trigger('zoomedOut', e);\n        });\n        this._core.bind('pageLoaded', (e) => {\n            this._eventTracking.trigger('pageLoaded', e);\n            this.trigger('pageLoaded', e);\n        });\n        this._core.bind('pagesLoaded', (e) => {\n            this._hotspots.trigger('pagesLoaded', e);\n            this.trigger('pagesLoaded', e);\n        });\n        this._core.bind('resized', (e) => {\n            this._hotspots.trigger('resized');\n            this.trigger('resized', e);\n        });\n\n        this.bind('hotspotsRequested', this.hotspotsRequested.bind(this));\n        this.bind('beforeNavigation', this.beforeNavigation.bind(this));\n        this.bind('clicked', this.clicked.bind(this));\n        this.bind('contextmenu', this.contextmenu.bind(this));\n        this.bind('pressed', this.pressed.bind(this));\n    }\n\n    pickHotspot(e, callback) {\n        if (this.hotspots == null) {\n            return;\n        }\n\n        if (this.popover != null) {\n            this.popover.destroy?.();\n            this.popover = null;\n        }\n\n        const hotspots = e.verso.overlayEls.map(\n            (overlayEl) => this.hotspots[overlayEl.getAttribute('data-id')]\n        );\n\n        if (hotspots.length === 1) {\n            callback(hotspots[0]);\n        } else if (hotspots.length > 1) {\n            this.popover = {\n                destroy: (this.options.pickHotspot || defaultPickHotspot)(\n                    hotspots,\n                    e,\n                    this.el,\n                    callback\n                )\n            };\n        }\n    }\n\n    processHotspotQueue() {\n        if (this.hotspots == null) {\n            return;\n        }\n\n        this.hotspotQueue = this.hotspotQueue.filter((hotspotRequest) => {\n            let id;\n            const hotspots = {};\n            const versoPageSpread = this._core\n                .getVerso()\n                .pageSpreads.find(\n                    (pageSpread) => pageSpread.getId() === hotspotRequest.id\n                );\n\n            for (id in this.hotspots) {\n                const hotspot = this.hotspots[id];\n                if (hotspots[id]) {\n                    continue;\n                }\n                for (const page of hotspotRequest.pages) {\n                    if (hotspot.locations[page.pageNumber]) {\n                        hotspots[id] = {\n                            type: hotspot.type,\n                            id: hotspot.id,\n                            locations: hotspot.locations\n                        };\n\n                        break;\n                    }\n                }\n            }\n\n            this._hotspots.trigger('hotspotsReceived', {\n                pageSpread: this._core.pageSpreads.get(hotspotRequest.id),\n                versoPageSpread,\n                ratio: this.options.hotspotRatio,\n                pages: hotspotRequest.pages,\n                hotspots\n            });\n\n            return false;\n        });\n    }\n\n    hotspotsRequested(e) {\n        this.hotspotQueue.push(e);\n        this.processHotspotQueue();\n    }\n\n    applyHotspots(hotspots = {}) {\n        this.hotspots = hotspots;\n\n        this.processHotspotQueue();\n    }\n\n    beforeNavigation() {\n        this.popover?.destroy?.();\n    }\n\n    clicked(e) {\n        this.pickHotspot(e, (hotspot) => {\n            this.trigger('hotspotClicked', hotspot);\n        });\n    }\n\n    contextmenu(e) {\n        this.pickHotspot(e, (hotspot) => {\n            this.trigger('hotspotContextmenu', hotspot);\n        });\n    }\n\n    pressed(e) {\n        this.pickHotspot(e, (hotspot) => {\n            this.trigger('hotspotPressed', hotspot);\n        });\n    }\n}\n\nMicroEvent.mixin(Viewer);\n\nexport default Viewer;\n","import {request} from '../core';\nimport Viewer from './viewer';\n\nexport default class Bootstrapper {\n    constructor(options = {}) {\n        this.options = options;\n    }\n\n    createViewer(data, viewerOptions) {\n        return new Viewer(this.options.el, {\n            id: this.options.id,\n            ownedBy: data.details.dealer_id,\n            color: '#' + data.details.branding.pageflip.color,\n            hotspotRatio: data.details.dimensions.height,\n            keyboard: true,\n            pageId: this.options.pageId,\n            eventTracker: this.options.eventTracker,\n            pages: this.transformPages(data.pages),\n            ...viewerOptions\n        });\n    }\n\n    transformPages(pages) {\n        return pages.map((page, i) => {\n            const pageNumber = i + 1;\n\n            return {\n                id: 'page' + pageNumber,\n                label: pageNumber + '',\n                pageNumber,\n                images: {\n                    medium: page.view,\n                    large: page.zoom\n                }\n            };\n        });\n    }\n\n    applyHotspots(viewer, hotspots) {\n        const obj = {};\n\n        hotspots.forEach((hotspot) => (obj[hotspot.id] = hotspot));\n\n        viewer.applyHotspots(obj);\n    }\n\n    async fetch(callback) {\n        try {\n            const [details, pages] = await Promise.all([\n                this.fetchDetails(),\n                this.fetchPages()\n            ]);\n\n            if (details && pages) {\n                callback(null, {details, pages});\n            } else {\n                throw new Error();\n            }\n        } catch (error) {\n            callback(error);\n        }\n    }\n\n    fetchDetails = (callback) =>\n        request({url: `/v2/catalogs/${this.options.id}`}, callback);\n\n    fetchPages = (callback) =>\n        request({url: `/v2/catalogs/${this.options.id}/pages`}, callback);\n\n    fetchHotspots = (callback) =>\n        request({url: `/v2/catalogs/${this.options.id}/hotspots`}, callback);\n}\n","const prefixKey = 'sgn-';\n\nconst storage = (() => {\n    try {\n        const storage = window.sessionStorage;\n\n        storage[`${prefixKey}test-storage`] = 'foobar';\n        delete storage[`${prefixKey}test-storage`];\n\n        return storage;\n    } catch (error) {\n        return {};\n    }\n})();\n\nexport function get(key) {\n    try {\n        return JSON.parse(storage[`${prefixKey}${key}`]);\n    } catch (error) {}\n}\n\nexport function set(key, value) {\n    try {\n        storage[`${prefixKey}${key}`] = JSON.stringify(value);\n    } catch (error) {}\n}\n","import * as Core from './core';\nimport * as CoreKit from './kits/core';\nimport * as CoreUIKit from './kits/core-ui';\nimport * as EventsKit from './kits/events';\nimport * as IncitoPublicationKit from './kits/incito-publication';\nimport * as PagedPublicationKit from './kits/paged-publication';\nimport * as clientCookie from './storage/client-cookie';\nimport * as clientLocal from './storage/client-local';\nimport * as clientSession from './storage/client-session';\nimport {error, isBrowser} from './util';\n\nconst SGN = {...Core};\n\n// Expose storage backends.\nSGN.storage = {\n    local: clientLocal,\n    session: clientSession,\n    cookie: clientCookie\n};\n\n// Expose the different kits.\nSGN.EventsKit = EventsKit;\nSGN.CoreKit = CoreKit;\nSGN.PagedPublicationKit = PagedPublicationKit;\nSGN.IncitoPublicationKit = IncitoPublicationKit;\nSGN.CoreUIKit = CoreUIKit;\n\n// Set the core session from the cookie store if possible.\nconst session = SGN.storage.cookie.get('session');\n\nif (typeof session === 'object') {\n    SGN.config.set({\n        coreSessionToken: session.token,\n        coreSessionClientId: session.client_id\n    });\n}\n\nSGN.config.bind('change', (changedAttributes) => {\n    const newEventTracker = changedAttributes.eventTracker;\n    const newAppKey = changedAttributes.appKey;\n    if (\n        (newAppKey || newEventTracker) &&\n        (newEventTracker || SGN.config.get('eventTracker'))?.trackId ===\n            (newAppKey || SGN.config.get('appKey'))\n    ) {\n        throw error(\n            new Error(\n                'Track identifier must not be identical to app key. Go to https://shopgun.com/developers/apps to get a track identifier for your app'\n            )\n        );\n    }\n\n    if (newEventTracker != null) {\n        // default eventsTrackUrl\n        if (!newEventTracker.eventsTrackUrl) {\n            newEventTracker.setEventsTrackUrl(SGN.config.get('eventsTrackUrl'));\n        }\n    }\n\n    const newEventsTrackUrl = changedAttributes.eventsTrackUrl;\n    if (newEventsTrackUrl && SGN.config.get('eventTracker')) {\n        SGN.config.get('eventTracker').setEventsTrackUrl(newEventsTrackUrl);\n    }\n});\n\nif (isBrowser()) {\n    // Autoconfigure the SDK.\n    const scriptEl = document.getElementById('sgn-sdk');\n\n    if (scriptEl) {\n        const appKey = scriptEl.getAttribute('data-app-key');\n        const trackId = scriptEl.getAttribute('data-track-id');\n        const config = {};\n\n        if (appKey) {\n            config.appKey = appKey;\n        }\n        if (trackId) {\n            config.eventTracker = new SGN.EventsKit.Tracker({trackId});\n        }\n\n        SGN.config.set(config);\n    }\n}\n\nexport default SGN;\n"],"names":["Config","config","changedAttributes","key","value","_includesInstanceProperty","attrs","trigger","option","prototype","keys","MicroEvent","mixin","locale","coreUrl","eventsTrackUrl","pairs","t","view","template","Mustache","render","update","translations","isBrowser","window","document","isNode","process","error","err","options","message","code","name","stack","time","Date","uuid","replace","c","r","Math","random","v","toString","getQueryParam","field","url","href","location","reg","RegExp","string","exec","undefined","getRandomNumberBetween","from","to","floor","getOS","ua","navigator","userAgent","_indexOfInstanceProperty","getDeviceCategory","deviceCategory","platform","test","getPointer","pointer","matchMedia","matches","getOrientation","width","height","getScreenDimensions","density","devicePixelRatio","logical","screen","physical","round","getUtcOffsetSeconds","now","jan1","getFullYear","tmp","toGMTString","jan2","substring","_lastIndexOfInstanceProperty","stdTimeOffset","getUtcDstOffsetSeconds","getTimezoneOffset","getColorBrightness","color","hex","_parseInt","rgb","sum","x","s","btoa","str","buffer","Buffer","chunk","arr","size","results","length","push","_spliceInstanceProperty","throttle","fn","threshold","scope","last","deferTimer","context","getTime","args","arguments","clearTimeout","_setTimeout","apply","loadImage","src","callback","img","Image","onload","onerror","Error","distance","lat1","lng1","lat2","lng2","radlat1","PI","radlat2","theta","radtheta","dist","sin","cos","acos","promiseCallbackInterop","fun","cbParameterIndex","makePromise","parameters","resolve","reject","neoCallback","result","callParameters","i","end","max","asc","set","configDefaults","prefixKey","get","ca","cookie","split","ct","_trimInstanceProperty","JSON","parse","days","date","_JSON$stringify","setTime","toUTCString","callbackQueue","renewed","ttl","saveToken","token","SGN","coreSessionToken","saveCookie","saveClientId","clientId","coreSessionClientId","clientCookieStorage","client_id","create","req","fetch","method","then","response","json","status","catch","headers","appSecret","sign","renew","ensure","queueCount","complete","_filterInstanceProperty","sha256","join","request","secondTime","appKey","appVersion","qs","geo","geolocation","body","r_locale","api_av","latitude","r_lat","longitude","r_lng","radius","r_radius","sensor","r_sensor","_Object$keys","params","_mapInstanceProperty","k","_Array$isArray","val","encodeURIComponent","responseToken","statusCode","_matcher","_level","_id","_handlers","_gatorInstances","_addEvent","gator","type","useCapture","element","addEventListener","_cancel","e","preventDefault","stopPropagation","_getMatcher","webkitMatchesSelector","mozMatchesSelector","msMatchesSelector","oMatchesSelector","Gator","matchesSelector","_matchesSelector","selector","boundElement","call","parentNode","_addHandler","event","id","_removeHandler","hasOwnProperty","_handleEvent","target","srcElement","match","j","matchesEvent","cancelBubble","cancel","_bind","events","remove","Array","_getGlobalCallback","addEvent","on","off","module","exports","minWidth","maxWidth","anchorEl","contentEl","resize","_bindInstanceProperty","elInner","createElement","className","el","setAttribute","appendChild","position","offsetWidth","show","removeEventListener","removeChild","rect","getBoundingClientRect","top","pageYOffset","offsetHeight","left","pageXOffset","style","rightAligned","outerWidth","right","ESC","ARROW_RIGHT","ARROW_LEFT","SPACE","NUMBER_ONE","defaultTemplate","Popover","keyUp","scroll","backgroundEl","header","singleChoiceItems","item","index","innerHTML","addEventListeners","y","menuEl","querySelector","parentWidth","parentHeight","boundingRect","getAttribute","destroy","keyCode","keyCodes","singleChoicePopover","ctx","items","popover","focus","storage","localStorage","createTrackerClient","clientLocalStorage","data","getPool","evt","_i","pool","Tracker","defaultOptions","client","defaultEventsTrackUrl","geohash","country","dispatching","hasMadeInitialDispatch","dispatch","properties","version","trackId","_Object$assign","_e","_v","_t","_a","poolLimit","shift","Object","trackEvent","parts","_concatInstanceProperty","viewToken","String","fromCharCode","_sliceInstanceProperty","md5","asBytes","dispatchLimit","ship","timeout","dispatchRetryInterval","_dispatch","nacks","clearInterval","resEvent","poolEvent","console","warn","_setInterval","IncitoPublicationEventTracking","eventTracker","details","trackIncitoPublicationOpened","types","vt","createViewToken","Viewer","incito","Incito","renderLaziness","_eventTracking","EventTracking","start","classList","add","trackOpened","viewer","progressEl","isScrolling","textContent","winHeight","innerHeight","progress","min","abs","scrollTimeout","Bootstrapper","fetchDetails","pixelRatio","getPixelRatio","orientation","getLocale","getMaxWidth","featureLabels","getFeatureLabels","versionsSupported","toISOString","localeChain","languages","language","browserLanguage","prefLocale","count","vector","_reduceInstanceProperty","acc","cur","featureLabel","fetchIncito","incito_publication_id","err1","res","Accept","device_category","pixel_ratio","max_width","versions_supported","locale_code","feature_labels","anonymizeFeatureLabels","Controls","self","PagedPublicationControls","beforeNavigation","prevClicked","nextClicked","closeClicked","keyDown","els","root","progressBar","progressLabel","prevControl","nextControl","close","keyDownHandler","keyboard","showProgress","visibilityClassName","verso","newPosition","pageSpreadCount","duration","PagedPublicationPageSpread","contentsRendered","hotspotsRendered","renderEl","pages","pageIds","getPages","page","getId","maxZoomScale","getEl","pageCount","imageLoads","maxPageWidth","clientWidth","pageMode","useLargeImage","image","images","medium","large","pageEl","loaderEl","label","isComplete","backgroundImage","pageSpreadId","pageEls","querySelectorAll","_findInstanceProperty","_Array$from","removeAttribute","PagedPublicationPageSpreads","collection","ids","frag","createDocumentFragment","pageSpread","pageSpreads","firstPage","lastPage","pop","midstPageSpreads","midstPages","PageSpread","PagedPublicationCore","afterNavigation","attemptedNavigation","clicked","doubleClicked","pressed","contextmenu","panStart","panEnd","zoomedIn","zoomedOut","unload","makeOptions","defaults","pageId","getOption","getPageMode","PageSpreads","pageLoaded","pagesLoaded","setColor","insertBefore","getFrag","createVerso","getVerso","overridePageSpreadContentRect","resizeListener","pageSpreadEls","backgroundColor","pageSpreadEl","opts","Verso","bottom","getPageEls","scale","transform","pageWidth","pageHeight","imageRatio","actualHeight","actualWidth","clientRect","pageLabels","visibility","getVisibility","renderContents","clearContents","theVerso","versoPageSpread","getPageSpreadFromPosition","getPageSpreadCount","newSpreadEl","formatProgressLabel","renderPageSpreads","resetIdleTimer","startIdleTimer","newPositionIsEnd","isInsideContent","findPage","zoomIn","zoomOut","idleTimeout","getPosition","getPageIds","refresh","navigateTo","getPageSpreadPositionFromPageId","getType","getContentRect","switchPageMode","pageSpreadWidth","pageSpreadMaxZoomScale","idleDelay","resizeDelay","PagedPublicationEventTracking","hidden","appeared","disappeared","pageSpreadDisappeared","trackPagedPublicationOpened","pageNumbers","pageNumber","trackPagedPublicationPageDisappeared","pageSpreadAppeared","trackPageSpreadDisappeared","PagedPublicationHotspots","currentPageSpreadId","pageSpreadsLoaded","cache","hotspotsReceived","resized","contentRect","hotspotEls","hotspotEl","hotspots","hotspot","ratio","renderHotspot","minX","minY","maxX","maxY","locations","coords","setCache","renderHotspots","requestHotspots","getCache","defaultPickHotspot","title","offer","heading","subtitle","pricing","currency","price","picked","_core","Core","_hotspots","Hotspots","_controls","viewSession","hotspotQueue","_setupEventListeners","navigateToIndex","first","prev","next","hotspotsRequested","overlayEls","overlayEl","pickHotspot","hotspotRequest","hotspotRatio","processHotspotQueue","viewerOptions","ownedBy","dealer_id","branding","pageflip","dimensions","transformPages","zoom","obj","applyHotspots","_Promise","all","fetchPages","sessionStorage","local","clientLocal","session","clientSession","clientCookie","EventsKit","CoreKit","PagedPublicationKit","IncitoPublicationKit","CoreUIKit","newEventTracker","newAppKey","setEventsTrackUrl","newEventsTrackUrl","scriptEl","getElementById"],"mappings":"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"}