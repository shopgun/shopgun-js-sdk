{"version":3,"file":"sgn-sdk.es.js","sources":["../lib/config.js","../lib/configDefaults.js","../lib/translations.js","../lib/util.js","../lib/core.js","../lib/storage/client-cookie.js","../lib/kits/core/session.js","../lib/kits/core/request.js","../vendor/gator.js","../lib/kits/core-ui/offer-details.js","../lib/key-codes.js","../lib/kits/core-ui/popover.js","../lib/kits/core-ui/single-choice-popover.js","../lib/kits/core-ui/index.js","../lib/storage/client-local.js","../lib/kits/events/tracker.js","../lib/kits/incito-publication/event-tracking.js","../lib/kits/incito-publication/viewer.js","../lib/kits/incito-publication/controls.js","../lib/kits/incito-publication/bootstrapper.js","../lib/kits/paged-publication/controls.js","../lib/kits/paged-publication/page-spread.js","../lib/kits/paged-publication/page-spreads.js","../lib/kits/paged-publication/core.js","../lib/kits/paged-publication/event-tracking.js","../lib/kits/paged-publication/hotspots.js","../lib/kits/paged-publication/viewer.js","../lib/kits/paged-publication/bootstrapper.js","../lib/storage/client-session.js","../lib/index.js"],"sourcesContent":["import MicroEvent from 'microevent';\n\nclass Config {\n    attrs = {};\n\n    set(config = {}) {\n        const changedAttributes = {};\n\n        for (let key in config) {\n            const value = config[key];\n            if (this.keys.includes(key)) {\n                this.attrs[key] = value;\n                changedAttributes[key] = value;\n            }\n        }\n\n        this.trigger('change', changedAttributes);\n    }\n\n    get(option) {\n        return this.attrs[option];\n    }\n}\nConfig.prototype.keys = [\n    'appVersion',\n    'appKey',\n    'appSecret',\n    'authToken',\n    'eventTracker',\n    'locale',\n    'coreSessionToken',\n    'coreSessionClientId',\n    'coreUrl',\n    'eventsTrackUrl'\n];\n\nMicroEvent.mixin(Config);\n\nexport default Config;\n","export const locale = 'en_US';\nexport const coreUrl = 'https://squid-api.tjek.com';\nexport const eventsTrackUrl = 'https://wolf-api.tjek.com/sync';\n","import Mustache from 'mustache';\nconst pairs = {\n    'paged_publication.hotspot_picker.header': 'Which offer did you mean?',\n    'incito_publication.product_picker.header': 'Which product?'\n};\n\nexport function t(key, view) {\n    const template = pairs[key] ?? '';\n\n    return Mustache.render(template, view);\n}\n\nexport function update(translations) {\n    for (let key in translations) {\n        const value = translations[key];\n        pairs[key] = value;\n    }\n}\n","export function isBrowser() {\n    return typeof window === 'object' && typeof document === 'object';\n}\n\nexport function isNode() {\n    return typeof process === 'object';\n}\n\nexport function error(err, options) {\n    err.message = err.message || null;\n\n    if (typeof options === 'string') {\n        err.message = options;\n    } else if (typeof options === 'object' && options != null) {\n        for (let key in options) {\n            const value = options[key];\n            err[key] = value;\n        }\n\n        if (options.message != null) {\n            err.message = options.message;\n        }\n        if (options.code != null || options.message != null) {\n            err.code = options.code || options.name;\n        }\n        if (options.stack != null) {\n            err.stack = options.stack;\n        }\n    }\n\n    err.name = options?.name || err.name || err.code || 'Error';\n    err.time = new Date();\n\n    return err;\n}\n\nexport function uuid() {\n    return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, (c) => {\n        const r = (Math.random() * 16) | 0;\n        const v = c === 'x' ? r : (r & 0x3) | 0x8;\n\n        return v.toString(16);\n    });\n}\n\nexport function getQueryParam(field, url) {\n    const href = url || window.location.href;\n    const reg = new RegExp('[?&]' + field + '=([^&#]*)', 'i');\n    const string = reg.exec(href);\n\n    if (string) {\n        return string[1];\n    }\n    return undefined;\n}\n\nexport function getRandomNumberBetween(from, to) {\n    return Math.floor(Math.random() * to) + from;\n}\n\nexport function getOS() {\n    let name = null;\n    const ua = window.navigator.userAgent;\n\n    if (ua.indexOf('Windows') > -1) {\n        name = 'Windows';\n    } else if (ua.indexOf('Mac') > -1) {\n        name = 'macOS';\n    } else if (ua.indexOf('X11') > -1) {\n        name = 'unix';\n    } else if (ua.indexOf('Linux') > -1) {\n        name = 'Linux';\n    } else if (ua.indexOf('iOS') > -1) {\n        name = 'iOS';\n    } else if (ua.indexOf('Android') > -1) {\n        name = 'Android';\n    }\n\n    return name;\n}\n\nexport function getDeviceCategory() {\n    let deviceCategory = 'desktop';\n\n    if (navigator.platform === 'iPod' || navigator.platform === 'iPhone') {\n        deviceCategory = 'mobile';\n    } else if (navigator.platform === 'iPad') {\n        deviceCategory = 'tablet';\n    } else if (\n        navigator.platform === 'Android' ||\n        /android/gi.test(navigator.userAgent)\n    ) {\n        if (/tablet/gi.test(navigator.userAgent)) {\n            deviceCategory = 'tablet';\n        } else {\n            deviceCategory = 'mobile';\n        }\n    }\n\n    return deviceCategory;\n}\n\nexport function getPointer() {\n    let pointer = 'fine';\n\n    if (matchMedia('(pointer:coarse)').matches) {\n        pointer = 'coarse';\n    }\n\n    return pointer;\n}\n\nexport function getOrientation(width, height) {\n    if (width === height) {\n        return 'quadratic';\n    } else if (width > height) {\n        return 'horizontal';\n    } else {\n        return 'vertical';\n    }\n}\n\nexport function getScreenDimensions() {\n    const density = window.devicePixelRatio ?? 1;\n    const logical = {\n        width: window.screen.width,\n        height: window.screen.height\n    };\n    const physical = {\n        width: Math.round(logical.width * density),\n        height: Math.round(logical.height * density)\n    };\n\n    return {\n        density,\n        logical,\n        physical\n    };\n}\n\nexport function getUtcOffsetSeconds() {\n    const now = new Date();\n    const jan1 = new Date(now.getFullYear(), 0, 1, 0, 0, 0, 0);\n    const tmp = jan1.toGMTString();\n    const jan2 = new Date(tmp.substring(0, tmp.lastIndexOf(' ') - 1));\n    const stdTimeOffset = (jan1 - jan2) / 1000;\n\n    return stdTimeOffset;\n}\n\nexport function getUtcDstOffsetSeconds() {\n    return new Date().getTimezoneOffset() * 60 * -1;\n}\n\nexport function getColorBrightness(color) {\n    color = color.replace('#', '');\n    var hex = parseInt((hex + '').replace(/[^a-f0-9]/gi, ''), 16);\n    const rgb = [];\n    let sum = 0;\n    let x = 0;\n\n    while (x < 3) {\n        const s = parseInt(color.substring(2 * x, 2), 16);\n        rgb[x] = s;\n\n        if (s > 0) {\n            sum += s;\n        }\n\n        ++x;\n    }\n\n    if (sum <= 381) {\n        return 'dark';\n    } else {\n        return 'light';\n    }\n}\n\nexport function btoa(str) {\n    if (isBrowser()) {\n        return window.btoa(str);\n    } else {\n        let buffer = null;\n\n        if (str instanceof Buffer) {\n            buffer = str;\n        } else {\n            buffer = Buffer.from(str.toString(), 'binary');\n        }\n\n        return buffer.toString('base64');\n    }\n}\n\nexport function chunk(arr, size) {\n    const results = [];\n\n    while (arr.length) {\n        results.push(arr.splice(0, size));\n    }\n\n    return results;\n}\n\nexport function throttle(fn, threshold = 250, scope) {\n    let last = undefined;\n    let deferTimer = undefined;\n\n    return function () {\n        const context = scope || this;\n        const now = new Date().getTime();\n        const args = arguments;\n\n        if (last && now < last + threshold) {\n            clearTimeout(deferTimer);\n\n            deferTimer = setTimeout(() => {\n                last = now;\n\n                fn.apply(context, args);\n            }, threshold);\n        } else {\n            last = now;\n            fn.apply(context, args);\n        }\n    };\n}\n\nexport function loadImage(src, callback) {\n    const img = new Image();\n\n    img.onload = () => callback(null, img.width, img.height);\n    img.onerror = () => callback(new Error());\n    img.src = src;\n\n    return img;\n}\n\nexport function distance(lat1, lng1, lat2, lng2) {\n    const radlat1 = (Math.PI * lat1) / 180;\n    const radlat2 = (Math.PI * lat2) / 180;\n    const theta = lng1 - lng2;\n    const radtheta = (Math.PI * theta) / 180;\n    let dist =\n        Math.sin(radlat1) * Math.sin(radlat2) +\n        Math.cos(radlat1) * Math.cos(radlat2) * Math.cos(radtheta);\n    dist = Math.acos(dist);\n    dist = (dist * 180) / Math.PI;\n    dist = dist * 60 * 1.1515;\n    dist = dist * 1.609344 * 1000;\n\n    return dist;\n}\n\n// Method for wrapping a function that takes a callback in any position\n// to return promises if no callback is given in a call.\n// The second argument, cbParameterIndex, is the position of the callback in the original functions parameter list.\n// CoffeeScript optional parameters messes with this function arity detection,\n// not sure what to do about that, other than always setting cbParameterIndex at callsites.\nexport function promiseCallbackInterop(fun, cbParameterIndex = fun.length - 1) {\n    // This is the function that actually wraps and calls a method to return a promise.\n    const makePromise = (fun, cbParameterIndex, parameters) =>\n        new Promise((resolve, reject) => {\n            const neoCallback = (error, result) => {\n                if (error) {\n                    return reject(error);\n                }\n                return resolve(result);\n            };\n\n            const callParameters = [];\n            for (\n                let i = 0,\n                    end = Math.max(parameters.length, cbParameterIndex) + 1,\n                    asc = 0 <= end;\n                asc ? i < end : i > end;\n                asc ? i++ : i--\n            ) {\n                callParameters.push(\n                    i === cbParameterIndex ? neoCallback : parameters[i]\n                );\n            }\n\n            return fun.apply(this, callParameters);\n        });\n    // Wrapper function that decides what to do per-call.\n    return (...parameters) => {\n        if (typeof parameters[cbParameterIndex] === 'function') {\n            // Callback given, do a regular old call.\n            return fun.apply(null, parameters);\n        } else if (typeof Promise === 'function') {\n            // No callback given, and we have promise support, use makePromise to wrap the call.\n            return makePromise(fun, cbParameterIndex, parameters);\n        } else {\n            // Ain't got callback, ain't got promise support; we gotta tell the developer.\n            throw new Error(`To be able to use this asynchronous method you should:\nSupply a callback function as argument #${1 + cbParameterIndex}.\nThis callback function will be called with the method call response.\nAlternatively, when supported, it can return a Promise if no callback function is given.\\\n`);\n        }\n    };\n}\n","import Config from './config';\nimport * as configDefaults from './configDefaults';\nexport * as translations from './translations';\nexport * as util from './util';\nexport const config = new Config();\n\n// Set default values.\nconfig.set(configDefaults);\n","import {isNode} from '../util';\n\nconst prefixKey = 'sgn-';\n\nexport function get(key) {\n    let value;\n    if (isNode()) {\n        return;\n    }\n\n    try {\n        const name = `${prefixKey}${key}=`;\n        const ca = document.cookie.split(';');\n\n        ca.forEach((c) => {\n            const ct = c.trim();\n\n            if (ct.indexOf(name) === 0) {\n                value = ct.substring(name.length, ct.length);\n            }\n        });\n\n        value = JSON.parse(value);\n    } catch (err) {\n        value = {};\n    }\n\n    return value;\n}\n\nexport function set(key, value) {\n    if (isNode()) {\n        return;\n    }\n\n    try {\n        const days = 365;\n        const date = new Date();\n        const str = JSON.stringify(value);\n\n        date.setTime(date.getTime() + days * 24 * 60 * 60 * 1000);\n\n        document.cookie = `${prefixKey}${key}=${str};expires=${date.toUTCString()};path=/`;\n    } catch (err) {}\n}\n","import fetch from 'cross-fetch';\nimport sha256 from 'sha256';\nimport SGN from '../../sgn';\nimport * as clientCookieStorage from '../../storage/client-cookie';\nlet callbackQueue = [];\nlet renewed = false;\n\nconst ttl = 1 * 60 * 60 * 24 * 60;\n\nexport function saveToken(token) {\n    if (!token) {\n        throw new Error('No token provided for saving');\n    }\n\n    SGN.config.set({coreSessionToken: token});\n\n    saveCookie();\n}\n\nexport function saveClientId(clientId) {\n    SGN.config.set({coreSessionClientId: clientId});\n\n    saveCookie();\n}\n\nexport function saveCookie() {\n    clientCookieStorage.set('session', {\n        token: SGN.config.get('coreSessionToken'),\n        client_id: SGN.config.get('coreSessionClientId')\n    });\n}\n\nexport function create(callback) {\n    const key = SGN.config.get('appKey');\n\n    const req = fetch(\n        SGN.config.get('coreUrl') +\n            `/v2/sessions?api_key=${key}&token_ttl=${ttl}`,\n        {method: 'post'}\n    );\n\n    req.then((response) =>\n        response.json().then((json) => {\n            if (response.status === 201) {\n                saveToken(json.token);\n                saveClientId(json.client_id);\n\n                callback(null, json);\n            } else {\n                callback(new Error('Could not create session'));\n            }\n        })\n    ).catch((err) => {\n        callback(err);\n    });\n}\n\nexport function update(callback) {\n    const headers = {};\n    const token = SGN.config.get('coreSessionToken');\n    const appSecret = SGN.config.get('appSecret');\n\n    headers['X-Token'] = token;\n    if (appSecret != null) {\n        headers['X-Signature'] = sign(appSecret, token);\n    }\n\n    const req = fetch(SGN.config.get('coreUrl') + '/v2/sessions', {\n        method: 'put',\n        headers\n    });\n\n    req.then((response) =>\n        response.json().then((json) => {\n            if (response.status === 200) {\n                saveToken(json.token);\n                saveClientId(json.client_id);\n\n                callback(null, json);\n            } else {\n                callback(new Error('Could not update session'));\n            }\n        })\n    ).catch((err) => {\n        callback(err);\n    });\n}\n\nexport function renew(callback) {\n    const headers = {};\n    const token = SGN.config.get('coreSessionToken');\n    const appSecret = SGN.config.get('appSecret');\n\n    headers['X-Token'] = token;\n    if (appSecret) {\n        headers['X-Signature'] = sign(appSecret, token);\n    }\n\n    const req = fetch(SGN.config.get('coreUrl') + '/v2/sessions', {\n        method: 'put',\n        headers\n    });\n\n    req.then((response) =>\n        response.json().then((json) => {\n            if (response.status === 200) {\n                saveToken(json.token);\n                saveClientId(json.client_id);\n\n                callback(null, json);\n            } else {\n                callback(new Error('Could not renew session'));\n            }\n        })\n    ).catch((err) => {\n        callback(err);\n    });\n}\n\nexport function ensure(callback) {\n    const queueCount = callbackQueue.length;\n    const complete = (err) => {\n        callbackQueue = callbackQueue.filter((fn) => {\n            fn(err);\n\n            return false;\n        });\n    };\n\n    callbackQueue.push(callback);\n\n    if (queueCount === 0) {\n        if (SGN.config.get('coreSessionToken') == null) {\n            create(complete);\n        } else if (renewed === false) {\n            renewed = true;\n            renew((err) => {\n                if (err != null) {\n                    create(complete);\n                } else {\n                    complete();\n                }\n            });\n        } else {\n            complete();\n        }\n    }\n}\n\nexport function sign(appSecret, token) {\n    return sha256([appSecret, token].join(''));\n}\n","import fetch from 'cross-fetch';\nimport SGN from '../../sgn';\nimport {error, promiseCallbackInterop} from '../../util';\nimport {ensure, saveToken, sign} from './session';\n\nfunction request(options = {}, callback, secondTime) {\n    ensure((err) => {\n        if (err != null) {\n            return callback(err);\n        }\n\n        let url = SGN.config.get('coreUrl') + (options.url ?? '');\n        const headers = options.headers ?? {};\n        const json = typeof options.json === 'boolean' ? options.json : true;\n        let token = SGN.config.get('coreSessionToken');\n        const appKey = SGN.config.get('appKey');\n        const appVersion = SGN.config.get('appVersion');\n        const appSecret = SGN.config.get('appSecret');\n        const locale = SGN.config.get('locale');\n        const qs = options.qs ?? {};\n        const geo = options.geolocation;\n        let {body} = options;\n\n        headers['X-Api-Key'] = appKey;\n        headers['X-Token'] = token;\n        if (appSecret != null) {\n            headers['X-Signature'] = sign(appSecret, token);\n        }\n\n        if (json) {\n            headers['Content-Type'] = 'application/json';\n            headers['Accept'] = 'application/json';\n\n            if (body) {\n                body = JSON.stringify(body);\n            }\n        }\n\n        if (locale != null) {\n            qs.r_locale = locale;\n        }\n        if (appVersion != null) {\n            qs.api_av = appVersion;\n        }\n\n        if (geo != null) {\n            if (geo.latitude != null && qs.r_lat == null) {\n                qs.r_lat = geo.latitude;\n            }\n            if (geo.longitude != null && qs.r_lng == null) {\n                qs.r_lng = geo.longitude;\n            }\n            if (geo.radius != null && qs.r_radius == null) {\n                qs.r_radius = geo.radius;\n            }\n            if (geo.sensor != null && qs.r_sensor == null) {\n                qs.r_sensor = geo.sensor;\n            }\n        }\n\n        if (Object.keys(qs).length) {\n            const params = Object.keys(qs)\n                .map((k) => {\n                    if (Array.isArray(k)) {\n                        return qs[k]\n                            .map(\n                                (val) =>\n                                    `${encodeURIComponent(\n                                        k\n                                    )}[]=${encodeURIComponent(val)}`\n                            )\n                            .join('&');\n                    }\n\n                    return `${encodeURIComponent(k)}=${encodeURIComponent(\n                        qs[k]\n                    )}`;\n                })\n                .join('&');\n\n            url += '?' + params;\n        }\n\n        const req = fetch(url, {\n            method: options.method,\n            body,\n            headers\n        });\n\n        return req\n            .then((response) =>\n                response.json().then((json) => {\n                    token = SGN.config.get('coreSessionToken');\n                    const responseToken = response.headers.get('x-token');\n\n                    if (responseToken && token !== responseToken) {\n                        saveToken(responseToken);\n                    }\n\n                    if (\n                        (response.status >= 200 && response.status < 300) ||\n                        response.status === 304\n                    ) {\n                        callback(null, json);\n                    } else {\n                        if (\n                            secondTime !== true &&\n                            [1101, 1107, 1108].includes(json?.code)\n                        ) {\n                            SGN.config.set({coreSessionToken: undefined});\n\n                            request(options, callback, true);\n                        } else {\n                            callback(\n                                error(new Error('Core API error'), {\n                                    code: 'CoreAPIError',\n                                    statusCode: response.status\n                                }),\n                                json\n                            );\n                        }\n                    }\n                })\n            )\n            .catch(callback);\n    });\n}\n\nexport default promiseCallbackInterop(request, 1);\n","/**\n * Copyright 2014 Craig Campbell\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n *\n * GATOR.JS\n * Simple Event Delegation\n *\n * @version 1.2.4\n *\n * Compatible with IE 9+, FF 3.6+, Safari 5+, Chrome\n *\n * Include legacy.js for compatibility with older browsers\n *\n *             .-._   _ _ _ _ _ _ _ _\n *  .-''-.__.-'00  '-' ' ' ' ' ' ' ' '-.\n * '.___ '    .   .--_'-' '-' '-' _'-' '._\n *  V: V 'vv-'   '_   '.       .'  _..' '.'.\n *    '=.____.=_.--'   :_.__.__:_   '.   : :\n *            (((____.-'        '-.  /   : :\n *                              (((-'\\ .' /\n *                            _____..'  .'\n *                           '-._____.-'\n */\nvar _matcher,\n  _level = 0,\n  _id = 0,\n  _handlers = {},\n  _gatorInstances = {};\n\nfunction _addEvent(gator, type, callback) {\n  // blur and focus do not bubble up but if you use event capturing\n  // then you will get them\n  var useCapture = type == \"blur\" || type == \"focus\";\n  gator.element.addEventListener(type, callback, useCapture);\n}\n\nfunction _cancel(e) {\n  e.preventDefault();\n  e.stopPropagation();\n}\n\n/**\n     * returns function to use for determining if an element\n     * matches a query selector\n     *\n     * @returns {Function}\n     */\nfunction _getMatcher(element) {\n  if (_matcher) {\n    return _matcher;\n  }\n\n  if (element.matches) {\n    _matcher = element.matches;\n    return _matcher;\n  }\n\n  if (element.webkitMatchesSelector) {\n    _matcher = element.webkitMatchesSelector;\n    return _matcher;\n  }\n\n  if (element.mozMatchesSelector) {\n    _matcher = element.mozMatchesSelector;\n    return _matcher;\n  }\n\n  if (element.msMatchesSelector) {\n    _matcher = element.msMatchesSelector;\n    return _matcher;\n  }\n\n  if (element.oMatchesSelector) {\n    _matcher = element.oMatchesSelector;\n    return _matcher;\n  }\n\n  // if it doesn't match a native browser method\n  // fall back to the gator function\n  _matcher = Gator.matchesSelector;\n  return _matcher;\n}\n\n/**\n     * determines if the specified element matches a given selector\n     *\n     * @param {Node} element - the element to compare against the selector\n     * @param {string} selector\n     * @param {Node} boundElement - the element the listener was attached to\n     * @returns {void|Node}\n     */\nfunction _matchesSelector(element, selector, boundElement) {\n  // no selector means this event was bound directly to this element\n  if (selector == \"_root\") {\n    return boundElement;\n  }\n\n  // if we have moved up to the element you bound the event to\n  // then we have come too far\n  if (element === boundElement) {\n    return;\n  }\n\n  // if this is a match then we are done!\n  if (_getMatcher(element).call(element, selector)) {\n    return element;\n  }\n\n  // if this element did not match but has a parent we should try\n  // going up the tree to see if any of the parent elements match\n  // for example if you are looking for a click on an <a> tag but there\n  // is a <span> inside of the a tag that it is the target,\n  // it should still work\n  if (element.parentNode) {\n    _level++;\n    return _matchesSelector(element.parentNode, selector, boundElement);\n  }\n}\n\nfunction _addHandler(gator, event, selector, callback) {\n  if (!_handlers[gator.id]) {\n    _handlers[gator.id] = {};\n  }\n\n  if (!_handlers[gator.id][event]) {\n    _handlers[gator.id][event] = {};\n  }\n\n  if (!_handlers[gator.id][event][selector]) {\n    _handlers[gator.id][event][selector] = [];\n  }\n\n  _handlers[gator.id][event][selector].push(callback);\n}\n\nfunction _removeHandler(gator, event, selector, callback) {\n  // if there are no events tied to this element at all\n  // then don't do anything\n  if (!_handlers[gator.id]) {\n    return;\n  }\n\n  // if there is no event type specified then remove all events\n  // example: Gator(element).off()\n  if (!event) {\n    for (var type in _handlers[gator.id]) {\n      if (_handlers[gator.id].hasOwnProperty(type)) {\n        _handlers[gator.id][type] = {};\n      }\n    }\n    return;\n  }\n\n  // if no callback or selector is specified remove all events of this type\n  // example: Gator(element).off('click')\n  if (!callback && !selector) {\n    _handlers[gator.id][event] = {};\n    return;\n  }\n\n  // if a selector is specified but no callback remove all events\n  // for this selector\n  // example: Gator(element).off('click', '.sub-element')\n  if (!callback) {\n    delete _handlers[gator.id][event][selector];\n    return;\n  }\n\n  // if we have specified an event type, selector, and callback then we\n  // need to make sure there are callbacks tied to this selector to\n  // begin with.  if there aren't then we can stop here\n  if (!_handlers[gator.id][event][selector]) {\n    return;\n  }\n\n  // if there are then loop through all the callbacks and if we find\n  // one that matches remove it from the array\n  for (var i = 0; i < _handlers[gator.id][event][selector].length; i++) {\n    if (_handlers[gator.id][event][selector][i] === callback) {\n      _handlers[gator.id][event][selector].splice(i, 1);\n      break;\n    }\n  }\n}\n\nfunction _handleEvent(id, e, type) {\n  if (!_handlers[id][type]) {\n    return;\n  }\n\n  var target = e.target || e.srcElement,\n    selector,\n    match,\n    matches = {},\n    i = 0,\n    j = 0;\n\n  // find all events that match\n  _level = 0;\n  for (selector in _handlers[id][type]) {\n    if (_handlers[id][type].hasOwnProperty(selector)) {\n      match = _matchesSelector(target, selector, _gatorInstances[id].element);\n\n      if (\n        match &&\n        Gator.matchesEvent(\n          type,\n          _gatorInstances[id].element,\n          match,\n          selector == \"_root\",\n          e\n        )\n      ) {\n        _level++;\n        _handlers[id][type][selector].match = match;\n        matches[_level] = _handlers[id][type][selector];\n      }\n    }\n  }\n\n  // stopPropagation() fails to set cancelBubble to true in Webkit\n  // @see http://code.google.com/p/chromium/issues/detail?id=162270\n  e.stopPropagation = function() {\n    e.cancelBubble = true;\n  };\n\n  for (i = 0; i <= _level; i++) {\n    if (matches[i]) {\n      for (j = 0; j < matches[i].length; j++) {\n        if (matches[i][j].call(matches[i].match, e) === false) {\n          Gator.cancel(e);\n          return;\n        }\n\n        if (e.cancelBubble) {\n          return;\n        }\n      }\n    }\n  }\n}\n\n/**\n     * binds the specified events to the element\n     *\n     * @param {string|Array} events\n     * @param {string} selector\n     * @param {Function} callback\n     * @param {boolean=} remove\n     * @returns {Object}\n     */\nfunction _bind(events, selector, callback, remove) {\n  // fail silently if you pass null or undefined as an alement\n  // in the Gator constructor\n  if (!this.element) {\n    return;\n  }\n\n  if (!(events instanceof Array)) {\n    events = [events];\n  }\n\n  if (!callback && typeof selector == \"function\") {\n    callback = selector;\n    selector = \"_root\";\n  }\n\n  var id = this.id,\n    i;\n\n  function _getGlobalCallback(type) {\n    return function(e) {\n      _handleEvent(id, e, type);\n    };\n  }\n\n  for (i = 0; i < events.length; i++) {\n    if (remove) {\n      _removeHandler(this, events[i], selector, callback);\n      continue;\n    }\n\n    if (!_handlers[id] || !_handlers[id][events[i]]) {\n      Gator.addEvent(this, events[i], _getGlobalCallback(events[i]));\n    }\n\n    _addHandler(this, events[i], selector, callback);\n  }\n\n  return this;\n}\n\n/**\n     * Gator object constructor\n     *\n     * @param {Node} element\n     */\nfunction Gator(element, id) {\n  // called as function\n  if (!(this instanceof Gator)) {\n    // only keep one Gator instance per node to make sure that\n    // we don't create a ton of new objects if you want to delegate\n    // multiple events from the same node\n    //\n    // for example: Gator(document).on(...\n    for (var key in _gatorInstances) {\n      if (_gatorInstances[key].element === element) {\n        return _gatorInstances[key];\n      }\n    }\n\n    _id++;\n    _gatorInstances[_id] = new Gator(element, _id);\n\n    return _gatorInstances[_id];\n  }\n\n  this.element = element;\n  this.id = id;\n}\n\n/**\n     * adds an event\n     *\n     * @param {string|Array} events\n     * @param {string} selector\n     * @param {Function} callback\n     * @returns {Object}\n     */\nGator.prototype.on = function(events, selector, callback) {\n  return _bind.call(this, events, selector, callback);\n};\n\n/**\n     * removes an event\n     *\n     * @param {string|Array} events\n     * @param {string} selector\n     * @param {Function} callback\n     * @returns {Object}\n     */\nGator.prototype.off = function(events, selector, callback) {\n  return _bind.call(this, events, selector, callback, true);\n};\n\nGator.matchesSelector = function() {};\nGator.cancel = _cancel;\nGator.addEvent = _addEvent;\nGator.matchesEvent = function() {\n  return true;\n};\n\nif (typeof module !== \"undefined\" && module.exports) {\n  module.exports = Gator;\n}\n\nif (typeof window !== \"undefined\" && window.exports) {\n  window.Gator = Gator;\n}\n","module.exports = class OfferDetails {\n    constructor({minWidth = 300, maxWidth = '100vw', anchorEl, contentEl}) {\n        this.resize = this.resize.bind(this);\n        this.minWidth = minWidth;\n        this.maxWidth = maxWidth;\n        this.anchorEl = anchorEl;\n        this.contentEl = contentEl;\n        this.elInner = document.createElement('div');\n        this.elInner.className = 'sgn-offer-details-inner';\n\n        this.el = document.createElement('div');\n\n        this.el.className = 'sgn-offer-details';\n        this.el.setAttribute('tabindex', -1);\n        this.el.appendChild(this.elInner);\n        this.el.appendChild(this.contentEl);\n\n        this.position();\n    }\n\n    appendTo(el) {\n        el.appendChild(this.el);\n\n        this.el.offsetWidth;\n\n        this.show();\n\n        return this;\n    }\n\n    show() {\n        this.el.className += ' in';\n\n        window.addEventListener('resize', this.resize, false);\n\n        return this;\n    }\n\n    destroy() {\n        window.removeEventListener('resize', this.resize, false);\n\n        this.el.parentNode.removeChild(this.el);\n    }\n\n    position() {\n        const rect = this.anchorEl.getBoundingClientRect();\n        const top = window.pageYOffset + rect.top + this.anchorEl.offsetHeight;\n        let left = window.pageXOffset + rect.left;\n        const width = this.anchorEl.offsetWidth;\n\n        this.el.style.top = top + 'px';\n\n        const rightAligned = rect.left >= window.outerWidth / 2;\n        left = window.pageXOffset + rect.left;\n        const right = window.pageXOffset + (window.outerWidth - rect.right);\n\n        if (rightAligned) {\n            this.el.style.left = 'auto';\n            this.el.style.right = right + 'px';\n\n            this.elInner.style.left = 'auto';\n            this.elInner.style.right = 0;\n        } else {\n            this.el.style.left = left + 'px';\n            this.el.style.right = 'auto';\n\n            this.elInner.style.left = 0;\n            this.elInner.style.right = 'auto';\n        }\n\n        this.el.style.minWidth =\n            typeof this.minWidth === 'number'\n                ? Math.max(width, this.minWidth) + 'px'\n                : this.minWidth;\n        this.el.style.maxWidth = this.maxWidth;\n\n        this.elInner.style.width = width - 8 + 'px';\n    }\n\n    resize() {\n        this.position();\n    }\n};\n","export const ESC = 27;\nexport const ARROW_RIGHT = 39;\nexport const ARROW_LEFT = 37;\nexport const SPACE = 32;\nexport const NUMBER_ONE = 49;\n","import MicroEvent from 'microevent';\nimport Mustache from 'mustache';\nimport Gator from '../../../vendor/gator';\nimport * as keyCodes from '../../key-codes';\n\nconst defaultTemplate = `\\\n<div class=\"sgn-popover__background\" data-close></div>\n<div class=\"sgn-popover__menu\">\n    {{#header}}\n        <div class=\"sgn-popover__header\">{{header}}</div>\n    {{/header}}\n    <div class=\"sgn-popover__content\">\n        <ul>\n            {{#singleChoiceItems}}\n                <li data-index=\"{{index}}\">\n                    <p class=\"sgn-popover-item__title\">{{item.title}}</p>\n                    {{#item.subtitle}}\n                        <p class=\"sgn-popover-item__subtitle\">{{item.subtitle}}</p>\n                    {{/item.subtitle}}\n                </li>\n            {{/singleChoiceItems}}\n        </ul>\n    </div>\n</div>\\\n`;\n\nclass Popover {\n    constructor(options = {}) {\n        this.keyUp = this.keyUp.bind(this);\n        this.resize = this.resize.bind(this);\n        this.scroll = this.scroll.bind(this);\n        this.options = options;\n        this.el = document.createElement('div');\n        this.backgroundEl = document.createElement('div');\n    }\n\n    render() {\n        const {\n            header,\n            singleChoiceItems,\n            template = defaultTemplate\n        } = this.options;\n\n        const view = {\n            header,\n            singleChoiceItems: singleChoiceItems?.map((item, index) => ({\n                item,\n                index\n            }))\n        };\n\n        this.el.className = 'sgn-popover';\n        this.el.setAttribute('tabindex', -1);\n        this.el.innerHTML = Mustache.render(template, view);\n\n        this.position();\n        this.addEventListeners();\n\n        return this;\n    }\n\n    destroy() {\n        Gator(this.el).off();\n\n        window.removeEventListener('resize', this.resize, false);\n        window.removeEventListener('scroll', this.scroll, false);\n\n        if (this.el.parentNode) {\n            this.el.parentNode.removeChild(this.el);\n\n            this.trigger('destroyed');\n        }\n    }\n\n    position() {\n        let top = this.options.y;\n        let left = this.options.x;\n\n        const menuEl = this.el.querySelector('.sgn-popover__menu');\n\n        const width = menuEl.offsetWidth;\n        const height = menuEl.offsetHeight;\n        const parentWidth = this.el.parentNode.offsetWidth;\n        const parentHeight = this.el.parentNode.offsetHeight;\n        const boundingRect = this.el.parentNode.getBoundingClientRect();\n\n        top -= boundingRect.top;\n        left -= boundingRect.left;\n\n        top -= window.pageYOffset;\n        left -= window.pageXOffset;\n\n        if (top + height > parentHeight) {\n            menuEl.style.top = parentHeight - height + 'px';\n        } else {\n            menuEl.style.top = top + 'px';\n        }\n\n        if (left + width > parentWidth) {\n            menuEl.style.left = parentWidth - width + 'px';\n        } else {\n            menuEl.style.left = left + 'px';\n        }\n    }\n\n    addEventListeners() {\n        const trigger = this.trigger.bind(this);\n\n        this.el.addEventListener('keyup', this.keyUp);\n\n        Gator(this.el).on('click', '[data-index]', function (e) {\n            e.preventDefault();\n            e.stopPropagation();\n\n            trigger('selected', {index: +this.getAttribute('data-index')});\n        });\n\n        Gator(this.el).on('click', '[data-close]', (e) => {\n            e.preventDefault();\n            e.stopPropagation();\n\n            this.destroy();\n        });\n\n        Gator(this.el).on('click', '.sgn-popover__menu', (e) => {\n            e.stopPropagation();\n        });\n\n        window.addEventListener('resize', this.resize, false);\n        window.addEventListener('scroll', this.scroll, false);\n    }\n\n    keyUp(e) {\n        if (e.keyCode === keyCodes.ESC) {\n            this.destroy();\n        }\n    }\n\n    resize() {\n        this.destroy();\n    }\n\n    scroll() {\n        this.destroy();\n    }\n}\n\nMicroEvent.mixin(Popover);\n\nexport default Popover;\n","import Popover from './popover';\n\nexport default function singleChoicePopover(ctx, callback) {\n    const {items} = ctx;\n    let popover = null;\n\n    if (items.length === 1) {\n        callback(items[0]);\n    } else if (items.length > 1) {\n        popover = new Popover({\n            header: ctx.header,\n            x: ctx.x,\n            y: ctx.y,\n            singleChoiceItems: items\n        });\n\n        popover.bind('selected', (e) => {\n            callback(items[e.index]);\n\n            popover.destroy();\n        });\n\n        popover.bind('destroyed', () => {\n            ctx.el.focus();\n        });\n\n        ctx.el.appendChild(popover.el);\n        popover.render().el.focus();\n    }\n\n    return {\n        destroy() {\n            popover?.destroy();\n        }\n    };\n}\n","import Gator from '../../../vendor/gator';\nexport {default as OfferDetails} from './offer-details';\nexport {default as Popover} from './popover';\nexport {default as singleChoicePopover} from './single-choice-popover';\n\nexport const on = (el, events, selector, callback) =>\n    Gator(el).on(events, selector, callback);\n\nexport const off = (el, events, selector, callback) =>\n    Gator(el).off(events, selector, callback);\n","const prefixKey = 'sgn-';\n\nconst storage = (() => {\n    try {\n        const storage = window.localStorage;\n\n        storage[`${prefixKey}test-storage`] = 'foobar';\n        delete storage[`${prefixKey}test-storage`];\n\n        return storage;\n    } catch (error) {\n        return {};\n    }\n})();\n\nexport function get(key) {\n    try {\n        return JSON.parse(storage[`${prefixKey}${key}`]);\n    } catch (error) {}\n}\n\nexport function set(key, value) {\n    try {\n        storage[`${prefixKey}${key}`] = JSON.stringify(value);\n    } catch (error) {}\n}\n","import fetch from 'cross-fetch';\nimport md5 from 'md5';\nimport {eventsTrackUrl as defaultEventsTrackUrl} from '../../configDefaults';\nimport * as clientLocalStorage from '../../storage/client-local';\nimport {btoa, error, throttle, uuid} from '../../util';\n\nconst createTrackerClient = () => {\n    let id = clientLocalStorage.get('client-id');\n    if (id?.data) {\n        id = id.data;\n    }\n\n    if (id == null) {\n        id = uuid();\n\n        clientLocalStorage.set('client-id', id);\n    }\n\n    return {id};\n};\n\nfunction getPool() {\n    let data = clientLocalStorage.get('event-tracker-pool');\n    if (Array.isArray(data) === false) {\n        data = [];\n    }\n    data = data.filter((evt) => typeof evt._i === 'string');\n\n    return data;\n}\n\nlet pool = getPool();\n\nclass Tracker {\n    constructor(options = {}) {\n        for (let key in this.defaultOptions) {\n            const value = this.defaultOptions[key];\n            this[key] = options[key] || value;\n        }\n\n        this.client = options?.client || createTrackerClient();\n        this.eventsTrackUrl = options?.eventsTrackUrl || defaultEventsTrackUrl;\n        this.location = {\n            geohash: null,\n            time: null,\n            country: null\n        };\n        this.dispatching = false;\n        this.hasMadeInitialDispatch = false;\n\n        if (this.eventsTrackUrl) {\n            dispatch(this.eventsTrackUrl);\n            this.hasMadeInitialDispatch = true;\n        }\n    }\n    setEventsTrackUrl(eventsTrackUrl) {\n        this.eventsTrackUrl = eventsTrackUrl;\n        if (!this.hasMadeInitialDispatch) {\n            dispatch(this.eventsTrackUrl);\n            this.hasMadeInitialDispatch = true;\n        }\n    }\n    trackEvent(type, properties = {}, version = 2) {\n        if (typeof type !== 'number') {\n            throw error(new Error('Event type is required'));\n        }\n        if (this.trackId == null) {\n            return;\n        }\n\n        const evt = Object.assign({}, properties, {\n            _e: type,\n            _v: version,\n            _i: uuid(),\n            _t: Math.round(new Date().getTime() / 1000),\n            _a: this.trackId\n        });\n\n        if (this.location.geohash) {\n            evt['l.h'] = this.location.geohash;\n        }\n        if (this.location.time) {\n            evt['l.ht'] = this.location.time;\n        }\n        if (this.location.country) {\n            evt['l.c'] = this.location.country;\n        }\n\n        pool.push(evt);\n        while (pool.length > this.poolLimit) {\n            pool.shift();\n        }\n\n        dispatch(this.eventsTrackUrl);\n\n        return this;\n    }\n\n    setLocation(location = {}) {\n        for (let key in location) {\n            const value = location[key];\n            if (Object.prototype.hasOwnProperty.call(this.location, key)) {\n                this.location[key] = value;\n            }\n        }\n\n        return this;\n    }\n\n    trackPagedPublicationOpened(properties, version) {\n        return this.trackEvent(1, properties, version);\n    }\n\n    trackPagedPublicationPageDisappeared(properties, version) {\n        return this.trackEvent(2, properties, version);\n    }\n\n    trackOfferOpened(properties, version) {\n        return this.trackEvent(3, properties, version);\n    }\n\n    trackSearched(properties, version) {\n        return this.trackEvent(5, properties, version);\n    }\n\n    trackIncitoPublicationOpened(properties, version) {\n        return this.trackEvent(11, properties, version);\n    }\n\n    createViewToken(...parts) {\n        const str = [this.client.id].concat(parts).join('');\n        const viewToken = btoa(\n            String.fromCharCode.apply(\n                null,\n                md5(str, {asBytes: true}).slice(0, 8)\n            )\n        );\n\n        return viewToken;\n    }\n}\nTracker.prototype.defaultOptions = {\n    trackId: null,\n    poolLimit: 1000\n};\nexport default Tracker;\n\nlet dispatching = false;\nconst dispatchLimit = 100;\n\nfunction ship(events = [], eventsTrackUrl) {\n    return fetch(eventsTrackUrl, {\n        method: 'post',\n        timeout: 1000 * 20,\n        headers: {\n            'Content-Type': 'application/json; charset=utf-8'\n        },\n        body: JSON.stringify({events})\n    }).then((response) => response.json());\n}\n\nlet dispatchRetryInterval = null;\nfunction _dispatch(eventsTrackUrl) {\n    if (dispatching === true || pool.length === 0) {\n        return;\n    }\n\n    const events = pool.slice(0, dispatchLimit);\n    let nacks = 0;\n    dispatching = true;\n\n    ship(events, eventsTrackUrl)\n        .then((response) => {\n            dispatching = false;\n            if (dispatchRetryInterval) {\n                clearInterval(dispatchRetryInterval);\n                dispatchRetryInterval = null;\n            }\n\n            response.events.forEach((resEvent) => {\n                if (\n                    resEvent.status === 'validation_error' ||\n                    resEvent.status === 'ack'\n                ) {\n                    pool = pool.filter(\n                        (poolEvent) => poolEvent._i !== resEvent.id\n                    );\n                } else {\n                    nacks++;\n                }\n            });\n\n            // Keep dispatching until the pool size reaches a sane level.\n            if (pool.length >= dispatchLimit && nacks === 0) {\n                dispatch(eventsTrackUrl);\n            }\n        })\n        .catch((err) => {\n            dispatching = false;\n            // Try dispatching again in 20 seconds, if we aren't already trying\n            if (!dispatchRetryInterval) {\n                console.warn(\n                    \"We're gonna keep trying, but there was an error while dispatching events:\",\n                    err\n                );\n\n                dispatchRetryInterval = setInterval(\n                    () => dispatch(eventsTrackUrl),\n                    20000\n                );\n            }\n        });\n}\nvar dispatch = throttle(_dispatch, 4000);\n\nclientLocalStorage.set('event-tracker-pool', []);\n\ntry {\n    window.addEventListener(\n        'beforeunload',\n        () => {\n            pool = pool.concat(getPool());\n\n            clientLocalStorage.set('event-tracker-pool', pool);\n        },\n        false\n    );\n} catch (error) {}\n","import MicroEvent from 'microevent';\n\nclass IncitoPublicationEventTracking {\n    constructor(eventTracker, details) {\n        this.eventTracker = eventTracker;\n        this.details = details;\n    }\n\n    trackOpened() {\n        if (this.eventTracker == null || this.details == null) {\n            return this;\n        }\n\n        this.eventTracker.trackIncitoPublicationOpened({\n            'ip.paged': this.details.types.indexOf('paged') > -1,\n            'ip.id': this.details.id,\n            vt: this.eventTracker.createViewToken(this.details.id)\n        });\n\n        return this;\n    }\n}\n\nMicroEvent.mixin(IncitoPublicationEventTracking);\n\nexport default IncitoPublicationEventTracking;\n","import Incito from 'incito-browser';\nimport MicroEvent from 'microevent';\nimport EventTracking from './event-tracking';\n\nclass Viewer {\n    constructor(el, options = {}) {\n        this.el = el;\n        this.options = options;\n        this.incito = new Incito(this.el, {\n            incito: this.options.incito,\n            renderLaziness: this.options.renderLaziness\n        });\n        this._eventTracking = new EventTracking(\n            this.options.eventTracker,\n            this.options.details\n        );\n    }\n\n    start() {\n        this.incito.start();\n        this.el.classList.add('sgn-incito--started');\n        this._eventTracking.trackOpened();\n\n        return this;\n    }\n\n    destroy() {\n        this.incito.destroy();\n    }\n}\nViewer.Incito = Incito;\n\nMicroEvent.mixin(Viewer);\n\nexport default Viewer;\n","module.exports = class Controls {\n    constructor(viewer) {\n        this.scroll = this.scroll.bind(this);\n        this.viewer = viewer;\n        this.progressEl = this.viewer.el.querySelector('.sgn-incito__progress');\n        this.isScrolling = false;\n\n        if (this.progressEl) {\n            this.progressEl.textContent = '0 %';\n\n            window.addEventListener('scroll', this.scroll, false);\n\n            this.viewer.bind('destroyed', () => {\n                window.removeEventListener('scroll', this.scroll, false);\n            });\n        }\n    }\n\n    scroll() {\n        const winHeight = window.innerHeight;\n        const rect = this.viewer.el.getBoundingClientRect();\n        const progress = Math.min(\n            100,\n            Math.round((Math.abs(rect.top - winHeight) / rect.height) * 100)\n        );\n\n        clearTimeout(this.scrollTimeout);\n        this.scrollTimeout = setTimeout(() => {\n            this.isScrolling = false;\n\n            this.viewer.el.classList.remove('sgn-incito--scrolling');\n        }, 1000);\n\n        if (this.isScrolling === false) {\n            this.viewer.el.classList.add('sgn-incito--scrolling');\n\n            this.isScrolling = true;\n        }\n\n        this.progressEl.textContent = `${progress} %`;\n        this.viewer.trigger('progress', {progress});\n    }\n};\n","import fetch from 'cross-fetch';\nimport Gator from '../../../vendor/gator';\nimport * as SGN from '../../core';\nimport * as clientLocalStorage from '../../storage/client-local';\nimport {error, getDeviceCategory, getOrientation, getPointer} from '../../util';\nimport request from '../core/request';\nimport Controls from './controls';\nimport Viewer from './viewer';\n\nexport default class Bootstrapper {\n    constructor(options = {}) {\n        this.fetchDetails = this.fetchDetails.bind(this);\n        this.options = options;\n        this.deviceCategory = this.getDeviceCategory();\n        this.pixelRatio = this.getPixelRatio();\n        this.pointer = this.getPointer();\n        this.orientation = this.getOrientation();\n        this.time = this.getTime();\n        this.locale = this.getLocale();\n        this.maxWidth = this.getMaxWidth();\n        this.featureLabels = this.getFeatureLabels();\n        this.versionsSupported = ['1.0.0'];\n    }\n\n    getDeviceCategory() {\n        return getDeviceCategory();\n    }\n\n    getPixelRatio() {\n        return window.devicePixelRatio || 1;\n    }\n\n    getPointer() {\n        return getPointer();\n    }\n\n    getOrientation() {\n        let orientation = getOrientation(screen.width, screen.height);\n        if (orientation === 'quadratic') {\n            orientation = 'horizontal';\n        }\n\n        return orientation;\n    }\n\n    getTime() {\n        return new Date().toISOString();\n    }\n\n    getLocale() {\n        let localeChain = [];\n        let locale = null;\n\n        if (\n            Array.isArray(navigator.languages) &&\n            navigator.languages.length > 0\n        ) {\n            localeChain = localeChain.concat(navigator.languages);\n        } else if (\n            typeof navigator.language === 'string' &&\n            navigator.language.length > 0\n        ) {\n            localeChain.push(navigator.language);\n        } else if (\n            typeof navigator.browserLanguage === 'string' &&\n            navigator.browserLanguage.length > 0\n        ) {\n            localeChain.push(navigator.browserLanguage);\n        }\n\n        localeChain.push('en_US');\n\n        for (let prefLocale of localeChain) {\n            if (prefLocale == null) {\n                continue;\n            }\n\n            prefLocale = prefLocale.replace('-', '_');\n\n            if (/[a-z][a-z]_[A-Z][A-Z]/g.test(prefLocale)) {\n                locale = prefLocale;\n\n                break;\n            }\n        }\n\n        return locale;\n    }\n\n    getMaxWidth() {\n        if (Math.abs(window.orientation) === 90) {\n            return Math.min(this.options.el.offsetWidth, screen.width);\n        } else {\n            return this.options.el.offsetWidth;\n        }\n    }\n\n    getFeatureLabels() {\n        let featureLabels = clientLocalStorage.get('incito-feature-labels');\n        if (Array.isArray(featureLabels) === false) {\n            featureLabels = [];\n        }\n\n        return featureLabels;\n    }\n\n    anonymizeFeatureLabels() {\n        const count = this.featureLabels.length;\n        const vector = this.featureLabels.reduce((acc, cur) => {\n            if (!acc[cur]) {\n                acc[cur] = {\n                    key: cur,\n                    value: 0\n                };\n            }\n\n            acc[cur].value++;\n\n            return acc;\n        }, {});\n\n        return Object.values(vector).map((featureLabel) => ({\n            key: featureLabel.key,\n            value: Math.round((featureLabel.value / count) * 100) / 100\n        }));\n    }\n\n    fetch(callback) {\n        this.fetchDetails(this.options.id, (err, details) => {\n            if (err != null) {\n                return callback(err);\n            }\n            this.fetchIncito(details.incito_publication_id, (err1, incito) => {\n                if (err1 != null) {\n                    return callback(err1);\n                }\n                callback(null, {\n                    details,\n                    incito\n                });\n            });\n        });\n    }\n\n    fetchDetails(id, callback) {\n        request({url: `/v2/catalogs/${this.options.id}`}, callback);\n    }\n\n    fetchIncito(id, callback) {\n        const res = fetch(\n            SGN.config.get('coreUrl') +\n                '/v4/rpc/generate_incito_from_publication',\n            {\n                method: 'post',\n                headers: {\n                    'X-Api-Key': SGN.config.get('appKey'),\n                    'Content-Type': 'application/json',\n                    Accept: 'application/json'\n                },\n                body: JSON.stringify({\n                    id,\n                    device_category: this.deviceCategory,\n                    pointer: this.pointer,\n                    orientation: this.orientation,\n                    pixel_ratio: this.pixelRatio,\n                    max_width: this.maxWidth,\n                    versions_supported: this.versionsSupported,\n                    locale_code: this.locale,\n                    time: this.time,\n                    feature_labels: this.anonymizeFeatureLabels(\n                        this.featureLabels\n                    )\n                })\n            }\n        );\n\n        res.then((response) => response.json())\n            .then((incito) => callback(null, incito))\n            .catch((err) => callback(err));\n    }\n\n    createViewer(data) {\n        if (data.incito == null) {\n            throw error(\n                new Error(),\n                'You need to supply valid Incito to create a viewer'\n            );\n        }\n\n        const viewer = new Viewer(this.options.el, {\n            id: this.options.id,\n            details: data.details,\n            incito: data.incito,\n            eventTracker: this.options.eventTracker\n        });\n        // Awfully this Controls instance is destroyed implicitly\n        // via the `destroyed` event of Viewer.\n        new Controls(viewer);\n        const self = this;\n\n        // Persist clicks on feature labels for later anonymization.\n        Gator(viewer.el).on(\n            'click',\n            '.incito__view[data-feature-labels]',\n            function () {\n                const featureLabels = this.getAttribute(\n                    'data-feature-labels'\n                ).split(',');\n\n                self.featureLabels = self.featureLabels.concat(featureLabels);\n\n                while (self.featureLabels.length > 1000) {\n                    self.featureLabels.shift();\n                }\n\n                clientLocalStorage.set(\n                    'incito-feature-labels',\n                    self.featureLabels\n                );\n            }\n        );\n\n        return viewer;\n    }\n}\n","import MicroEvent from 'microevent';\nimport * as keyCodes from '../../key-codes';\nimport {throttle} from '../../util';\n\nclass PagedPublicationControls {\n    constructor(el, options = {}) {\n        this.destroy = this.destroy.bind(this);\n        this.beforeNavigation = this.beforeNavigation.bind(this);\n        this.prevClicked = this.prevClicked.bind(this);\n        this.nextClicked = this.nextClicked.bind(this);\n        this.closeClicked = this.closeClicked.bind(this);\n        this.keyDown = this.keyDown.bind(this);\n        this.options = options;\n        this.els = {\n            root: el,\n            progress: el.querySelector('.sgn-pp__progress'),\n            progressBar: el.querySelector('.sgn-pp-progress__bar'),\n            progressLabel: el.querySelector('.sgn-pp__progress-label'),\n            prevControl: el.querySelector(\n                '.sgn-pp__control[data-direction=prev]'\n            ),\n            nextControl: el.querySelector(\n                '.sgn-pp__control[data-direction=next]'\n            ),\n            close: el.querySelector('.sgn-pp--close')\n        };\n\n        this.keyDownHandler = throttle(this.keyDown, 150, this);\n        if (this.options.keyboard === true) {\n            this.els.root.addEventListener(\n                'keydown',\n                this.keyDownHandler,\n                false\n            );\n        }\n        this.els.prevControl?.addEventListener(\n            'mousedown',\n            this.prevClicked,\n            false\n        );\n        this.els.nextControl?.addEventListener(\n            'mousedown',\n            this.nextClicked,\n            false\n        );\n        this.els.close?.addEventListener('mousedown', this.closeClicked, false);\n\n        this.bind('beforeNavigation', this.beforeNavigation);\n        this.bind('destroyed', this.destroy);\n    }\n\n    destroy() {\n        if (this.options.keyboard === true) {\n            this.els.root.removeEventListener(\n                'keydown',\n                this.keyDownHandler,\n                false\n            );\n        }\n        this.els.prevControl?.removeEventListener(\n            'mousedown',\n            this.prevClicked,\n            false\n        );\n\n        this.els.nextControl?.removeEventListener(\n            'mousedown',\n            this.nextClicked,\n            false\n        );\n\n        this.els.close?.removeEventListener(\n            'mousedown',\n            this.closeClicked,\n            false\n        );\n    }\n\n    beforeNavigation(e) {\n        const showProgress =\n            typeof e.progressLabel === 'string' && e.progressLabel.length > 0;\n        const visibilityClassName = 'sgn-pp--hidden';\n\n        if (this.els.progress && this.els.progressBar) {\n            this.els.progressBar.style.width = `${e.progress}%`;\n\n            if (showProgress === true) {\n                this.els.progress.classList.remove(visibilityClassName);\n            } else {\n                this.els.progress.classList.add(visibilityClassName);\n            }\n        }\n\n        if (this.els.progressLabel) {\n            if (showProgress === true) {\n                this.els.progressLabel.textContent = e.progressLabel;\n                this.els.progressLabel.classList.remove(visibilityClassName);\n            } else {\n                this.els.progressLabel.classList.add(visibilityClassName);\n            }\n        }\n\n        if (this.els.prevControl) {\n            if (e.verso.newPosition === 0) {\n                this.els.prevControl.classList.add(visibilityClassName);\n            } else {\n                this.els.prevControl.classList.remove(visibilityClassName);\n            }\n        }\n\n        if (this.els.nextControl) {\n            if (e.verso.newPosition === e.pageSpreadCount - 1) {\n                this.els.nextControl.classList.add(visibilityClassName);\n            } else {\n                this.els.nextControl.classList.remove(visibilityClassName);\n            }\n        }\n    }\n\n    prevClicked(e) {\n        e.preventDefault();\n\n        this.trigger('prev');\n    }\n\n    nextClicked(e) {\n        e.preventDefault();\n\n        this.trigger('next');\n    }\n\n    closeClicked(e) {\n        e.preventDefault();\n\n        this.trigger('close');\n    }\n\n    keyDown(e) {\n        const {keyCode} = e;\n\n        if (keyCodes.ARROW_LEFT === keyCode) {\n            this.trigger('prev', {duration: 0});\n        } else if (\n            keyCodes.ARROW_RIGHT === keyCode ||\n            keyCodes.SPACE === keyCode\n        ) {\n            this.trigger('next', {duration: 0});\n        } else if (keyCodes.NUMBER_ONE === keyCode) {\n            this.trigger('first', {duration: 0});\n        }\n    }\n}\n\nMicroEvent.mixin(PagedPublicationControls);\n\nexport default PagedPublicationControls;\n","import MicroEvent from 'microevent';\nimport {loadImage} from '../../util';\n\nclass PagedPublicationPageSpread {\n    constructor(options = {}) {\n        this.options = options;\n        this.contentsRendered = false;\n        this.hotspotsRendered = false;\n        this.el = this.renderEl();\n    }\n\n    getId() {\n        return this.options.id;\n    }\n\n    getEl() {\n        return this.el;\n    }\n\n    getPages() {\n        return this.options.pages;\n    }\n\n    renderEl() {\n        const el = document.createElement('div');\n        const pageIds = this.getPages().map((page) => page.id);\n\n        el.className = 'verso__page-spread sgn-pp__page-spread';\n\n        el.setAttribute('data-id', this.getId());\n        el.setAttribute('data-type', 'page');\n        el.setAttribute('data-width', this.options.width);\n        el.setAttribute('data-page-ids', pageIds.join(','));\n        el.setAttribute('data-max-zoom-scale', this.options.maxZoomScale);\n        el.setAttribute('data-zoomable', false);\n\n        return el;\n    }\n\n    renderContents() {\n        const id = this.getId();\n        const el = this.getEl();\n        const pages = this.getPages();\n        const pageCount = pages.length;\n        let imageLoads = 0;\n\n        let maxPageWidth = el.clientWidth * (window.devicePixelRatio || 1);\n        if (this.options.pageMode === 'double') {\n            maxPageWidth = maxPageWidth / 2;\n        }\n\n        const useLargeImage = maxPageWidth > 700;\n\n        pages.forEach((page, i) => {\n            let image = page.images.medium;\n            if (useLargeImage) {\n                image = page.images.large;\n            }\n\n            const pageEl = document.createElement('div');\n            const loaderEl = document.createElement('div');\n\n            pageEl.className = 'sgn-pp__page verso__page';\n            if (page.id != null) {\n                pageEl.setAttribute('data-id', page.id);\n            }\n\n            if (pageCount === 2) {\n                pageEl.className +=\n                    i === 0 ? ' verso-page--verso' : ' verso-page--recto';\n            }\n\n            pageEl.appendChild(loaderEl);\n            el.appendChild(pageEl);\n\n            loaderEl.className = 'sgn-pp-page__loader';\n            loaderEl.innerHTML = `<span>${page.label}</span>`;\n\n            loadImage(image, (err, width, height) => {\n                if (err == null) {\n                    const isComplete = ++imageLoads === pageCount;\n\n                    pageEl.style.backgroundImage = `url(${image})`;\n                    pageEl.setAttribute('data-width', width);\n                    pageEl.setAttribute('data-height', height);\n                    pageEl.innerHTML = '&nbsp;';\n\n                    if (isComplete) {\n                        el.setAttribute('data-zoomable', true);\n                    }\n\n                    this.trigger('pageLoaded', {pageSpreadId: id, page});\n                    if (isComplete) {\n                        this.trigger('pagesLoaded', {pageSpreadId: id, pages});\n                    }\n                } else {\n                    loaderEl.innerHTML = '<span>!</span>';\n                }\n            });\n        });\n\n        this.contentsRendered = true;\n\n        return this;\n    }\n\n    clearContents() {\n        this.el.innerHTML = '';\n        this.contentsRendered = false;\n\n        return this;\n    }\n\n    zoomIn() {\n        const pageEls = [].slice.call(\n            this.el.querySelectorAll('.sgn-pp__page')\n        );\n        const pages = this.getPages();\n\n        pageEls.forEach((pageEl) => {\n            const id = pageEl.getAttribute('data-id');\n            const page = pages.find((page) => page.id === id);\n            const image = page.images.large;\n\n            loadImage(image, (err) => {\n                if (\n                    err == null &&\n                    this.el.getAttribute('data-active') === 'true'\n                ) {\n                    pageEl.setAttribute(\n                        'data-image',\n                        pageEl.style.backgroundImage\n                    );\n                    pageEl.style.backgroundImage = `url(${image})`;\n                }\n            });\n        });\n    }\n\n    zoomOut() {\n        const pageEls = Array.from(\n            this.el.querySelectorAll('.sgn-pp__page[data-image]')\n        );\n\n        pageEls.forEach((pageEl) => {\n            pageEl.style.backgroundImage = pageEl.getAttribute('data-image');\n\n            pageEl.removeAttribute('data-image');\n        });\n    }\n}\n\nMicroEvent.mixin(PagedPublicationPageSpread);\n\nexport default PagedPublicationPageSpread;\n","import MicroEvent from 'microevent';\nimport {chunk} from '../../util';\nimport PageSpread from './page-spread';\n\nclass PagedPublicationPageSpreads {\n    constructor(options) {\n        this.options = options;\n        this.collection = [];\n        this.ids = {};\n    }\n\n    get(id) {\n        return this.ids[id];\n    }\n\n    getFrag() {\n        const frag = document.createDocumentFragment();\n\n        this.collection.forEach((pageSpread) =>\n            frag.appendChild(pageSpread.el)\n        );\n\n        return frag;\n    }\n\n    update(pageMode = 'single') {\n        const pageSpreads = [];\n        const ids = {};\n        const pages = this.options.pages.slice();\n        const {width, maxZoomScale} = this.options;\n\n        if (pageMode === 'single') {\n            pages.forEach((page) => pageSpreads.push([page]));\n        } else {\n            const firstPage = pages.shift();\n            const lastPage = pages.length % 2 === 1 ? pages.pop() : null;\n            const midstPageSpreads = chunk(pages, 2);\n\n            if (firstPage) {\n                pageSpreads.push([firstPage]);\n            }\n            midstPageSpreads.forEach((midstPages) =>\n                pageSpreads.push(midstPages.map((page) => page))\n            );\n            if (lastPage) {\n                pageSpreads.push([lastPage]);\n            }\n        }\n\n        this.collection = pageSpreads.map((pages, i) => {\n            const id = `${pageMode}-${i}`;\n            const pageSpread = new PageSpread({\n                width,\n                pageMode,\n                maxZoomScale,\n                pages,\n                id\n            });\n\n            pageSpread.bind('pageLoaded', (e) => this.trigger('pageLoaded', e));\n            pageSpread.bind('pagesLoaded', (e) =>\n                this.trigger('pagesLoaded', e)\n            );\n\n            ids[id] = pageSpread;\n\n            return pageSpread;\n        });\n        this.ids = ids;\n\n        return this;\n    }\n}\n\nMicroEvent.mixin(PagedPublicationPageSpreads);\n\nexport default PagedPublicationPageSpreads;\n","import MicroEvent from 'microevent';\nimport Verso from 'verso-browser';\nimport {getColorBrightness, throttle} from '../../util';\nimport PageSpreads from './page-spreads';\n\nclass PagedPublicationCore {\n    constructor(el, options = {}) {\n        this.beforeNavigation = this.beforeNavigation.bind(this);\n        this.afterNavigation = this.afterNavigation.bind(this);\n        this.attemptedNavigation = this.attemptedNavigation.bind(this);\n        this.clicked = this.clicked.bind(this);\n        this.doubleClicked = this.doubleClicked.bind(this);\n        this.pressed = this.pressed.bind(this);\n        this.contextmenu = this.contextmenu.bind(this);\n        this.panStart = this.panStart.bind(this);\n        this.panEnd = this.panEnd.bind(this);\n        this.zoomedIn = this.zoomedIn.bind(this);\n        this.zoomedOut = this.zoomedOut.bind(this);\n        this.resize = this.resize.bind(this);\n        this.unload = this.unload.bind(this);\n        this.options = this.makeOptions(options, this.defaults);\n        this.pageId = this.getOption('pageId');\n        this.els = {\n            root: el,\n            pages: el.querySelector('.sgn-pp__pages'),\n            verso: el.querySelector('.verso')\n        };\n        this.pageMode = this.getPageMode();\n        this.pageSpreads = new PageSpreads({\n            pages: this.getOption('pages'),\n            maxZoomScale: this.getOption('pageSpreadMaxZoomScale'),\n            width: this.getOption('pageSpreadWidth')\n        });\n\n        this.pageSpreads.bind('pageLoaded', this.pageLoaded.bind(this));\n        this.pageSpreads.bind('pagesLoaded', this.pagesLoaded.bind(this));\n\n        this.setColor(this.getOption('color'));\n\n        // It's important to insert the page spreads before instantiating Verso.\n        this.els.pages.parentNode.insertBefore(\n            this.pageSpreads.update(this.pageMode).getFrag(),\n            this.els.pages\n        );\n\n        this.verso = this.createVerso();\n\n        this.bind('started', this.start.bind(this));\n        this.bind('destroyed', this.destroy.bind(this));\n    }\n\n    start() {\n        const verso = this.getVerso();\n        verso.start();\n\n        verso.pageSpreads.forEach(\n            this.overridePageSpreadContentRect.bind(this)\n        );\n\n        this.resizeListener = throttle(\n            this.resize,\n            this.getOption('resizeDelay')\n        );\n\n        window.addEventListener('resize', this.resizeListener, false);\n        window.addEventListener('beforeunload', this.unload, false);\n\n        this.els.root.setAttribute('data-started', '');\n        this.els.root.setAttribute('tabindex', '-1');\n        this.els.root.focus();\n    }\n\n    destroy() {\n        const verso = this.getVerso();\n        const pageSpreadEls = verso.el.querySelectorAll('.sgn-pp__page-spread');\n\n        this.els.root.removeAttribute('data-started');\n        this.els.root.removeAttribute('data-idle');\n        this.els.root.removeAttribute('data-navigating');\n        this.els.root.removeAttribute('data-color-brightness');\n        this.els.root.removeAttribute('data-zoomed-in');\n\n        this.els.root.style.backgroundColor = '#ffffff';\n\n        Array.from(pageSpreadEls).forEach((pageSpreadEl) => {\n            pageSpreadEl.parentNode.removeChild(pageSpreadEl);\n        });\n\n        verso.destroy();\n\n        window.removeEventListener('resize', this.resizeListener, false);\n        window.removeEventListener('beforeunload', this.unload, false);\n    }\n\n    makeOptions(options, defaults) {\n        const opts = {};\n\n        for (let key in options) {\n            opts[key] = options[key] ?? defaults[key];\n        }\n\n        return opts;\n    }\n\n    getOption(key) {\n        return this.options[key];\n    }\n\n    setColor(color) {\n        this.els.root.setAttribute(\n            'data-color-brightness',\n            getColorBrightness(color)\n        );\n        this.els.root.style.backgroundColor = color;\n    }\n\n    createVerso() {\n        const verso = new Verso(this.els.verso, {pageId: this.pageId});\n\n        verso.bind('beforeNavigation', this.beforeNavigation);\n        verso.bind('afterNavigation', this.afterNavigation);\n        verso.bind('attemptedNavigation', this.attemptedNavigation);\n        verso.bind('clicked', this.clicked);\n        verso.bind('doubleClicked', this.doubleClicked);\n        verso.bind('pressed', this.pressed);\n        verso.bind('contextmenu', this.contextmenu);\n        verso.bind('panStart', this.panStart);\n        verso.bind('panEnd', this.panEnd);\n        verso.bind('zoomedIn', this.zoomedIn);\n        verso.bind('zoomedOut', this.zoomedOut);\n\n        return verso;\n    }\n\n    getVerso() {\n        return this.verso;\n    }\n\n    getContentRect(pageSpread) {\n        const rect = {\n            top: 0,\n            left: 0,\n            right: 0,\n            bottom: 0,\n            width: 0,\n            height: 0\n        };\n        const pageEls = pageSpread.getPageEls();\n        const pageEl = pageEls[0];\n        const pageCount = pageEls.length;\n\n        if (!pageCount) {\n            return rect;\n        }\n\n        const {scale} = this.getVerso().transform;\n        const pageWidth = pageEl.offsetWidth * pageCount * scale;\n        const pageHeight = pageEl.offsetHeight * scale;\n        const imageRatio =\n            +pageEl.getAttribute('data-height') /\n            (+pageEl.getAttribute('data-width') * pageCount);\n        let actualHeight = pageHeight;\n        let actualWidth = actualHeight / imageRatio;\n        actualWidth = Math.min(pageWidth, actualWidth);\n        actualHeight = actualWidth * imageRatio;\n        const clientRect = pageEl.getBoundingClientRect();\n\n        rect.width = actualWidth;\n        rect.height = actualHeight;\n        rect.top = clientRect.top + (pageHeight - actualHeight) / 2;\n        rect.left = clientRect.left + (pageWidth - actualWidth) / 2;\n        rect.right = rect.width + rect.left;\n        rect.bottom = rect.height + rect.top;\n\n        return rect;\n    }\n\n    formatProgressLabel(pageSpread) {\n        const pages = pageSpread?.options.pages ?? [];\n        const pageIds = pages.map((page) => page.id);\n        const pageLabels = pages.map((page) => page.label);\n        const pageCount = this.getOption('pages').length;\n        const label =\n            pageIds.length > 0\n                ? pageLabels.join('-') + ' / ' + pageCount\n                : null;\n\n        return label;\n    }\n\n    renderPageSpreads() {\n        this.getVerso().pageSpreads.forEach((pageSpread) => {\n            const visibility = pageSpread.getVisibility();\n            const match = this.pageSpreads.get(pageSpread.getId());\n\n            if (match) {\n                if (\n                    visibility === 'visible' &&\n                    match.contentsRendered === false\n                ) {\n                    setTimeout(match.renderContents.bind(match), 0);\n                }\n                if (visibility === 'gone' && match.contentsRendered === true) {\n                    setTimeout(match.clearContents.bind(match), 0);\n                }\n            }\n        });\n\n        return this;\n    }\n\n    findPage(pageId) {\n        return this.getOption('pages').find((page) => page.id === pageId);\n    }\n\n    pageLoaded(e) {\n        this.trigger('pageLoaded', e);\n    }\n\n    pagesLoaded(e) {\n        this.trigger('pagesLoaded', e);\n    }\n\n    beforeNavigation(e) {\n        const position = e.newPosition;\n        const theVerso = this.getVerso();\n        const versoPageSpread = theVerso.getPageSpreadFromPosition(position);\n        const pageSpread = this.pageSpreads.get(versoPageSpread.getId());\n        const pageSpreadCount = theVerso.getPageSpreadCount();\n        const newSpreadEl = theVerso.pageSpreadEls[e.newPosition];\n        const progress = (position / (pageSpreadCount - 1)) * 100;\n        const progressLabel = this.formatProgressLabel(pageSpread);\n\n        this.els.root.setAttribute('data-navigating', true);\n\n        this.renderPageSpreads();\n        this.resetIdleTimer();\n        this.startIdleTimer();\n        this.trigger('beforeNavigation', {\n            verso: e,\n            pageSpread,\n            newSpreadEl,\n            progress,\n            progressLabel,\n            pageSpreadCount,\n            newPositionIsEnd: e.newPosition + 1 === pageSpreadCount\n        });\n    }\n\n    afterNavigation(e) {\n        const position = e.newPosition;\n        const theVerso = this.getVerso();\n        const versoPageSpread = theVerso.getPageSpreadFromPosition(position);\n        const pageSpread = this.pageSpreads.get(versoPageSpread.getId());\n        const pageSpreadCount = theVerso.getPageSpreadCount();\n        const newSpreadEl = theVerso.pageSpreadEls[e.newPosition];\n\n        this.els.root.setAttribute('data-navigating', false);\n\n        this.trigger('afterNavigation', {\n            verso: e,\n            pageSpread,\n            pageSpreadCount,\n            newSpreadEl,\n            newPositionIsEnd: e.newPosition + 1 === pageSpreadCount\n        });\n    }\n\n    attemptedNavigation(e) {\n        this.trigger('attemptedNavigation', {verso: e});\n    }\n\n    clicked(e) {\n        if (e.isInsideContent) {\n            const pageId = e.pageEl.getAttribute('data-id');\n            const page = this.findPage(pageId);\n\n            this.trigger('clicked', {verso: e, page});\n        }\n    }\n\n    doubleClicked(e) {\n        if (e.isInsideContent) {\n            const pageId = e.pageEl.getAttribute('data-id');\n            const page = this.findPage(pageId);\n\n            this.trigger('doubleClicked', {verso: e, page});\n        }\n    }\n\n    pressed(e) {\n        if (e.isInsideContent) {\n            const pageId = e.pageEl.getAttribute('data-id');\n            const page = this.findPage(pageId);\n\n            this.trigger('pressed', {verso: e, page});\n        }\n    }\n\n    contextmenu(e) {\n        if (e.isInsideContent) {\n            const pageId = e.pageEl.getAttribute('data-id');\n            const page = this.findPage(pageId);\n\n            this.trigger('contextmenu', {verso: e, page});\n        }\n    }\n\n    panStart() {\n        this.resetIdleTimer();\n        this.trigger('panStart', {scale: this.getVerso().transform.scale});\n    }\n\n    panEnd() {\n        this.startIdleTimer();\n        this.trigger('panEnd');\n    }\n\n    zoomedIn(e) {\n        const {position} = e;\n        const versoPageSpread = this.getVerso().getPageSpreadFromPosition(\n            position\n        );\n        const pageSpread = this.pageSpreads.get(versoPageSpread.getId());\n\n        pageSpread?.zoomIn();\n\n        this.els.root.setAttribute('data-zoomed-in', true);\n        this.trigger('zoomedIn', {verso: e, pageSpread});\n    }\n\n    zoomedOut(e) {\n        const {position} = e;\n        const versoPageSpread = this.getVerso().getPageSpreadFromPosition(\n            position\n        );\n        const pageSpread = this.pageSpreads.get(versoPageSpread.getId());\n\n        pageSpread?.zoomOut();\n\n        this.els.root.setAttribute('data-zoomed-in', false);\n        this.trigger('zoomedOut', {verso: e, pageSpread});\n    }\n\n    getPageMode() {\n        let pageMode = this.getOption('pageMode');\n\n        if (pageMode == null) {\n            const width = this.els.root.offsetWidth;\n            const height = this.els.root.offsetHeight;\n\n            pageMode = height / width < 0.8 ? 'double' : 'single';\n        }\n\n        return pageMode;\n    }\n\n    resetIdleTimer() {\n        clearTimeout(this.idleTimeout);\n\n        this.els.root.setAttribute('data-idle', false);\n\n        return this;\n    }\n\n    startIdleTimer() {\n        this.idleTimeout = setTimeout(() => {\n            this.els.root.setAttribute('data-idle', true);\n        }, this.getOption('idleDelay'));\n\n        return this;\n    }\n\n    switchPageMode(pageMode) {\n        if (this.pageMode === pageMode) {\n            return this;\n        }\n\n        const verso = this.getVerso();\n        const pageIds = verso\n            .getPageSpreadFromPosition(verso.getPosition())\n            .getPageIds();\n        const pageSpreadEls = this.getVerso().el.querySelectorAll(\n            '.sgn-pp__page-spread'\n        );\n\n        this.pageMode = pageMode;\n\n        this.pageSpreads.update(this.pageMode);\n\n        Array.from(pageSpreadEls).forEach((pageSpreadEl) => {\n            pageSpreadEl.parentNode.removeChild(pageSpreadEl);\n        });\n        this.els.pages.parentNode.insertBefore(\n            this.pageSpreads.getFrag(),\n            this.els.pages\n        );\n\n        verso.refresh();\n        verso.navigateTo(verso.getPageSpreadPositionFromPageId(pageIds[0]), {\n            duration: 0\n        });\n        verso.pageSpreads.forEach(\n            this.overridePageSpreadContentRect.bind(this)\n        );\n\n        return this;\n    }\n\n    overridePageSpreadContentRect(pageSpread) {\n        if (pageSpread.getType() === 'page') {\n            return (pageSpread.getContentRect = () =>\n                this.getContentRect(pageSpread));\n        }\n    }\n\n    resize() {\n        const pageMode = this.getPageMode();\n\n        if (this.getOption('pageMode') == null && pageMode !== this.pageMode) {\n            this.switchPageMode(pageMode);\n        } else {\n            this.trigger('resized');\n        }\n    }\n\n    unload() {\n        this.trigger('disappeared');\n    }\n}\nPagedPublicationCore.prototype.defaults = {\n    pages: [],\n    pageSpreadWidth: 100,\n    pageSpreadMaxZoomScale: 2.3,\n    idleDelay: 1000,\n    resizeDelay: 400,\n    color: '#ffffff'\n};\n\nMicroEvent.mixin(PagedPublicationCore);\n\nexport default PagedPublicationCore;\n","import MicroEvent from 'microevent';\n\nclass PagedPublicationEventTracking {\n    constructor(eventTracker, id) {\n        this.eventTracker = eventTracker;\n        this.id = id;\n        this.hidden = true;\n        this.pageSpread = null;\n\n        this.bind('appeared', this.appeared.bind(this));\n        this.bind('disappeared', this.disappeared.bind(this));\n        this.bind('beforeNavigation', this.beforeNavigation.bind(this));\n        this.bind('afterNavigation', this.afterNavigation.bind(this));\n        this.bind('attemptedNavigation', this.attemptedNavigation.bind(this));\n        this.bind('panStart', this.panStart.bind(this));\n        this.bind('destroyed', this.destroy.bind(this));\n    }\n\n    destroy() {\n        this.pageSpreadDisappeared();\n    }\n\n    trackOpened() {\n        if (this.eventTracker == null) {\n            return this;\n        }\n\n        this.eventTracker.trackPagedPublicationOpened({\n            'pp.id': this.id,\n            vt: this.eventTracker.createViewToken(this.id)\n        });\n\n        return this;\n    }\n\n    trackPageSpreadDisappeared(pageNumbers) {\n        if (this.eventTracker == null) {\n            return this;\n        }\n\n        pageNumbers.forEach((pageNumber) => {\n            this.eventTracker.trackPagedPublicationPageDisappeared({\n                'pp.id': this.id,\n                'ppp.n': pageNumber,\n                vt: this.eventTracker.createViewToken(this.id, pageNumber)\n            });\n        });\n\n        return this;\n    }\n\n    appeared(e) {\n        this.pageSpreadAppeared(e.pageSpread);\n    }\n\n    disappeared() {\n        this.pageSpreadDisappeared();\n    }\n\n    beforeNavigation() {\n        this.pageSpreadDisappeared();\n    }\n\n    afterNavigation(e) {\n        this.pageSpreadAppeared(e.pageSpread);\n    }\n\n    attemptedNavigation(e) {\n        this.pageSpreadAppeared(e.pageSpread);\n    }\n\n    panStart(e) {\n        if (e.scale === 1) {\n            this.pageSpreadDisappeared();\n        }\n    }\n\n    pageSpreadAppeared(pageSpread) {\n        if (pageSpread && this.hidden === true) {\n            this.pageSpread = pageSpread;\n            this.hidden = false;\n        }\n    }\n\n    pageSpreadDisappeared() {\n        if (this.pageSpread && this.hidden === false) {\n            this.trackPageSpreadDisappeared(\n                this.pageSpread.getPages().map((page) => page.pageNumber)\n            );\n\n            this.hidden = true;\n            this.pageSpread = null;\n        }\n    }\n}\n\nMicroEvent.mixin(PagedPublicationEventTracking);\n\nexport default PagedPublicationEventTracking;\n","import MicroEvent from 'microevent';\nimport Mustache from 'mustache';\n\nclass PagedPublicationHotspots {\n    constructor() {\n        this.currentPageSpreadId = null;\n        this.pageSpreadsLoaded = {};\n        this.cache = {};\n\n        this.bind('hotspotsReceived', this.hotspotsReceived.bind(this));\n        this.bind('afterNavigation', this.afterNavigation.bind(this));\n        this.bind('pagesLoaded', this.pagesLoaded.bind(this));\n        this.bind('resized', this.resized.bind(this));\n    }\n\n    renderHotspots(data) {\n        const frag = document.createDocumentFragment();\n        const contentRect = data.versoPageSpread.getContentRect();\n        const pageSpreadEl = data.pageSpread.getEl();\n        const hotspotEls = pageSpreadEl.querySelectorAll('.sgn-pp__hotspot');\n        const boundingRect = pageSpreadEl.getBoundingClientRect();\n\n        Array.from(hotspotEls).forEach((hotspotEl) => {\n            hotspotEl.parentNode.removeChild(hotspotEl);\n        });\n\n        for (let id in data.hotspots) {\n            const hotspot = data.hotspots[id];\n            const position = this.getPosition(data.pages, data.ratio, hotspot);\n            const el = this.renderHotspot(\n                hotspot,\n                position,\n                contentRect,\n                boundingRect\n            );\n\n            frag.appendChild(el);\n        }\n\n        pageSpreadEl.appendChild(frag);\n\n        return this;\n    }\n\n    renderHotspot(hotspot, position, contentRect, boundingRect) {\n        const el = document.createElement('div');\n        let top = Math.round((contentRect.height / 100) * position.top);\n        let left = Math.round((contentRect.width / 100) * position.left);\n        const width = Math.round((contentRect.width / 100) * position.width);\n        const height = Math.round((contentRect.height / 100) * position.height);\n\n        top += Math.round(contentRect.top);\n        left += Math.round(contentRect.left);\n        top -= boundingRect.top;\n        left -= boundingRect.left;\n\n        el.className = 'sgn-pp__hotspot verso__overlay';\n        if (hotspot.id != null) {\n            el.setAttribute('data-id', hotspot.id);\n        }\n        if (hotspot.type != null) {\n            el.setAttribute('data-type', hotspot.type);\n        }\n        el.innerHTML = Mustache.render('', hotspot);\n\n        el.style.top = `${top}px`;\n        el.style.left = `${left}px`;\n        el.style.width = `${width}px`;\n        el.style.height = `${height}px`;\n\n        return el;\n    }\n\n    getPosition(pages, ratio, hotspot) {\n        let minX = null;\n        let minY = null;\n        let maxX = null;\n        let maxY = null;\n        const pageNumbers = pages.map((page) => page.pageNumber);\n\n        for (var pageNumber in hotspot.locations) {\n            if (pageNumbers.indexOf(+pageNumber) === -1) {\n                continue;\n            }\n\n            hotspot.locations[pageNumber].forEach((coords) => {\n                let [x, y] = coords;\n\n                if (pages[1] && pageNumbers[1] === +pageNumber) {\n                    x += 1;\n                }\n                x /= pages.length;\n\n                if (minX == null) {\n                    minX = maxX = x;\n                    minY = maxY = y;\n                }\n\n                if (x < minX) {\n                    minX = x;\n                }\n                if (x > maxX) {\n                    maxX = x;\n                }\n                if (y < minY) {\n                    minY = y;\n                }\n                if (y > maxY) {\n                    return (maxY = y);\n                }\n            });\n        }\n\n        const width = maxX - minX;\n        const height = maxY - minY;\n\n        return {\n            top: (minY / ratio) * 100,\n            left: minX * 100,\n            width: width * 100,\n            height: (height / ratio) * 100\n        };\n    }\n\n    requestHotspots(pageSpreadId, pages) {\n        this.trigger('hotspotsRequested', {\n            id: pageSpreadId,\n            pages\n        });\n    }\n\n    hotspotsReceived(e) {\n        const pageSpreadId = e.pageSpread.getId();\n\n        this.setCache(pageSpreadId, e);\n        this.renderHotspots(e);\n    }\n\n    getCache(pageSpreadId) {\n        return this.cache[pageSpreadId];\n    }\n\n    setCache(pageSpreadId, data) {\n        this.cache[pageSpreadId] = data;\n\n        return this;\n    }\n\n    afterNavigation(e) {\n        if (e.pageSpread == null) {\n            return;\n        }\n\n        const id = e.pageSpread.getId();\n\n        this.currentPageSpreadId = id;\n        if (this.pageSpreadsLoaded[id]) {\n            this.requestHotspots(id, e.pageSpread.getPages());\n        }\n    }\n\n    pagesLoaded(e) {\n        this.pageSpreadsLoaded[e.pageSpreadId] = true;\n        if (this.currentPageSpreadId === e.pageSpreadId) {\n            this.requestHotspots(e.pageSpreadId, e.pages);\n        }\n    }\n\n    resized() {\n        const data = this.getCache(this.currentPageSpreadId);\n\n        if (data) {\n            this.renderHotspots(data);\n        }\n    }\n}\n\nMicroEvent.mixin(PagedPublicationHotspots);\n\nexport default PagedPublicationHotspots;\n","import MicroEvent from 'microevent';\nimport * as translations from '../../translations';\nimport { uuid } from '../../util';\nimport singleChoicePopover from '../core-ui/single-choice-popover';\nimport Controls from './controls';\nimport Core from './core';\nimport EventTracking from './event-tracking';\nimport Hotspots from './hotspots';\n \nfunction defaultPickHotspot(hotspots, e, el, callback) {\n    const popover = singleChoicePopover(\n        {\n            el,\n            header: translations.t('paged_publication.hotspot_picker.header'),\n            x: e.verso.x,\n            y: e.verso.y,\n            items: hotspots\n                .filter((hotspot) => hotspot.type === 'offer')\n                .map((hotspot) => ({\n                    id: hotspot.id,\n                    title: hotspot.offer.heading,\n                    subtitle:\n                        hotspot.offer.pricing.currency +\n                        '' +\n                        hotspot.offer.pricing.price\n                }))\n        },\n        (picked) =>\n            callback(hotspots.find((hotspot) => hotspot.id === picked.id))\n    );\n\n    return popover.destroy;\n}\n\nclass Viewer {\n    constructor(el, options = {}) {\n        this.el = el;\n        this.options = options;\n        this._core = new Core(this.el, {\n            id: this.options.id,\n            pages: this.options.pages,\n            pageSpreadWidth: this.options.pageSpreadWidth,\n            pageSpreadMaxZoomScale: this.options.pageSpreadMaxZoomScale,\n            pageId: this.options.pageId,\n            idleDelay: this.options.idleDelay,\n            resizeDelay: this.options.resizeDelay,\n            color: this.options.color\n        });\n        this._hotspots = new Hotspots();\n        this._controls = new Controls(this.el, {\n            keyboard: this.options.keyboard\n        });\n        this._eventTracking = new EventTracking(\n            this.options.eventTracker,\n            this.options.id\n        );\n        this.viewSession = uuid();\n        this.hotspots = null;\n        this.hotspotQueue = [];\n        this.popover = null;\n\n        this._setupEventListeners();\n    }\n\n    start() {\n        this._eventTracking.trackOpened();\n        this._core.trigger('started');\n\n        return this;\n    }\n\n    destroy() {\n        this._core.trigger('destroyed');\n        this._hotspots.trigger('destroyed');\n        this._controls.trigger('destroyed');\n        this._eventTracking.trigger('destroyed');\n\n        this.trigger('destroyed');\n\n        return this;\n    }\n\n    navigateTo(position, options) {\n        this.navigateToIndex(position, options);\n\n        return this;\n    }\n\n    navigateToIndex(position, options) {\n        this._core.getVerso().navigateTo(position, options);\n\n        return this;\n    }\n\n    navigateToPageId(pageId, options) {\n        const position = this._core\n            .getVerso()\n            .getPageSpreadPositionFromPageId(pageId);\n\n        return this._core.getVerso().navigateTo(position, options);\n    }\n\n    first(options) {\n        this._core.getVerso().first(options);\n\n        return this;\n    }\n\n    prev(options) {\n        this._core.getVerso().prev(options);\n\n        return this;\n    }\n\n    next(options) {\n        this._core.getVerso().next(options);\n\n        return this;\n    }\n\n    last(options) {\n        this._core.getVerso().last(options);\n\n        return this;\n    }\n\n    _setupEventListeners() {\n        this._controls.bind('prev', (e) => {\n            this.prev(e);\n        });\n        this._controls.bind('next', (e) => {\n            this.next(e);\n        });\n        this._controls.bind('first', (e) => {\n            this.first(e);\n        });\n        this._controls.bind('last', (e) => {\n            this.last(e);\n        });\n        this._controls.bind('close', (e) => {\n            this.destroy(e);\n        });\n        this._hotspots.bind('hotspotsRequested', (e) => {\n            this.trigger('hotspotsRequested', e);\n        });\n\n        this._core.bind('appeared', (e) => {\n            this._eventTracking.trigger('appeared', e);\n            this.trigger('appeared', e);\n        });\n        this._core.bind('disappeared', (e) => {\n            this._eventTracking.trigger('disappeared', e);\n            this.trigger('disappeared', e);\n        });\n        this._core.bind('beforeNavigation', (e) => {\n            this._eventTracking.trigger('beforeNavigation', e);\n            this._controls.trigger('beforeNavigation', e);\n            this.trigger('beforeNavigation', e);\n        });\n        this._core.bind('afterNavigation', (e) => {\n            this._eventTracking.trigger('afterNavigation', e);\n            this._hotspots.trigger('afterNavigation', e);\n            this.trigger('afterNavigation', e);\n        });\n        this._core.bind('attemptedNavigation', (e) => {\n            this._eventTracking.trigger('attemptedNavigation', e);\n            this.trigger('attemptedNavigation', e);\n        });\n        this._core.bind('clicked', (e) => {\n            this._eventTracking.trigger('clicked', e);\n            this.trigger('clicked', e);\n        });\n        this._core.bind('doubleClicked', (e) => {\n            this._eventTracking.trigger('doubleClicked', e);\n            this.trigger('doubleClicked', e);\n        });\n        this._core.bind('contextmenu', (e) => {\n            this.trigger('contextmenu', e);\n        });\n        this._core.bind('pressed', (e) => {\n            this._eventTracking.trigger('pressed', e);\n            this.trigger('pressed', e);\n        });\n        this._core.bind('panStart', (e) => {\n            this._eventTracking.trigger('panStart', e);\n            this.trigger('panStart', e);\n        });\n        this._core.bind('zoomedIn', (e) => {\n            this._eventTracking.trigger('zoomedIn', e);\n            this.trigger('zoomedIn', e);\n        });\n        this._core.bind('zoomedOut', (e) => {\n            this._eventTracking.trigger('zoomedOut', e);\n            this.trigger('zoomedOut', e);\n        });\n        this._core.bind('pageLoaded', (e) => {\n            this._eventTracking.trigger('pageLoaded', e);\n            this.trigger('pageLoaded', e);\n        });\n        this._core.bind('pagesLoaded', (e) => {\n            this._hotspots.trigger('pagesLoaded', e);\n            this.trigger('pagesLoaded', e);\n        });\n        this._core.bind('resized', (e) => {\n            this._hotspots.trigger('resized');\n            this.trigger('resized', e);\n        });\n\n        this.bind('hotspotsRequested', this.hotspotsRequested.bind(this));\n        this.bind('beforeNavigation', this.beforeNavigation.bind(this));\n        this.bind('clicked', this.clicked.bind(this));\n        this.bind('contextmenu', this.contextmenu.bind(this));\n        this.bind('pressed', this.pressed.bind(this));\n    }\n\n    pickHotspot(e, callback) {\n        if (this.hotspots == null) {\n            return;\n        }\n\n        if (this.popover != null) {\n            this.popover.destroy?.();\n            this.popover = null;\n        }\n\n        const hotspots = e.verso.overlayEls.map(\n            (overlayEl) => this.hotspots[overlayEl.getAttribute('data-id')]\n        );\n\n        if (hotspots.length === 1) {\n            callback(hotspots[0]);\n        } else if (hotspots.length > 1) {\n            this.popover = {\n                destroy: (this.options.pickHotspot || defaultPickHotspot)(\n                    hotspots,\n                    e,\n                    this.el,\n                    callback\n                )\n            };\n        }\n    }\n\n    processHotspotQueue() {\n        if (this.hotspots == null) {\n            return;\n        }\n\n        this.hotspotQueue = this.hotspotQueue.filter((hotspotRequest) => {\n            let id;\n            const hotspots = {};\n            const versoPageSpread = this._core\n                .getVerso()\n                .pageSpreads.find(\n                    (pageSpread) => pageSpread.getId() === hotspotRequest.id\n                );\n\n            for (id in this.hotspots) {\n                const hotspot = this.hotspots[id];\n                if (hotspots[id]) {\n                    continue;\n                }\n                for (const page of hotspotRequest.pages) {\n                    if (hotspot.locations[page.pageNumber]) {\n                        hotspots[id] = {\n                            type: hotspot.type,\n                            id: hotspot.id,\n                            locations: hotspot.locations\n                        };\n\n                        break;\n                    }\n                }\n            }\n\n            this._hotspots.trigger('hotspotsReceived', {\n                pageSpread: this._core.pageSpreads.get(hotspotRequest.id),\n                versoPageSpread,\n                ratio: this.options.hotspotRatio,\n                pages: hotspotRequest.pages,\n                hotspots\n            });\n\n            return false;\n        });\n    }\n\n    hotspotsRequested(e) {\n        this.hotspotQueue.push(e);\n        this.processHotspotQueue();\n    }\n\n    applyHotspots(hotspots = {}) {\n        this.hotspots = hotspots;\n\n        this.processHotspotQueue();\n    }\n\n    beforeNavigation() {\n        this.popover?.destroy?.();\n    }\n\n    clicked(e) {\n        this.pickHotspot(e, (hotspot) => {\n            this.trigger('hotspotClicked', hotspot);\n        });\n    }\n\n    contextmenu(e) {\n        this.pickHotspot(e, (hotspot) => {\n            this.trigger('hotspotContextmenu', hotspot);\n        });\n    }\n\n    pressed(e) {\n        this.pickHotspot(e, (hotspot) => {\n            this.trigger('hotspotPressed', hotspot);\n        });\n    }\n}\n\nMicroEvent.mixin(Viewer);\n\nexport default Viewer;\n","import {request} from '../core';\nimport Viewer from './viewer';\n\nexport default class Bootstrapper {\n    constructor(options = {}) {\n        this.options = options;\n    }\n\n    createViewer(data, viewerOptions) {\n        return new Viewer(this.options.el, {\n            id: this.options.id,\n            ownedBy: data.details.dealer_id,\n            color: '#' + data.details.branding.pageflip.color,\n            hotspotRatio: data.details.dimensions.height,\n            keyboard: true,\n            pageId: this.options.pageId,\n            eventTracker: this.options.eventTracker,\n            pages: this.transformPages(data.pages),\n            ...viewerOptions\n        });\n    }\n\n    transformPages(pages) {\n        return pages.map((page, i) => {\n            const pageNumber = i + 1;\n\n            return {\n                id: 'page' + pageNumber,\n                label: pageNumber + '',\n                pageNumber,\n                images: {\n                    medium: page.view,\n                    large: page.zoom\n                }\n            };\n        });\n    }\n\n    applyHotspots(viewer, hotspots) {\n        const obj = {};\n\n        hotspots.forEach((hotspot) => (obj[hotspot.id] = hotspot));\n\n        viewer.applyHotspots(obj);\n    }\n\n    async fetch(callback) {\n        try {\n            const [details, pages] = await Promise.all([\n                this.fetchDetails(),\n                this.fetchPages()\n            ]);\n\n            if (details && pages) {\n                callback(null, {details, pages});\n            } else {\n                throw new Error();\n            }\n        } catch (error) {\n            callback(error);\n        }\n    }\n\n    fetchDetails = (callback) =>\n        request({url: `/v2/catalogs/${this.options.id}`}, callback);\n\n    fetchPages = (callback) =>\n        request({url: `/v2/catalogs/${this.options.id}/pages`}, callback);\n\n    fetchHotspots = (callback) =>\n        request({url: `/v2/catalogs/${this.options.id}/hotspots`}, callback);\n}\n","const prefixKey = 'sgn-';\n\nconst storage = (() => {\n    try {\n        const storage = window.sessionStorage;\n\n        storage[`${prefixKey}test-storage`] = 'foobar';\n        delete storage[`${prefixKey}test-storage`];\n\n        return storage;\n    } catch (error) {\n        return {};\n    }\n})();\n\nexport function get(key) {\n    try {\n        return JSON.parse(storage[`${prefixKey}${key}`]);\n    } catch (error) {}\n}\n\nexport function set(key, value) {\n    try {\n        storage[`${prefixKey}${key}`] = JSON.stringify(value);\n    } catch (error) {}\n}\n","import * as Core from './core';\nimport * as CoreKit from './kits/core';\nimport * as CoreUIKit from './kits/core-ui';\nimport * as EventsKit from './kits/events';\nimport * as IncitoPublicationKit from './kits/incito-publication';\nimport * as PagedPublicationKit from './kits/paged-publication';\nimport * as clientCookie from './storage/client-cookie';\nimport * as clientLocal from './storage/client-local';\nimport * as clientSession from './storage/client-session';\nimport {error, isBrowser} from './util';\n\nconst SGN = {...Core};\n\n// Expose storage backends.\nSGN.storage = {\n    local: clientLocal,\n    session: clientSession,\n    cookie: clientCookie\n};\n\n// Expose the different kits.\nSGN.EventsKit = EventsKit;\nSGN.CoreKit = CoreKit;\nSGN.PagedPublicationKit = PagedPublicationKit;\nSGN.IncitoPublicationKit = IncitoPublicationKit;\nSGN.CoreUIKit = CoreUIKit;\n\n// Set the core session from the cookie store if possible.\nconst session = SGN.storage.cookie.get('session');\n\nif (typeof session === 'object') {\n    SGN.config.set({\n        coreSessionToken: session.token,\n        coreSessionClientId: session.client_id\n    });\n}\n\nSGN.config.bind('change', (changedAttributes) => {\n    const newEventTracker = changedAttributes.eventTracker;\n    const newAppKey = changedAttributes.appKey;\n    if (\n        (newAppKey || newEventTracker) &&\n        (newEventTracker || SGN.config.get('eventTracker'))?.trackId ===\n            (newAppKey || SGN.config.get('appKey'))\n    ) {\n        throw error(\n            new Error(\n                'Track identifier must not be identical to app key. Go to https://shopgun.com/developers/apps to get a track identifier for your app'\n            )\n        );\n    }\n\n    if (newEventTracker != null) {\n        // default eventsTrackUrl\n        if (!newEventTracker.eventsTrackUrl) {\n            newEventTracker.setEventsTrackUrl(SGN.config.get('eventsTrackUrl'));\n        }\n    }\n\n    const newEventsTrackUrl = changedAttributes.eventsTrackUrl;\n    if (newEventsTrackUrl && SGN.config.get('eventTracker')) {\n        SGN.config.get('eventTracker').setEventsTrackUrl(newEventsTrackUrl);\n    }\n});\n\nif (isBrowser()) {\n    // Autoconfigure the SDK.\n    const scriptEl = document.getElementById('sgn-sdk');\n\n    if (scriptEl) {\n        const appKey = scriptEl.getAttribute('data-app-key');\n        const trackId = scriptEl.getAttribute('data-track-id');\n        const config = {};\n\n        if (appKey) {\n            config.appKey = appKey;\n        }\n        if (trackId) {\n            config.eventTracker = new SGN.EventsKit.Tracker({trackId});\n        }\n\n        SGN.config.set(config);\n    }\n}\n\nexport default SGN;\n"],"names":["Config","config","changedAttributes","key","value","attrs","trigger","option","prototype","keys","MicroEvent","mixin","locale","coreUrl","eventsTrackUrl","pairs","t","view","template","Mustache","render","update","translations","isBrowser","window","document","isNode","process","error","err","options","message","code","name","stack","time","Date","uuid","replace","c","r","Math","random","v","toString","getQueryParam","field","url","href","location","reg","RegExp","string","exec","undefined","getRandomNumberBetween","from","to","floor","getOS","ua","navigator","userAgent","getDeviceCategory","deviceCategory","platform","test","getPointer","pointer","matchMedia","matches","getOrientation","width","height","getScreenDimensions","density","devicePixelRatio","logical","screen","physical","round","getUtcOffsetSeconds","now","jan1","getFullYear","tmp","toGMTString","jan2","substring","stdTimeOffset","getUtcDstOffsetSeconds","getTimezoneOffset","getColorBrightness","color","hex","rgb","sum","x","s","btoa","str","buffer","Buffer","chunk","arr","size","results","length","push","throttle","fn","threshold","scope","last","deferTimer","context","getTime","args","arguments","clearTimeout","apply","loadImage","src","callback","img","Image","onload","onerror","Error","distance","lat1","lng1","lat2","lng2","radlat1","PI","radlat2","theta","radtheta","dist","sin","cos","acos","promiseCallbackInterop","fun","cbParameterIndex","makePromise","parameters","resolve","reject","neoCallback","result","callParameters","i","end","max","asc","set","configDefaults","prefixKey","get","ca","cookie","split","ct","JSON","parse","days","date","setTime","toUTCString","callbackQueue","renewed","ttl","saveToken","token","SGN","coreSessionToken","saveCookie","saveClientId","clientId","coreSessionClientId","clientCookieStorage","client_id","create","req","fetch","method","then","response","json","status","catch","headers","appSecret","sign","renew","ensure","queueCount","complete","sha256","join","request","secondTime","appKey","appVersion","qs","geo","geolocation","body","r_locale","api_av","latitude","r_lat","longitude","r_lng","radius","r_radius","sensor","r_sensor","params","k","val","encodeURIComponent","responseToken","statusCode","_matcher","_level","_id","_handlers","_gatorInstances","_addEvent","gator","type","useCapture","element","addEventListener","_cancel","e","preventDefault","stopPropagation","_getMatcher","webkitMatchesSelector","mozMatchesSelector","msMatchesSelector","oMatchesSelector","Gator","matchesSelector","_matchesSelector","selector","boundElement","call","parentNode","_addHandler","event","id","_removeHandler","hasOwnProperty","_handleEvent","target","srcElement","match","j","matchesEvent","cancelBubble","cancel","_bind","events","remove","Array","_getGlobalCallback","addEvent","on","off","module","exports","minWidth","maxWidth","anchorEl","contentEl","resize","elInner","createElement","className","el","setAttribute","appendChild","position","offsetWidth","show","removeEventListener","removeChild","rect","getBoundingClientRect","top","pageYOffset","offsetHeight","left","pageXOffset","style","rightAligned","outerWidth","right","ESC","ARROW_RIGHT","ARROW_LEFT","SPACE","NUMBER_ONE","defaultTemplate","Popover","keyUp","scroll","backgroundEl","header","singleChoiceItems","item","index","innerHTML","addEventListeners","y","menuEl","querySelector","parentWidth","parentHeight","boundingRect","getAttribute","destroy","keyCode","keyCodes","singleChoicePopover","ctx","items","popover","focus","storage","localStorage","createTrackerClient","clientLocalStorage","data","getPool","evt","_i","pool","Tracker","defaultOptions","client","defaultEventsTrackUrl","geohash","country","dispatching","hasMadeInitialDispatch","dispatch","properties","version","trackId","_e","_v","_t","_a","poolLimit","shift","Object","trackEvent","parts","viewToken","String","fromCharCode","md5","asBytes","dispatchLimit","ship","timeout","dispatchRetryInterval","_dispatch","nacks","clearInterval","resEvent","poolEvent","console","warn","IncitoPublicationEventTracking","eventTracker","details","trackIncitoPublicationOpened","types","vt","createViewToken","Viewer","incito","Incito","renderLaziness","_eventTracking","EventTracking","start","classList","add","trackOpened","viewer","progressEl","isScrolling","textContent","winHeight","innerHeight","progress","min","abs","scrollTimeout","Bootstrapper","fetchDetails","pixelRatio","getPixelRatio","orientation","getLocale","getMaxWidth","featureLabels","getFeatureLabels","versionsSupported","toISOString","localeChain","languages","language","browserLanguage","prefLocale","count","vector","acc","cur","featureLabel","fetchIncito","incito_publication_id","err1","res","Accept","device_category","pixel_ratio","max_width","versions_supported","locale_code","feature_labels","anonymizeFeatureLabels","Controls","self","PagedPublicationControls","beforeNavigation","prevClicked","nextClicked","closeClicked","keyDown","els","root","progressBar","progressLabel","prevControl","nextControl","close","keyDownHandler","keyboard","showProgress","visibilityClassName","verso","newPosition","pageSpreadCount","duration","PagedPublicationPageSpread","contentsRendered","hotspotsRendered","renderEl","pages","pageIds","getPages","page","getId","maxZoomScale","getEl","pageCount","imageLoads","maxPageWidth","clientWidth","pageMode","useLargeImage","image","images","medium","large","pageEl","loaderEl","label","isComplete","backgroundImage","pageSpreadId","pageEls","querySelectorAll","removeAttribute","PagedPublicationPageSpreads","collection","ids","frag","createDocumentFragment","pageSpread","pageSpreads","firstPage","lastPage","pop","midstPageSpreads","midstPages","PageSpread","PagedPublicationCore","afterNavigation","attemptedNavigation","clicked","doubleClicked","pressed","contextmenu","panStart","panEnd","zoomedIn","zoomedOut","unload","makeOptions","defaults","pageId","getOption","getPageMode","PageSpreads","pageLoaded","pagesLoaded","setColor","insertBefore","getFrag","createVerso","getVerso","overridePageSpreadContentRect","resizeListener","pageSpreadEls","backgroundColor","pageSpreadEl","opts","Verso","bottom","getPageEls","scale","transform","pageWidth","pageHeight","imageRatio","actualHeight","actualWidth","clientRect","pageLabels","visibility","getVisibility","renderContents","clearContents","theVerso","versoPageSpread","getPageSpreadFromPosition","getPageSpreadCount","newSpreadEl","formatProgressLabel","renderPageSpreads","resetIdleTimer","startIdleTimer","newPositionIsEnd","isInsideContent","findPage","zoomIn","zoomOut","idleTimeout","getPosition","getPageIds","refresh","navigateTo","getPageSpreadPositionFromPageId","getType","getContentRect","switchPageMode","pageSpreadWidth","pageSpreadMaxZoomScale","idleDelay","resizeDelay","PagedPublicationEventTracking","hidden","appeared","disappeared","pageSpreadDisappeared","trackPagedPublicationOpened","pageNumbers","pageNumber","trackPagedPublicationPageDisappeared","pageSpreadAppeared","trackPageSpreadDisappeared","PagedPublicationHotspots","currentPageSpreadId","pageSpreadsLoaded","cache","hotspotsReceived","resized","contentRect","hotspotEls","hotspotEl","hotspots","hotspot","ratio","renderHotspot","minX","minY","maxX","maxY","locations","coords","setCache","renderHotspots","requestHotspots","getCache","defaultPickHotspot","title","offer","heading","subtitle","pricing","currency","price","picked","_core","Core","_hotspots","Hotspots","_controls","viewSession","hotspotQueue","_setupEventListeners","navigateToIndex","first","prev","next","hotspotsRequested","overlayEls","overlayEl","pickHotspot","hotspotRequest","hotspotRatio","processHotspotQueue","viewerOptions","ownedBy","dealer_id","branding","pageflip","dimensions","transformPages","zoom","obj","applyHotspots","all","fetchPages","sessionStorage","local","clientLocal","session","clientSession","clientCookie","EventsKit","CoreKit","PagedPublicationKit","IncitoPublicationKit","CoreUIKit","newEventTracker","newAppKey","setEventsTrackUrl","newEventsTrackUrl","scriptEl","getElementById"],"mappings":"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"}